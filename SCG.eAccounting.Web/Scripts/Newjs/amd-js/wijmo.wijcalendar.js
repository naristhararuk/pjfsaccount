var wijmo;define(["./wijmo.wijutil","./wijmo.widget","./wijmo.wijpopup","globalize"],function(){var e=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};(function(t){(function(n){var r=jQuery,i="wijcalendar",s={general:0,weekEnd:1,otherMonth:2,outOfRange:4,today:8,custom:16,disabled:32,selected:64,gap:128},o=function(t){function n(){t.apply(this,arguments),this._touchRangeSelect=!1}return e(n,t),n.prototype._create=function(){var e=this,n=e.options.wijCSS;e._originalStyle=e.element.attr("style"),window.wijmoApplyWijTouchUtilEvents&&(r=window.wijmoApplyWijTouchUtilEvents(r)),r.isFunction(window.wijmoASPNetParseOptions)&&wijmoASPNetParseOptions(this.options),this.element.addClass("wijmo-wijcalendar  "+n.datepickerInline+" "+n.datepicker+" "+n.widget+" "+n.content+" "+n.helperClearFix+" "+n.cornerAll).attr("role","grid"),this._previewWrapper(this.options.allowPreview),this.element.data("preview.wijcalendar",!1),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.refresh(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijcalendar"),t.prototype._create.call(this)},n.prototype._init=function(){if(this.options.popupMode){var e={autoHide:!!this.options.autoHide,showing:undefined,shown:undefined,hiding:undefined,hidden:undefined},t=this;this.options.beforePopup&&(e.showing=this.options.beforePopup),this.options.afterPopup&&(e.shown=this.options.afterPopup),this.options.beforeClose&&(e.hiding=this.options.beforeClose),e.hidden=function(e){t.element.removeData("lastdate.wijcalendar"),t.options.afterClose&&t.options.afterClose.call(e)},this.element.wijpopup(e)}else this.element.removeAttr("style"),this._originalStyle&&this.element.attr("style",this._originalStyle);this._getSelectedDates(),this._getDisabledDates(),this._resetWidth(),this.refresh()},n.prototype.destroy=function(){var e=this.options.wijCSS;t.prototype.destroy.call(this),this._innerCulture=null,this.close(),this._unbindEvents(),this.element.html(""),this.element.removeClass("wijmo-wijcalendar "+e.datepickerInline+" "+e.datepicker+" "+e.widget+" "+e.content+" "+e.helperClearFix+" "+e.cornerAll+" "+e.datepickerMulti).removeAttr("role");var n=this;r.each(["preview","disableddates","selecteddates","dragging","lastdate","animating"],function(e,t){n.element.removeData(t+".wijcalendar")}),this._previewWrapper(!1)},n.prototype._setOption=function(e,n){if(e==="disabled"&&n===this.options.disabled)return;if(e==="popupMode"&&n===this.options.popupMode)return;t.prototype._setOption.call(this,e,n);switch(e){case"showWeekDays":case"showWeekNumbers":case"showTitle":case"showOtherMonthDays":case"selectionMode":this.unSelectAll(),this._resetWidth(),this.refresh();break;case"culture":case"cultureCalendar":this._innerCulture=null,this.refresh();break;case"allowPreview":this._previewWrapper(n),this.refresh();break;case"monthCols":this._resetWidth(),this.refresh();break;case"monthRows":this._myGrid&&(this._myGrid=undefined);break;case"autoHide":this.element.wijpopup({autoHide:this.options.autoHide});break;case"selectedDates":this._getSelectedDates().setDates(n),this.refresh();break;case"disabledDates":this._getDisabledDates().setDates(n),this.refresh();break;case"displayDate":case"allowQuickPick":case"navButtons":case"minDate":case"maxDate":this.refresh();break;case"popupMode":n===!1&&this.element.wijpopup("destroy"),this._unbindEvents(),this._init()}},n.prototype._innerDisable=function(){t.prototype._innerDisable.call(this),this._unbindEvents()},n.prototype._innerEnable=function(){t.prototype._innerEnable.call(this),this.refresh()},n.prototype._previewWrapper=function(e){e?this.element.parent().hasClass("wijmo-wijcalendar-preview-wrapper")||this.element.wrap("<div class='wijmo-wijcalendar-preview-wrapper "+this.options.wijCSS.helperClearFix+"'></div>"):this.element.parent().hasClass("wijmo-wijcalendar-preview-wrapper")&&this.element.unwrap()},n.prototype._isRTL=function(){return!!this._getCulture(null).isRTL},n.prototype.refresh=function(){this._myGrid&&(this._myGrid=undefined),this.element.empty().append(this._createCalendar()),this.element[(this._isRTL()?"add":"remove")+"Class"](this.options.wijCSS.datepickerRtl),this.options.showTitle?this.element.removeClass("wijmo-wijcalendar-notitle"):this.element.addClass("wijmo-wijcalendar-notitle"),this._bindEvents()},n.prototype.refreshDate=function(e){if(!this._monthViews)return;if(e<this._groupStartDate||e>this._groupEndDate)return;r.each(this._monthViews,function(){this._refreshDate(e)})},n.prototype.getDisplayDate=function(){var e=this.options.displayDate?this.options.displayDate:new Date;return f.isSameDate(e,new Date(1900,0,1))&&(e=new Date),e},n.prototype.getSelectedDate=function(){var e=this.options.selectedDates;return!e||e.length===0?null:e[0]},n.prototype.selectDate=function(e){return e=new Date(e),this._getDisabledDates().contains(e)?!1:e<this.options.minDate||e>this.options.maxDate?!1:(this._getSelectedDates().add(e),this.refreshDate(e),!0)},n.prototype.unSelectDate=function(e){return e=new Date(e),this._getDisabledDates().contains(e)?!1:e<this.options.minDate||e>this.options.maxDate?!1:(this._getSelectedDates().remove(e),this.refreshDate(e),!0)},n.prototype.unSelectAll=function(){var e=this.options.selectedDates,t;if(e&&e.length>0){this._getSelectedDates().clear();for(t=0;t<e.length;t++)this.refreshDate(e[t])}},n.prototype._slideToDate=function(e){if(f.isSameMonth(this.getDisplayDate(),e))return;var t=this.element.is(":visible");if(!t)this.options.displayDate=e;else{if(this._trigger("beforeSlide")===!1)return;this._isSingleMonth()?this._playSlideAnimation(e):this._playMmSlideAnimation(e)}},n.prototype.isPopupShowing=function(){return this.options.popupMode?this.element.wijpopup("isVisible"):!1},n.prototype.popup=function(e){this._myGrid=undefined,this.refresh(),this.element.data("dragging.wijcalendar",!1),this.element.data("wijmo-wijpopup")&&this.element.wijpopup("show",e)},n.prototype.popupAt=function(e,t){this._myGrid=undefined,this.refresh(),this.element.data("dragging.wijcalendar",!1),this.element.data("wijmo-wijpopup")&&this.element.wijpopup("showAt",e,t)},n.prototype.close=function(){this.isPopupShowing()&&this.element.wijpopup("hide")},n.prototype._getCulture=function(e){return this._innerCulture||this._resetCulture(e),this._innerCulture},n.prototype._resetCulture=function(e){var t=r.wijGetCulture(e||this.options.culture,this.options.cultureCalendar);this._innerCulture=t},n.prototype._getDates=function(e){var t=e.toLowerCase()+".wijcalendar",n=this.element.data(t);return n===undefined&&(n=new c(this,e),this.element.data(t,n)),n},n.prototype._getDisabledDates=function(){return this._getDates("disabledDates")},n.prototype._getSelectedDates=function(){return this._getDates("selectedDates")},n.prototype._onDayDragStart=function(e){return e.preventDefault(),e.stopPropagation(),!1},n.prototype._onDayMouseDown=function(e){e.preventDefault(),e.stopPropagation();var t=this.options,n=this,i,s,o=!1,u=t.selectedDates,a=!1,f=[];if(e.which!==1)return e.which===0&&this._onTouchstart(e),!1;if(r.browser.msie&&parseFloat(r.browser.version)>=10)if(e.originalEvent.pointerType){if(e.originalEvent.pointerType===2||e.originalEvent.pointerType==="touch")return this._onTouchstart(e),!1}else if(e.originalEvent.originalEvent&&e.originalEvent.originalEvent.pointerType)if(e.originalEvent.originalEvent.pointerType===2||e.originalEvent.originalEvent.pointerType==="touch")return this._onTouchstart(e),!1;return i=this._getCellDate(e.currentTarget),i===undefined?!1:t.selectionMode.day?(s={date:i},this._trigger("beforeSelect",null,s)===!1?!1:((!t.selectionMode.days||!e.metaKey&&!e.shiftKey&&!e.ctrlKey)&&this.unSelectAll(),!t.selectionMode.days||(e.shiftKey&&this.element.data("lastdate.wijcalendar")?(this._selectRange(this.element.data("lastdate.wijcalendar"),i,null),o=!0):e.ctrlKey&&(this.element.data("lastdate.wijcalendar",i),r.each(u,function(e,t){if(i.getFullYear()===t.getFullYear()&&i.getMonth()===t.getMonth()&&i.getDate()===t.getDate())return a=!0,!1}),a?this.unSelectDate(i):this.selectDate(i),u=t.selectedDates,r.each(u,function(e,t){f.push(new Date(t))}),this._trigger("selectedDatesChanged",null,{dates:f}),o=!0)),o||(this.element.data("lastdate.wijcalendar",i),o=this.selectDate(i),this._trigger("selectedDatesChanged",null,{dates:[i]})),o&&(this._trigger("afterSelect",null,s),!t.selectionMode.days||(this.element.data("dragging.wijcalendar",!0),r(document.body).one("mouseup."+this.widgetName,function(){n.element.data("dragging.wijcalendar",!1)}))),!1)):!1},n.prototype._onMouseUp=function(e){return e.preventDefault(),e.stopPropagation(),this.element.data("dragging.wijcalendar",!1),!1},n.prototype._onDayClicked=function(e){var t=this._getCellDate(e.currentTarget);return t===undefined?!1:this.options.selectionMode.day?(this.isPopupShowing()?this.close():r(e.currentTarget).hasAllClasses(this.options.wijCSS.datepickerOtherMonth)&&this._slideToDate(t),!1):!1},n.prototype._onDayMouseEnter=function(e){r(e.currentTarget).attr("state","hover"),this._refreshDayCell(e.currentTarget);if(!!this.element.data("dragging.wijcalendar")){var t=this._getCellDate(e.currentTarget);if(t===undefined)return;this.unSelectAll(),this._selectRange(this.element.data("lastdate.wijcalendar"),t,!0)}},n.prototype._onDayMouseLeave=function(e){r(e.currentTarget).attr("state","normal"),this._refreshDayCell(e.currentTarget)},n.prototype._onTouchstart=function(e){this._touchStartTime=new Date},n.prototype._onTouchend=function(e){e.preventDefault(),e.stopPropagation();var t=new Date,n=t-this._touchStartTime,i=this.options,s=this,o,u,a=i.selectedDates,f=!1,l=[];this.element.data("dragging.wijcalendar",!1);if(r.browser.msie){if(!(parseFloat(r.browser.version)>=10))return!1;if(e.originalEvent.pointerType){if(e.originalEvent.pointerType!==2&&e.originalEvent.pointerType!=="touch")return!1}else{if(!e.originalEvent.originalEvent.pointerType)return!1;if(e.originalEvent.originalEvent.pointerType!==2&&e.originalEvent.originalEvent.pointerType!=="touch")return!1}}else if(e.which!==0)return!1;return o=this._getCellDate(e.currentTarget),o===undefined?!1:i.selectionMode.day?(u={date:o},this._trigger("beforeSelect",null,u)===!1?!1:(r.each(a,function(e,t){if(o.getFullYear()===t.getFullYear()&&o.getMonth()===t.getMonth()&&o.getDate()===t.getDate())return f=!0,!1}),!this._touchRangeSelect&&n>=750?(this.element.data("lastdate.wijcalendar",o),f?!i.selectionMode.days||this.unSelectDate(o):(i.selectionMode.days?this._touchRangeSelect=!0:this.unSelectAll(),this.selectDate(o)),a=i.selectedDates,r.each(a,function(e,t){l.push(new Date(t))}),a.length>0&&this._trigger("selectedDatesChanged",null,{dates:l})):(i.selectionMode.days||(this.unSelectAll(),this._touchRangeSelect=!1),this._touchRangeSelect?(n>=750&&(!i.selectionMode.days||(this.element.data("lastdate.wijcalendar",o),f?(this.unSelectDate(o),this._touchRangeSelect=!1):this.selectDate(o),a=i.selectedDates,r.each(a,function(e,t){l.push(new Date(t))}),this._trigger("selectedDatesChanged",null,{dates:l}))),n<750&&this.element.data("lastdate.wijcalendar")&&(this._selectRange(this.element.data("lastdate.wijcalendar"),o,null),this._touchRangeSelect&&(this._touchRangeSelect=!1))):(this.unSelectAll(),this.element.data("lastdate.wijcalendar",o),this.selectDate(o),this._trigger("selectedDatesChanged",null,{dates:[o]}))),this._trigger("afterSelect",null,u),this._touchStartTime=null,!1)):!1},n.prototype._selectRange=function(e,t,n){if(e!==undefined&&e!==new Date(1900,1,1)){var r=e,i=t,s=[];e>t&&(i=e,r=t);for(;;){if(r>i)break;this.selectDate(r),s[s.length]=r,r=f.addDays(r,1)}n||this.element.removeData("lastdate.wijcalendar"),this._trigger("selectedDatesChanged",null,{dates:s})}else this.selectDate(e),this._trigger("selectedDatesChanged",null,{dates:[e]});return!0},n.prototype._getCellDate=function(e){var t=r(e).attr("date");return t===undefined?t:new Date(t)},n.prototype._getParentTable=function(e){var t=r(e).parents("table");return t.length===0?undefined:t.get(0)},n.prototype._initMonthSelector=function(e){if(r(e).data("cells")!==undefined)return;var t=e.id.split("_"),n,i,s=[],o,u,a,f,l;if(t[t.length-1]!=="ms")throw Error.create("not a monthview");n=t.slice(0,t.length-1).join("_"),i=this._getParentTable(e);if(i){if(i.id!==n)throw Error.create("not a monthview");for(o=0;o<i.rows.length;o++){l=i.rows[o];for(u=0;u<l.cells.length;u++)a=l.cells[u],a&&(f=r(a).attr("daytype"),f!==undefined&&r(a).find("a").hasAllClasses(this.options.wijCSS.prioritySecondary)===!1&&this._isSelectable(parseInt(f,10))&&(s[s.length]=a))}}r(e).data("cells",s)},n.prototype._onMonthSelectorClicked=function(e){this._initMonthSelector(e.currentTarget);var t=r(e.currentTarget).data("cells"),n=[],i,s,o,u;this.element.removeData("lastdate.wijcalendar"),this.unSelectAll();for(i=0;i<t.length;i++)s=t[i],o=r(s).attr("date"),o!==undefined&&(u=new Date(o),this.selectDate(u),n[n.length]=u);return this._trigger("selectedDatesChanged",null,{dates:n}),this.isPopupShowing()&&this.close(),!1},n.prototype._onMonthSelectorMouseEnter=function(e){this._initMonthSelector(e.currentTarget);var t=r(e.currentTarget).data("cells"),n;for(n=0;n<t.length;n++)e.currentTarget=t[n],this._onDayMouseEnter(e)},n.prototype._onMonthSelectorMouseLeave=function(e){this._initMonthSelector(e.currentTarget);var t=r(e.currentTarget).data("cells"),n;for(n=0;n<t.length;n++)e.currentTarget=t[n],this._onDayMouseLeave(e)},n.prototype._initWeekDaySelector=function(e){if(r(e).data("cells")!==undefined)return;var t=e.id.split("_"),n,i,s,o=[],u=0,a,f,l;if(t[t.length-2]!=="cs")throw Error.create("not a column");n=parseInt(t[t.length-1],10),i=t.slice(0,t.length-2).join("_"),s=this._getParentTable(e);if(s){if(s.id!==i)throw Error.create("not a column");this.options.showWeekDays&&u++;for(;u<s.rows.length;u++)a=s.rows[u],n<a.cells.length&&(f=a.cells[n],f&&(l=r(f).attr("daytype"),l!==undefined&&r(f).find("a").hasAllClasses(this.options.wijCSS.prioritySecondary)===!1&&this._isSelectable(parseInt(l,10))&&(o[o.length]=f)))}r(e).data("cells",o)},n.prototype._onWeekDayClicked=function(e){this._initWeekDaySelector(e.currentTarget);var t=r(e.currentTarget).data("cells"),n=[],i,s,o,u;this.unSelectAll();for(i=0;i<t.length;i++)s=r(t[i]),o=s.attr("date"),o!==undefined&&(u=new Date(o),this.selectDate(u),n[n.length]=u);return this._trigger("selectedDatesChanged",null,{dates:n}),this.isPopupShowing()&&this.close(),!1},n.prototype._onWeekDayMouseEnter=function(e){this._initWeekDaySelector(e.currentTarget);var t=r(e.currentTarget).data("cells"),n;for(n=0;n<t.length;n++)e.currentTarget=t[n],this._onDayMouseEnter(e)},n.prototype._onWeekDayMouseLeave=function(e){this._initWeekDaySelector(e.currentTarget);var t=r(e.currentTarget).data("cells"),n;for(n=0;n<t.length;n++)e.currentTarget=t[n],this._onDayMouseLeave(e)},n.prototype._initWeekNumberSelector=function(e){if(r(e).data("cells")!==undefined)return;var t=e.id.split("_"),n,i,s,o=[],u,a,f,l;if(t[t.length-2]!=="rs")throw Error.create("not a row");n=parseInt(t[t.length-1],10),i=t.slice(0,t.length-2).join("_"),s=this._getParentTable(e);if(s){if(s.id!==i)throw Error.create("not a row");u=s.rows[n];if(u){a=0,this.options.showWeekNumbers&&a++;for(;a<u.cells.length;a++)f=u.cells[a],f&&(l=r(f).attr("daytype"),l!==undefined&&r(f).find("a").hasAllClasses(this.options.wijCSS.prioritySecondary)===!1&&this._isSelectable(parseInt(l,10))&&(o[o.length]=f))}}r(e).data("cells",o)},n.prototype._onWeekNumberClicked=function(e){this._initWeekNumberSelector(e.currentTarget);var t=r(e.currentTarget).data("cells"),n=[],i,s,o,u;this.unSelectAll();for(i=0;i<t.length;i++)s=r(t[i]),o=s.attr("date"),o!==undefined&&(u=new Date(o),this.selectDate(u),n[n.length]=u);return this._trigger("selectedDatesChanged",null,{dates:n}),this.isPopupShowing()&&this.close(),!1},n.prototype._onWeekNumberMouseEnter=function(e){this._initWeekNumberSelector(e.currentTarget);var t=r(e.currentTarget).data("cells"),n;for(n=0;n<t.length;n++)e.currentTarget=t[n],this._onDayMouseEnter(e)},n.prototype._onWeekNumberMouseLeave=function(e){this._initWeekNumberSelector(e.currentTarget);var t=r(e.currentTarget).data("cells"),n;for(n=0;n<t.length;n++)e.currentTarget=t[n],this._onDayMouseLeave(e)},n.prototype._isAnimating=function(){return!!this.element.data("animating.wijcalendar")},n.prototype._onPreviewMouseEnter=function(e){if(!!this.element.data("previewContainer"))return;if(this._isAnimating())return;var t=r(e.currentTarget),n=t.attr("id"),i=this.getDisplayDate(),s=this.options.wijCSS,o=this.options.monthCols*this.options.monthRows,u=r("<div/>");if(n===undefined)return;n==="prevPreview"&&(o=-o),this.options.displayDate=f.addMonths(i,o),this.element.data("preview.wijcalendar",!0),u.appendTo(document.body),u.hide(),u.addClass("wijmo-wijcalendar "+s.datepickerInline+" "+s.datepicker+" "+s.widget+" "+s.content+" "+s.helperClearFix+" "+s.cornerAll),u.append(this._createCalendar()),this.options.displayDate=i,this.element.data("preview.wijcalendar",!1),this._createMonthViews(),u.wijpopup({showEffect:"slide",showOptions:{direction:n==="prevPreview"?"right":"left"},hideEffect:"slide",hideOptions:{direction:n==="prevPreview"?"right":"left"}}),u.wijpopup("show",{my:n==="prevPreview"?"right top":"left top",at:n==="prevPreview"?"left top":"right top",of:t}),this.element.data("previewContainer",u)},n.prototype._onPreviewMouseLeave=function(e){var t=r(e.currentTarget),n=t.attr("id"),i=this.element.data("previewContainer"),s=this;if(n===undefined)return;i&&(i.wijpopup("isAnimating")?window.setTimeout(function(){s._onPreviewMouseLeave(e)},200):(i.wijpopup("hide"),this.element.removeData("previewContainer")))},n.prototype._resetWidth=function(){this._myGrid||(this.element.css("height",""),this.options.monthCols>1?(this.element.css("width",17*this.options.monthCols+"em"),this.element.addClass(this.options.wijCSS.datepickerMulti)):(this.element.css("width",""),this.element.removeClass(this.options.wijCSS.datepickerMulti)))},n.prototype._playMmSlideAnimation=function(e){var t=this.element.width(),n=this.element.height(),i=this.getDisplayDate(),s,o,u,a=this.options.direction||"horizontal",f=this,l,c;this.element.height(n),this.element.wrapInner("<div class='wijmo-wijcalendar-multi-aniwrapper'></div>"),s=this.element.find(">:first-child").width(t).height(n),o=s.clone(!1),o.hide(),this.options.displayDate=e,this._createMonthViews(),o.empty().append(this._createMonthGroup()),o.appendTo(this.element),u=e>i,this.element.data("animating.wijcalendar",!0),r.effects?(s.effect("slide",{mode:"hide",direction:a==="horizontal"?u?"left":"right":u?"up":"down",easing:this.options.easing||"easeOutBack",duration:this.options.duration},function(){s.remove()}),o.effect("slide",{direction:a==="horizontal"?u?"right":"left":u?"down":"up",easing:this.options.easing||"easeOutBack",duration:this.options.duration},function(){while(o.parent().is(".wijmo-wijcalendar-multi-aniwrapper"))o.parent().replaceWith(o);o.replaceWith(o.contents()),f.element.height(""),f._bindEvents(),f.element.data("animating.wijcalendar",!1),f._trigger("afterSlide")})):(a==="horizontal"?(l={width:0},c={width:"100%"}):(l={height:0},c={height:"100%"}),s.animate(l,this.options.duration,null,function(){s.remove()}),o.animate(c,this.options.duration,null,function(){while(o.parent().is(".wijmo-wijcalendar-multi-aniwrapper"))o.parent().replaceWith(o);o.replaceWith(o.contents()),f.element.height(""),f._bindEvents(),f.element.data("animating.wijcalendar",!1),f._trigger("afterSlide")}))},n.prototype._playSlideAnimation=function(e){if(!this._isSingleMonth())return;var t=this,n=this.getDisplayDate(),i=t.options.wijCSS,s=this.element.find("."+i.datepickerCalendar),o,u,a=1,f=this.options.direction||"horizontal",c=e>n,h=[],p,d,v;s.parent().is(".wijmo-wijcalendar-aniwrapper")?o=s.parent():(o=r.createWrapper(s).css({overflow:"hidden"}),o.removeClass(i.effectsWrapper),o.addClass("wijmo-wijcalendar-aniwrapper")),o.parent().is(".wijmo-wijcalendar-aniwrapper")?u=o.parent():(u=r.createWrapper(o).css({overflow:"hidden"}),u.removeClass(i.effectsWrapper),u.addClass("wijmo-wijcalendar-aniwrapper"));if(this._myGrid)switch(this._myGrid.gridType){case"month":a=1;break;case"year":a=10;break;case"decade":a=100}h[h.length]=e,p=s.outerWidth(),d=s.outerHeight(),f==="horizontal"?(s.width(p).css("float",c?"left":"right"),o.width((h.length+1)*p),o.css("left",c?0:-h.length*p).css("position","absolute")):(o.width(p),o.css("top",c?0:-h.length*d).css("position","absolute"),o.height((h.length+1)*d)),r.each(h,function(e,n){if(t._myGrid===undefined){var i=new l(t,n),s=t._customize(i.getHtml(!0));f==="horizontal"?s.width(p).css("float",c?"left":"right").appendTo(o):s.appendTo(o)}else f==="horizontal"?r(t._myGrid.getHtml(n,!0)).width(p).height(d).css("float",c?"left":"right").appendTo(o):r(t._myGrid.getHtml(n,!0)).height(d).appendTo(o)}),this.options.displayDate=e,this._myGrid===undefined&&this._createMonthViews(),this._refreshTitle(),this.element.data("animating.wijcalendar",!0),r.effects?o.effect("slide",{mode:"hide",direction:f==="horizontal"?c?"left":"right":c?"up":"down",easing:this.options.easing||"easeOutBack",distance:(f==="horizontal"?p:d)*h.length,duration:this.options.duration},function(){s=o.children(":last");while(s.parent().is(".wijmo-wijcalendar-aniwrapper"))s.parent().replaceWith(s);s.css({"float":"",width:""}),t._bindEvents(),t.element.data("animating.wijcalendar",!1),t._trigger("afterSlide")}):(f==="horizontal"?v={width:0}:v={height:0},o.animate(v,this.options.duration,null,function(){s=o.children(":last");while(s.parent().is(".wijmo-wijcalendar-aniwrapper"))s.parent().replaceWith(s);s.css({"float":"",width:""}),t._bindEvents(),t.element.data("animating.wijcalendar",!1),t._trigger("afterSlide")}))},n.prototype._onTitleClicked=function(){if(!this.options.allowQuickPick||!this._isSingleMonth())return;if(this._isAnimating())return;if(this._myGrid===undefined)this._getMyGrid();else switch(this._myGrid.gridType){case"month":this._myGrid.gridType="year";break;case"year":this._myGrid.gridType="decade";break;case"decade":return}this._updateMyGrid()},n.prototype._getMyGrid=function(){return this._myGrid===undefined&&(this._myGrid=new h(this)),this._myGrid},n.prototype._updateMyGrid=function(e){typeof e=="undefined"&&(e=0),this._refreshTitle(),this.element.width(this.element.width()).height(this.element.height());var t=this.options.wijCSS,n=this.element.find("."+t.datepickerCalendar),i,s,o,u=n.outerWidth(),a=n.outerHeight(),f,l,c,h,p,d,v=this,m=e||this.options.duration||500;n.parent().is(".wijmo-wijcalendar-aniwrapper")?i=n.parent():i=r.createWrapper(n).css({overflow:"hidden"}).removeClass(t.effectsWrapper).addClass("wijmo-wijcalendar-aniwrapper"),i.parent().is(".wijmo-wijcalendar-aniwrapper")?s=i.parent():s=r.createWrapper(i).css({overflow:"hidden"}).removeClass(t.effectsWrapper).addClass("wijmo-wijcalendar-aniwrapper").width(u).height(a),o=r(this._myGrid.getHtml(!0)).css({position:"absolute",top:0,left:0,opacity:0}).appendTo(s).height(a),f=this._myGrid.getSelectedIndex(),l=Math.floor(f/4),c=f-l*4,h=u/4,p=a/3,d={left:h*c,top:p*l,width:h,height:p},n.width("100%").height("100%"),i.css({border:"solid 1px #cccccc"}),this.element.data("animating.wijcalendar",!0),r.effects?i.effect("size",{to:d,duration:m},function(){i.remove()}):i.animate(d,m,null,function(){i.remove()}),o.animate({opacity:1},m,null,function(){o.css({position:"",top:"",left:"",filter:""});while(o.parent().is(".wijmo-wijcalendar-aniwrapper"))o.parent().replaceWith(o);v._bindEvents(),v.element.data("animating.wijcalendar",!1)})},n.prototype._onMyGridClicked=function(e){if(this._myGrid===undefined)return!1;if(this._isAnimating())return!1;var t=r(e.currentTarget),n=parseInt(t.attr("index"),10),i=parseInt(t.attr("value"),10),s=this.options.wijCSS,o=this.element.find("."+s.datepickerCalendar),u,a,f,l,c,h,p,d,v,m=this;if(this._myGrid.gridType!=="month")if(!n||n===11)return!1;return t.hasAllClasses(s.stateActive)||this._myGrid.select(n,i),this._myGrid.gridType==="decade"?this._myGrid.gridType="year":this._myGrid.gridType==="year"?this._myGrid.gridType="month":this._myGrid=undefined,this._refreshTitle(),f=o.outerWidth(),l=o.outerHeight(),o.parent().is(".wijmo-wijcalendar-aniwrapper")?a=o.parent():a=r.createWrapper(o).css({overflow:"hidden"}).removeClass(s.effectsWrapper).addClass("wijmo-wijcalendar-aniwrapper").width(f).height(l),c=r.extend({},t.position(),{width:t.width(),height:t.height()}),this._myGrid===undefined?(this._createMonthViews(),p=this.getDisplayDate(),d=this._getMonthView(p),h=this._customize(d.getHtml(!0))):h=r(this._myGrid.getHtml(!0)),v=h.height(l).appendTo(a),u=r.createWrapper(v).css({overflow:"hidden"}).removeClass(s.effectsWrapper).addClass("wijmo-wijcalendar-aniwrapper").css(r.extend(c,{border:"solid 1px #cccccc",position:"absolute"})),this.element.data("animating.wijcalendar",!0),u.animate({left:0,top:0,width:f,height:l},this.options.duration||500,null,function(){v.css("width","")}),o.animate({opacity:0},this.options.duration||500,null,function(){o.remove();while(v.parent().is(".wijmo-wijcalendar-aniwrapper"))v.parent().replaceWith(v);m._myGrid===undefined&&m.element.width("").height(""),m._bindEvents(),m.element.data("animating.wijcalendar",!1)}),!1},n.prototype._onMyGridMouseEnter=function(e){if(this._myGrid===undefined)return;var t=r(e.currentTarget),n=parseInt(t.attr("index"),10);if(this._myGrid.gridType!=="month"&&(n<0||n>11))return;t.addClass(this.options.wijCSS.stateHover)},n.prototype._onMyGridMouseLeave=function(e){if(this._myGrid===undefined)return;var t=r(e.currentTarget),n=parseInt(t.attr("index"),10);if(this._myGrid.gridType!=="month"&&(n<0||n>11))return;t.removeClass(this.options.wijCSS.stateHover)},n.prototype._unbindEvents=function(){var e=this,t=e.element,n=e.options.wijCSS,i=e.options.selectionMode;t.unbind(".wijcalendar"),t.find("div .wijmo-wijcalendar-navbutton").unbind(),t.find("."+n.datepickerTitle).unbind(),t.find(".wijmo-wijcalendar-prevpreview-button, .wijmo-wijcalendar-nextpreview-button").unbind("mouseenter.wijcalendar").unbind("mouseleave.wijcalendar"),e._myGrid===undefined?(t.find(".wijmo-wijcalendar-day-selectable").unbind(),r.support.isTouchEnabled&&r.support.isTouchEnabled()&&(r.browser.msie&&t.unbind("contextmenu.wijcalendar"),t.find(".wijmo-wijcalendar-day-selectable").unbind("wijmouseup.wijcalendar")),!i.month||t.find(".wijmo-wijcalendar-monthselector").unbind(),!i.weekDay||t.find("."+n.datepickerWeekDay).unbind(),!i.weekNumber||t.find(".wijmo-wijcalendar-week-num").unbind()):t.find(".wijmo-wijcalendar-day-selectable").unbind()},n.prototype._bindEvents=function(){var e=this.options.wijCSS,t="";r.support.isTouchEnabled&&r.support.isTouchEnabled()&&(t="wij"),!this.element.data("preview.wijcalendar")&&!this._isDisabled()&&(this.element.find("div .wijmo-wijcalendar-navbutton").unbind().bind("mouseout.wijcalendar",function(){var t=r(this);t.removeClass(e.stateHover),t.hasAllClasses(e.datepickerNextHover)?t.removeClass(e.datepickerNextHover):t.hasAllClasses(e.datepickerPrevHover)&&t.removeClass(e.datepickerPrevHover)}).bind("mouseover.wijcalendar",function(){var t=r(this);t.addClass(e.stateHover),t.hasAllClasses(e.datepickerNext)?t.addClass(e.datepickerNextHover):t.hasAllClasses(e.datepickerPrev)&&t.addClass(e.datepickerPrevHover)}).bind(t+"click.wijcalendar",r.proxy(this._onNavButtonClicked,this)),this.element.unbind(".wijcalendar").bind(t+"mouseup.wijcalendar",r.proxy(this._onMouseUp,this)),this.element.find("."+e.datepickerTitle).unbind().bind("mouseout.wijcalendar",function(){r(this).removeClass(e.stateHover)}).bind("mouseover.wijcalendar",function(){r(this).addClass(e.stateHover)}).bind(t+"click.wijcalendar",r.proxy(this._onTitleClicked,this)),this.element.find(".wijmo-wijcalendar-prevpreview-button, .wijmo-wijcalendar-nextpreview-button").unbind("mouseenter.wijcalendar").unbind("mouseleave.wijcalendar").bind({"mouseenter.wijcalendar":r.proxy(this._onPreviewMouseEnter,this),"mouseleave.wijcalendar":r.proxy(this._onPreviewMouseLeave,this)}),this._myGrid===undefined?(this.element.find(".wijmo-wijcalendar-day-selectable").unbind().bind(t+"click.wijcalendar",r.proxy(this._onDayClicked,this)).bind("mouseenter.wijcalendar",r.proxy(this._onDayMouseEnter,this)).bind("mouseleave.wijcalendar",r.proxy(this._onDayMouseLeave,this)).bind(t+"mousedown.wijcalendar",r.proxy(this._onDayMouseDown,this)).bind("dragstart.wijcalendar",r.proxy(this._onDayDragStart,this)),r.support.isTouchEnabled&&r.support.isTouchEnabled()&&(r.browser.msie&&this.element.unbind("contextmenu.wijcalendar").bind({"contextmenu.wijcalendar":function(){return!1}}),this.element.find(".wijmo-wijcalendar-day-selectable").unbind(t+"mouseup.wijcalendar").bind(t+"mouseup.wijcalendar",r.proxy(this._onTouchend,this))),!this.options.selectionMode.month||this.element.find(".wijmo-wijcalendar-monthselector").unbind().bind(t+"click.wijcalendar",r.proxy(this._onMonthSelectorClicked,this)).bind({"mouseenter.wijcalendar":r.proxy(this._onMonthSelectorMouseEnter,this),"mouseleave.wijcalendar":r.proxy(this._onMonthSelectorMouseLeave,this)}),!this.options.selectionMode.weekDay||this.element.find("."+e.datepickerWeekDay).unbind().bind(t+"click.wijcalendar",r.proxy(this._onWeekDayClicked,this)).bind({"mouseenter.wijcalendar":r.proxy(this._onWeekDayMouseEnter,this),"mouseleave.wijcalendar":r.proxy(this._onWeekDayMouseLeave,this)}),!this.options.selectionMode.weekNumber||this.element.find(".wijmo-wijcalendar-week-num").unbind().bind(t+"click.wijcalendar",r.proxy(this._onWeekNumberClicked,this)).bind({"mouseenter.wijcalendar":r.proxy(this._onWeekNumberMouseEnter,this),"mouseleave.wijcalendar":r.proxy(this._onWeekNumberMouseLeave,this)})):this.element.find(".wijmo-wijcalendar-day-selectable").unbind().bind(t+"click.wijcalendar",r.proxy(this._onMyGridClicked,this)).bind({"mouseenter.wijcalendar":r.proxy(this._onMyGridMouseEnter,this),"mouseleave.wijcalendar":r.proxy(this._onMyGridMouseLeave,this)}))},n.prototype._isSelectable=function(e){var t=this.options;return t.showOtherMonthDays&&e&s.otherMonth||!(e&(s.outOfRange|s.disabled|s.otherMonth))},n.prototype._getCellClassName=function(e,t,n){var r=this.options,i="",o=r.wijCSS.stateDefault,u=!!r.selectionMode.day||!!r.selectionMode.days;return n=n||!1,!n&&!this._isDisabled()&&u&&this._isSelectable(e)&&(i+=" wijmo-wijcalendar-day-selectable"),e&s.weekEnd&&(i+=" "+r.wijCSS.datepickerWeekEnd),e&s.otherMonth&&(i+=" "+r.wijCSS.datepickerOtherMonth,o+=" "+r.wijCSS.prioritySecondary),e&s.outOfRange&&(i+=" wijmo-wijcalendar-outofrangeday",o+=" "+r.wijCSS.prioritySecondary),e&s.gap?i+=" wijmo-wijcalendar-gap":(e&s.disabled&&(i+=" "+r.wijCSS.datepickerUnselectable,o+=" "+r.wijCSS.stateDisabled),e&s.today&&(i+=" "+r.wijCSS.datepickerDaysCellOver+" "+r.wijCSS.datepickerToday,o+=" "+r.wijCSS.stateHighlight),e&s.selected&&(e&(s.outOfRange|s.disabled))===0&&(i+=" "+r.wijCSS.datepickerCurrentDay,o+=" "+r.wijCSS.stateActive),e&s.gap&&(i+=" wijmo-wijcalendar-gap"),e&s.custom&&(i+=" wijmo-wijcalendar-customday")),{cssCell:i,cssText:o}},n.prototype._onNavButtonClicked=function(e){if(this._isAnimating())return!1;var t=1,n=r(e.currentTarget).attr("id"),i=this.getDisplayDate(),s=i;if(this._myGrid===undefined)t=n.indexOf("quick")>=0?this.options.quickNavStep:1,t=n.indexOf("next")>=0?t:-t,t=t*this.options.monthRows*this.options.monthCols,s=f.addMonths(i,t);else{t=n.indexOf("next")>=0?1:-1;switch(this._myGrid.gridType){case"month":s=f.addYears(i,t);break;case"year":s=f.addYears(i,t*10);break;case"decade":s=f.addYears(i,t*100)}}return this._slideToDate(s),!1},n.prototype._getMonthGroupHtml=function(){var e=this.getDisplayDate(),t,n,r,i=this.options.wijCSS,s,o;if(this._isSingleMonth())return t=this._getMonthView(e),t.showPreview=this.options.allowPreview&&!this.element.data("preview.wijcalendar"),t.getHtml();n=100/this.options.monthCols+"%",r=new a;for(s=0;s<this.options.monthRows;s++){for(o=0;o<this.options.monthCols;o++)r.writeBeginTag("div"),r.writeAttribute("class",i.datepickerGroup+(o===0?" "+i.datepickerGroupFirst:"")+(o===this.options.monthCols-1?" "+i.datepickerGroupLast:"")),r.writeAttribute("style","width:"+n),r.writeTagRightChar(),t=this._getMonthView(e),t.showPreview=!1,r.write(t.getHtml()),r.writeEndTag("div"),e=f.addMonths(e,1);r.writeBeginTag("div"),r.writeAttribute("class",i.datepickerRowBreak),r.writeTagRightChar(),r.writeEndTag("div")}return r.toString()},n.prototype._getCalendarHtml=function(){this._createMonthViews();var e=new a;return e.write(this._getMonthGroupHtml()),e.toString()},n.prototype._customizeDayCell=function(e){e.attr("state")===undefined&&e.attr("state","normal");if(e.attr("daytype")===undefined)return;if(e.attr("date")===undefined)return;var t=parseInt(e.attr("daytype"),10),n=new Date(e.attr("date")),r=e.attr("state")==="hover";this.options.customizeDate(e,n,t,r)},n.prototype._customize=function(e){var t=this.options,n=this,i=r(e);return r.isFunction(t.customizeDate)?(r.each(i.find(".wijmo-wijcalendar-day-selectable"),function(e,t){n._customizeDayCell(r(t))}),i):i},n.prototype._createCalendar=function(){return this._customize(r(r.parseHTML(this._getCalendarHtml())))},n.prototype._createMonthGroup=function(){return this._customize(r(this._getMonthGroupHtml()))},n.prototype._getMonthID=function(e){return e.getFullYear()+"_"+(e.getMonth()+1)},n.prototype._createMonthViews=function(){this._monthViews={};var e="",t=this.getDisplayDate(),n,r,i,s;for(n=0;n<this.options.monthRows;n++)for(r=0;r<this.options.monthCols;r++)e=this._getMonthID(t),this._monthViews[e]=new l(this,t),n===0&&(r===0&&(this._monthViews[e].isFirst=!0),r===this.options.monthCols-1&&(this._monthViews[e].isLast=!0)),t=f.addMonths(t,1);t=this.getDisplayDate(),e=this._getMonthID(t),i=this._monthViews[e],i&&(this._groupStartDate=i.getStartDate()),s=this.options.monthRows*this.options.monthCols,s>1&&(t=f.addMonths(t,s-1),e=this._getMonthID(t),i=this._monthViews[e]),i&&(this._groupEndDate=i.getEndDate())},n.prototype._getMonthView=function(e){var t=this._getMonthID(e);return this._monthViews[t]},n.prototype._getId=function(){return this.element.attr("id")},n.prototype._getChildElement=function(e){var t=this.element.find("[id*='"+e+"']");return t.length===0?undefined:t},n.prototype._refreshDayCell=function(e){var t=r(e),n=this.options,i,o,u,a;t.attr("state")===undefined&&t.attr("state","normal");if(t.attr("daytype")===undefined)return;if(t.attr("date")===undefined)return;i=parseInt(t.attr("daytype"),10),o=new Date(t.attr("date")),u=t.attr("state")==="hover",t.attr("class",this._getCellClassName(i,o,undefined).cssCell),t.removeAttr("aria-selected"),i&s.selected&&t.attr("aria-selected",!0);if(r.isFunction(n.customizeDate)&&this._customizeDayCell(t))return;a=t.find("a"),a.length>0&&(a.toggleClass(this.options.wijCSS.stateHover,u),a.toggleClass(this.options.wijCSS.stateActive,(i&s.selected)!==0))},n.prototype._isSingleMonth=function(){return this.options.monthCols*this.options.monthRows===1},n.prototype._splitString=function(e,t,n){if(n===undefined)return e.split(t);var r=[],i=e.split(t),s;for(s=0;s<i.length;s++)s>=n?r[n-1]=r[n-1]+t+i[s]:r.push(i[s]);return r},n.prototype._getNavButtonHtml=function(e,t,n,r){var i=new a;return i.writeBeginTag("a"),i.writeAttribute("id",e),i.writeAttribute("class",t),i.writeAttribute("role","button"),i.writeAttribute("href","#"),r&&(i.writeAttribute("title",r),i.writeAttribute("aria-label",r)),i.writeTagRightChar(),i.writeBeginTag("span"),i.writeAttribute("class",n),i.writeTagRightChar(),r&&i.write(r),i.writeEndTag("span"),i.writeEndTag("a"),i.toString()},n.prototype._getTitleText=function(e){if(this._myGrid!==undefined)return this._myGrid.getTitle();var t=e||this.getDisplayDate(),n=this.options.titleFormat||"MMMM yyyy";return r.isFunction(this.options.title)?this.options.title(t,n)||this._formatDate(n,t):this._formatDate(n,t)},n.prototype._refreshTitle=function(){this.element.find("."+this.options.wijCSS.datepickerTitle).html(this._getTitleText(undefined))},n.prototype._fillTitle=function(e,t){var n=this.options.wijCSS;e.writeBeginTag("div"),e.writeAttribute("class",n.datepickerTitle+" wijmo-wijcalendar-title"+" "+n.stateDefault+" "+n.cornerAll),e.writeTagRightChar(),e.write(this._getTitleText(t)),e.writeEndTag("div")},n.prototype._getHeaderHtml=function(e,t,n){var r=!!this.element.data("preview.wijcalendar"),i=this.options.wijCSS,s=r?"none":this._isSingleMonth()?this.options.navButtons:"default",o=this.element.is("."+i.datepickerRtl),u=new a;return s==="quick"?(u.writeBeginTag("div"),u.writeAttribute("class",i.header+" wijmo-wijcalendar-header "+i.helperClearFix+" "+i.cornerAll),u.writeAttribute("role","heading"),u.writeTagRightChar(),!t||u.write(this._getNavButtonHtml("quickprev","wijmo-wijcalendar-navbutton "+i.datepickerPrev+" "+i.cornerAll,i.icon+" ui-icon-seek-"+(o?"next":"prev")+" "+(o?this.options.wijCSS.iconArrowRight:this.options.wijCSS.iconArrowLeft),this.options.quickPrevTooltip.replace("#",this.options.quickNavStep))),u.writeBeginTag("div"),u.writeAttribute("class",i.datepickerHeader+" wijmo-wijcalendar-header-inner"),u.writeTagRightChar(),!t||u.write(this._getNavButtonHtml("prev","wijmo-wijcalendar-navbutton "+i.datepickerPrev+" "+i.cornerAll,i.icon+" ui-icon-circle-triangle-"+(o?"e":"w")+" "+(o?this.options.wijCSS.iconArrowRight:this.options.wijCSS.iconArrowLeft),this.options.prevTooltip)),this._fillTitle(u,e),!n||u.write(this._getNavButtonHtml("next","wijmo-wijcalendar-navbutton "+i.datepickerNext+" "+i.cornerAll,i.icon+" ui-icon-circle-triangle-"+(o?"w":"e")+" "+(o?this.options.wijCSS.iconArrowLeft:this.options.wijCSS.iconArrowRight),this.options.nextTooltip)),u.writeEndTag("div"),!n||u.write(this._getNavButtonHtml("quicknext","wijmo-wijcalendar-navbutton "+i.datepickerNext+" "+i.cornerAll,i.icon+" ui-icon-seek-"+(o?"prev":"next")+" "+(o?this.options.wijCSS.iconArrowLeft:this.options.wijCSS.iconArrowRight),this.options.quickNextTooltip.replace("#",this.options.quickNavStep))),u.writeEndTag("div")):(u.writeBeginTag("div"),u.writeAttribute("class",i.datepickerHeader+" "+i.header+" "+i.datepickerHeader+" "+i.helperClearFix+" "+i.cornerAll),u.writeAttribute("role","heading"),u.writeTagRightChar(),s!=="none"&&!!t&&u.write(this._getNavButtonHtml("prev","wijmo-wijcalendar-navbutton "+i.datepickerPrev+" "+i.cornerAll,i.icon+" ui-icon-circle-triangle-"+(o?"e":"w")+" "+(o?this.options.wijCSS.iconArrowRight:this.options.wijCSS.iconArrowLeft),this.options.prevTooltip)),this._fillTitle(u,e),s!=="none"&&!!n&&u.write(this._getNavButtonHtml("next","wijmo-wijcalendar-navbutton "+i.datepickerNext+" "+i.cornerAll,i.icon+" ui-icon-circle-triangle-"+(o?"w":"e")+" "+(o?this.options.wijCSS.iconArrowLeft:this.options.wijCSS.iconArrowRight),this.options.nextTooltip)),u.writeEndTag("div")),u.toString()},n.prototype._formatDate=function(e,t){return f.getTicks(t)?Globalize.format(t,e,this._getCulture(null)):"&nbsp;"},n}(t.wijmoWidget);n.wijcalendar=o;var u=function(){function e(){this.initSelector=":jqmData(role='wijcalendar')",this.wijCSS={datepickerInline:"ui-datepicker-inline",datepicker:"ui-datepicker",datepickerCalendar:"ui-datepicker-calendar",datepickerMulti:"ui-datepicker-multi",datepickerRtl:"datepicker-rtl",datepickerOtherMonth:"ui-datepicker-other-month",prioritySecondary:"ui-priority-secondary",effectsWrapper:"ui-effects-wrapper",datepickerNextHover:"ui-datepicker-next-hover",datepickerPrevHover:"ui-datepicker-prev-hover",datepickerNext:"ui-datepicker-next",datepickerPrev:"ui-datepicker-prev",datepickerTitle:"ui-datepicker-title",datepickerWeekDay:"ui-datepicker-week-day",datepickerWeekEnd:"ui-datepicker-week-end",datepickerUnselectable:"ui-datepicker-unselectable",datepickerDaysCellOver:"ui-datepicker-days-cell-over",datepickerToday:"ui-datepicker-today",stateHighlight:"ui-state-highlight",datepickerCurrentDay:"ui-datepicker-current-day",datepickerGroup:"ui-datepicker-group",datepickerGroupFirst:"ui-datepicker-group-first",datepickerGroupLast:"ui-datepicker-group-last",datepickerRowBreak:"ui-datepicker-row-break",datepickerHeader:"ui-datepicker-header",uiIconGripDottedVertical:"ui-icon-grip-dotted-vertical",uiDatepickerWeekCol:"ui-datepicker-week-col"},this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body ui-body-b",stateDefault:"ui-btn ui-btn-b",stateHighlight:"ui-btn-down-e"},this.culture="",this.cultureCalendar="",this.monthCols=1,this.monthRows=1,this.titleFormat="MMMM yyyy",this.showTitle=!0,this.displayDate=undefined,this.dayRows=6,this.dayCols=7,this.weekDayFormat="short",this.showWeekDays=!0,this.showWeekNumbers=!1,this.calendarWeekRule="firstDay",this.minDate=new Date(1900,0,1),this.maxDate=new Date(2099,11,31),this.showOtherMonthDays=!0,this.showDayPadding=!1,this.selectionMode={day:!0,days:!0},this.allowPreview=!1,this.allowQuickPick=!0,this.toolTipFormat="dddd, MMMM dd, yyyy",this.prevTooltip="Previous",this.nextTooltip="Next",this.quickPrevTooltip="Quick Previous",this.quickNextTooltip="Quick Next",this.prevPreviewTooltip="",this.nextPreviewTooltip="",this.navButtons="default",this.quickNavStep=12,this.direction="horizontal",this.duration=250,this.easing="easeInQuad",this.popupMode=!1,this.autoHide=!0,this.customizeDate=null,this.title=null,this.beforeSlide=null,this.afterSlide=null,this.beforeSelect=null,this.afterSelect=null,this.selectedDatesChanged=null}return e}();o.prototype.options=r.extend(!0,{},t.wijmoWidget.prototype.options,new u),r.wijmo.registerWidget("wijcalendar",o.prototype);var a=function(){function e(){this._html=[]}return e.prototype.writeTagLeftChar=function(){this._html[this._html.length]="<"},e.prototype.writeTagRightChar=function(){this._html[this._html.length]=">"},e.prototype.write=function(e){this._html[this._html.length]=" "+e+" "},e.prototype.writeBeginTag=function(e){this._html[this._html.length]="<"+e},e.prototype.writeEndTag=function(e){this._html[this._html.length]="</"+e+">"},e.prototype.writeFullBeginTag=function(e){this._html[this._html.length]="<"+e+">"},e.prototype.writeSelfClosingTagEnd=function(){this._html[this._html.length]="/>"},e.prototype.writeAttribute=function(e,t){if(t===undefined||t===null)return;this._html[this._html.length]=" "+e+'="',this._html[this._html.length]=t,this._html[this._html.length]='"'},e.prototype.clean=function(){this._html=[]},e.prototype.toString=function(){return this._html.join("")},e}();n.htmlTextWriter=a;var f={addDays:function(e,t){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate()+t);return t&&n.getDate()===e.getDate()&&(n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),n.setTime(n.getTime()+t*24*3600*1e3)),n},addMonths:function(e,t){return new Date(e.getFullYear(),e.getMonth()+t,1)},addYears:function(e,t){return this.addMonths(e,t*12)},getDate:function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())},getTicks:function(e){return e.valueOf()},isSameDate:function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},isSameMonth:function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()},getDaysInMonth:function(e){return(new Date(e.getFullYear(),e.getMonth()+1,0)).getDate()},getWeekStartDate:function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()-(e.getDay()-t+7)%7)},getDayOfYear:function(e){var t=new Date(e.getFullYear(),0,1),n=this.getTicks(e)-this.getTicks(t),r=n/864e5;return Math.floor(r)+1},getFirstDayWeekOfYear:function(e,t){var n=this.getDayOfYear(e)-1,r=e.getDay()-n%7,i;return r=(r-t+14)%7,i=(n+r)/7,Math.floor(i)+1},getDayOfWeek:function(e,t){return(e.getDay()-t+7)%7},getWeekOfYearFullDays:function(e,t,n,r){var i=this.getDayOfYear(e)-1,s=e.getDay()-i%7;return s=(n-s+14)%7,s&&s>=r&&(s-=7),s=i-s,s>=0?Math.floor(s/7)+1:this.getWeekOfYearFullDays(this.addDays(e,-(i+1)),t,n,r)},getWeekOfYear:function(e,t,n){switch(t){case"firstDay":return this.getFirstDayWeekOfYear(e,n);case"firstFullWeek":return this.getWeekOfYearFullDays(e,t,n,7);case"firstFourDayWeek":return this.getWeekOfYearFullDays(e,t,n,4)}return this.getFirstDayWeekOfYear(e,n)},getDateToken:function(e){return e.getFullYear()+"_"+e.getMonth()+"_"+e.getDate()}},l=function(){function e(e,t){this.calendar=e;if(t===undefined||f.isSameDate(t,new Date(1900,0,1)))t=new Date;this.displayDate=t,this.id=this.calendar._getId()+"_"+this.calendar._getMonthID(t),this.isFirst=!1,this.isLast=!1,this.showPreview=!1,this.culture=this.calendar._getCulture(),this._calcDates(this.displayDate)}return e.prototype._calcDates=function(e){var t=f.getDaysInMonth(e);this._startDateInMonth=new Date(e.getFullYear(),e.getMonth(),1),this._endDateInMonth=f.addDays(this._startDateInMonth,t-1),this._startDate=f.getWeekStartDate(this._startDateInMonth,this.culture.calendar.firstDay),this._endDate=f.addDays(this._startDate,this.calendar.options.dayRows*this.calendar.options.dayCols-1)},e.prototype._isFirstMonth=function(){var e=this.calendar.getDisplayDate();return f.isSameMonth(this._startDateInMonth,e)},e.prototype._isLastMonth=function(){var e=this.calendar.getDisplayDate();return e=new Date(e.getFullYear(),e.getMonth(),1),e=f.addMonths(e,this.calendar.options.monthCols*this.calendar.options.monthRows-1),f.isSameMonth(this._startDateInMonth,e)},e.prototype.getStartDate=function(){return this._startDate},e.prototype.getEndDate=function(){return this._endDate},e.prototype._getMonthDate=function(){return this._startDateInMonth===undefined,this._startDateInMonth},e.prototype._setMonthDate=function(e){this._calcDates(e)},e.prototype._getWeekDayText=function(e,t){t=t||"short";var n=this.culture.calendar.days,r="";switch(t){case"full":r=n.names[e];break;case"firstLetter":r=n.names[e].substring(0,1);break;case"abbreviated":r=n.namesAbbr[e];break;default:r=n.namesShort[e]}return r},e.prototype._getRowCount=function(){var e=this.calendar.options;return e.showWeekDays?e.dayRows+1:e.dayRows},e.prototype._getColCount=function(){var e=this.calendar.options;return e.showWeekNumbers?e.dayCols+1:e.dayCols},e.prototype._getDayType=function(e){var t=this.calendar.options,n=s.general,r=e.getDay(),i=r===6||r===0,o=e<t.minDate||e>t.maxDate,u=e<this._startDateInMonth||e>this._endDateInMonth,a=o||this.calendar._getDisabledDates().contains(e),l=this.calendar._getSelectedDates().contains(e),c=new Date,h=f.isSameDate(e,c),p=!1;return i&&(n|=s.weekEnd),h&&(n|=s.today),a&&(n|=s.disabled),u&&(n|=s.otherMonth),o&&(n|=s.outOfRange),l&&(n|=s.selected),p&&(n|=s.custom),u&&!t.showOtherMonthDays&&(n|=s.gap),n},e.prototype._refreshDate=function(e){if(e<this._startDate||e>this._endDate)return;var t=this.calendar.options,n=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),i=Date.UTC(this._startDate.getFullYear(),this._startDate.getMonth(),this._startDate.getDate()),s=Math.floor(Math.abs(n-i)/864e5),o=Math.floor(s/this.calendar.options.dayCols),u=Math.floor(s%this.calendar.options.dayCols),a,f,l,c;t.showWeekNumbers&&u++,t.showWeekDays&&o++,a=r("#"+this.id,this.calendar.element).get(0),a&&o<a.rows.length&&(f=a.rows[o],u<f.cells.length&&(l=f.cells[u],c=this._getDayType(e),r(l).attr("daytype",c.toString()),this.calendar._refreshDayCell(l)))},e.prototype._fillDayCell=function(e,t,n){var r=this.calendar.options,i=null,o=t.getDate().toString(),u=this.calendar._formatDate(r.toolTipFormat||"dddd, MMMM dd, yyyy",t),a=this._getDayType(t),f=this.calendar._isSelectable(a),l=this.calendar._getCellClassName(a,t,n);o=r.showDayPadding&&o.length===1?"0"+o:o,e.writeBeginTag("td"),e.writeAttribute("daytype",a.toString()),f&&(e.writeAttribute("title",u),e.writeAttribute("aria-label",u)),e.writeAttribute("date",t.toDateString()),e.writeAttribute("class",l.cssCell),e.writeAttribute("role","gridcell"),f||e.writeAttribute("aria-disabled","true"),e.writeTagRightChar(),a&s.gap?e.write("&#160;"):i&&i.content?e.write(i.content):(e.writeBeginTag("a"),e.writeAttribute("class",l.cssText),e.writeAttribute("href","#"),e.writeAttribute("onclick","return false;"),e.writeTagRightChar(),e.write(o),e.writeEndTag("a")),e.writeEndTag("td")},e.prototype.getHtml=function(e){e=!!e;var t=this.calendar.options,n=t.wijCSS,r=!!this.calendar.element.data("preview.wijcalendar"),i=new a,s,o,u,l,c,h,p,d,v,m,g,y;!e&&t.showTitle&&i.write(this.calendar._getHeaderHtml(this._startDateInMonth,this.isFirst,this.isLast)),!e&&!r&&this.showPreview&&(i.writeBeginTag("div"),i.writeAttribute("class","wijmo-wijcalendar-prevpreview-button"),i.writeAttribute("role","button"),i.writeAttribute("aria-haspopup","true"),i.writeAttribute("id","prevPreview"),i.writeTagRightChar(),i.writeBeginTag("a"),i.writeAttribute("class",n.icon+" "+n.uiIconGripDottedVertical),i.writeAttribute("href","#"),i.writeAttribute("title",t.prevPreviewTooltip),i.writeAttribute("aria-label",t.prevPreviewTooltip),i.writeAttribute("onclick","return false;"),i.writeTagRightChar(),i.write("&#160;"),i.writeEndTag("a"),i.writeEndTag("div")),i.writeBeginTag("table"),i.writeAttribute("id",this.id),i.writeAttribute("class",n.datepickerCalendar+" wijmo-wijcalendar-table"),i.writeAttribute("role","grid"),i.writeAttribute("summary",this.calendar._getTitleText(this._startDateInMonth)),i.writeAttribute("onselectstart","return false;"),i.writeTagRightChar();if(t.showWeekDays){i.writeFullBeginTag("thead"),i.writeBeginTag("tr"),i.writeTagRightChar(),t.showWeekNumbers&&(i.writeBeginTag("th"),i.writeAttribute("id",this.id+"_ms"),i.writeAttribute("class",n.uiDatepickerWeekCol+" wijmo-wijcalendar-monthselector"+(t.selectionMode.month?" wijmo-wijcalendar-selectable":"")),i.writeAttribute("role","columnheader"),i.writeTagRightChar(),!!t.selectionMode.month&&!r?(i.writeBeginTag("a"),i.writeAttribute("class",n.icon+" "+n.iconArrowRightDown),i.writeAttribute("style","display: block;"),i.writeSelfClosingTagEnd()):i.write(t.weekString?t.weekString:"Wk"),i.writeEndTag("th")),u=this._startDate.getDay(),l=this._startDate;for(s=0;s<t.dayCols;s++)c=u===6||u===0,h=s+(t.showWeekNumbers?1:0),p=this._getWeekDayText(u,t.weekDayFormat),d=this._getWeekDayText(u,"full"),i.writeBeginTag("th"),i.writeAttribute("id",this.id+"_cs_"+h),i.writeAttribute("class",n.datepickerWeekDay+(c?" "+n.datepickerWeekEnd:"")+(t.selectionMode.weekDay?" wijmo-wijcalendar-selectable":"")),i.writeAttribute("role","columnheader"),i.writeTagRightChar(),i.writeBeginTag("span"),i.writeAttribute("title",d),i.writeAttribute("aria-label",d),i.writeTagRightChar(),i.write(p),i.writeEndTag("span"),i.writeEndTag("th"),u=(u+1)%7,l=f.addDays(l,1);i.writeEndTag("tr"),i.writeEndTag("thead")}i.writeFullBeginTag("tbody"),v=this._startDate,m=this._startDateInMonth;for(s=0;s<t.dayRows;s++){i.writeBeginTag("tr"),i.writeTagRightChar(),t.showWeekNumbers&&(g=s+(t.showWeekDays?1:0),i.writeBeginTag("td"),i.writeAttribute("id",this.id+"_rs_"+g),i.writeAttribute("class",n.uiDatepickerWeekCol+" wijmo-wijcalendar-week-num"+(t.selectionMode.weekNumber?" wijmo-wijcalendar-selectable":"")),i.writeAttribute("role","rowheader"),i.writeTagRightChar(),y=f.getWeekOfYear(m,t.calendarWeekRule,this.culture.calendar.firstDay),i.write(y),i.writeEndTag("td"),m=f.addDays(m,t.dayCols));for(o=0;o<t.dayCols;o++)this._fillDayCell(i,v,r),v=f.addDays(v,1);i.writeEndTag("tr")}return i.writeEndTag("tbody"),i.writeEndTag("table"),!e&&!r&&this.showPreview&&(i.writeBeginTag("div"),i.writeAttribute("class","wijmo-wijcalendar-nextpreview-button"),i.writeAttribute("role","button"),i.writeAttribute("aria-haspopup","true"),i.writeAttribute("id","nextPreview"),i.writeTagRightChar(),i.writeBeginTag("a"),i.writeAttribute("class",n.icon+" "+n.uiIconGripDottedVertical),i.writeAttribute("href","#"),i.writeAttribute("title",t.nextPreviewTooltip),i.writeAttribute("aria-label",t.nextPreviewTooltip),i.writeAttribute("onclick","return false;"),i.writeTagRightChar(),i.write("&#160;"),i.writeEndTag("a"),i.writeEndTag("div")),i.toString()},e}();n.wijMonthView=l;var c=function(){function e(e,t){this._calendar=e,this._optionName=t?t:"selectedDates",this._normalize()}return e.prototype.getDates=function(){return this._calendar.options[this._optionName]===undefined&&(this._calendar.options[this._optionName]=[]),this._calendar.options[this._optionName]},e.prototype.setDates=function(e){this._calendar.options[this._optionName]=e,this._normalize()},e.prototype.getCount=function(){return this.getDates().length},e.prototype.clear=function(){this.setDates([])},e.prototype.add=function(e){this.addRange(e,e)},e.prototype.remove=function(e){this.removeRange(e,e)},e.prototype.indexOf=function(e){return this.getCount()?this._findRangeBound(e,!0,!1):-1},e.prototype.contains=function(e){return this.indexOf(e)!==-1},e.prototype.removeRange=function(e,t){if(!this.getCount())return;var n=this._findRangeBound(e,!1,!0),r=this._findRangeBound(t,!1,!1),i,s,o;if(n<0||r<0)return;if(n>r)return;i=this.getDates();if(i[r]>t)return;s=n?i.slice(0,n):[],o=r>=i.length-1?[]:i.slice(r+1),this.setDates(s.concat(o))},e.prototype.addRange=function(e,t){this.removeRange(e,t);var n=this.getDates(),r=this._findRangeBound(e,!1,!0),i=r?n.slice(0,r):[],s=n.slice(r),o=[],u;e=f.getDate(e),t=f.getDate(t);for(u=e;u<=t;u=f.addDays(u,1))o[o.length]=u;this.setDates(i.concat(o.concat(s)))},e.prototype._findRangeBound=function(e,t,n){var r=this.getDates(),i=0,s=r.length,o;while(i<s){o=i+s>>1;if(f.isSameDate(e,r[o]))return o;e<r[o]?s=o:i=o+1}return t?-1:n?i:s},e.prototype._parseDate=function(e){var t;e?typeof e=="string"&&(t=e):e=new Date;if(t){t=t.replace(/-/g,"/");try{e=new Date(t),isNaN(e)&&(e=new Date)}catch(n){e=new Date}}return e},e.prototype._normalize=function(){var e=this._calendar.options[this._optionName],t=this,n;r.isArray(e)&&(n=r.map(e,function(e,n){return t._parseDate(e)}),this._calendar.options[this._optionName]=n.sort(function(e,t){return e.getTime()-t.getTime()}))},e}();n.wijDateCollection=c;var h=function(){function e(e){this.gridType="month",this.calendar=e,e&&(this.culture=e._getCulture())}return e.prototype._getLastDate=function(e,t){var n;return t++,n=new Date(e,t,1),(new Date(n.getTime()-864e5)).getDate()},e.prototype.select=function(e,t){var n=this.calendar.getDisplayDate(),r,i;switch(this.gridType){case"month":r=this._getLastDate(n.getFullYear(),n.getMonth()),i=this._getLastDate(n.getFullYear(),t),r>i&&n.setDate(i),n.setMonth(t);break;case"year":n.setFullYear(t);break;case"decade":n.setFullYear(t)}this.calendar.options.displayDate=n},e.prototype.getSelectedIndex=function(){var e=this.calendar.getDisplayDate(),t=e.getFullYear(),n=Math.floor(t/10)*10-1,r=Math.floor(t/100)*100-10;switch(this.gridType){case"month":return e.getMonth();case"year":return t-n;case"decade":return Math.floor((t-r)/10)}return 0},e.prototype.getTitle=function(){var e=this.calendar.getDisplayDate(),t=e.getFullYear(),n=Math.floor(t/10)*10-1,r=Math.floor(t/100)*100-10;switch(this.gridType){case"month":return t.toString();case"year":return n+1+" - "+(n+10);case"decade":return r+10+" - "+(r+109)}return""},e.prototype.getHtml=function(e,t){e===undefined?e=this.calendar.getDisplayDate():typeof e=="boolean"&&(t=e,e=this.calendar.getDisplayDate()),t=!!t;var n=this.calendar.options,r=3,i=4,s=new a,o=n.wijCSS,u,f,l,c,h,p,d,v,m,g,y,b,w,E;n.showTitle&&!t&&s.write(this.calendar._getHeaderHtml(null,!0,!0)),u=100/r+"%",u="30%",s.writeBeginTag("table"),s.writeAttribute("class",o.datepickerCalendar+" wijmo-wijcalendar-mygrid"),s.writeAttribute("role","grid"),s.writeAttribute("onselectstart","return false;"),s.writeTagRightChar(),f=e.getFullYear(),l=e.getFullYear()*12,c=Math.floor(f/10)*10-1,h=Math.floor(f/100)*100-10,p=this.culture.calendar.months;for(d=0;d<r;d++){s.writeBeginTag("tr"),s.writeAttribute("height",u),s.writeTagRightChar();for(v=0;v<i;v++){m=d*4+v,g=!1,y=!1,b="",w=null;switch(this.gridType){case"month":e.getMonth()===m&&(g=!0),w=m,b=p.namesAbbr[m],y=l+m<n.minDate.getFullYear()*12+n.minDate.getMonth()||l+m>n.maxDate.getFullYear()*12+n.maxDate.getMonth();break;case"year":if(m===0||m===11)y=!0;w=c+m,w<n.minDate.getFullYear()||w>n.maxDate.getFullYear()?y=!0:g=f===w,b=w.toString();break;case"decade":if(m===0||m===11)y=!0;w=h+m*10,w+10<n.minDate.getFullYear()||w>n.maxDate.getFullYear()?y=!0:g=f>=w&&f<w+10,b=w.toString()+"-<br/>"+(w+9).toString()}E=o.datepickerWeekDay,y?E=E+" "+o.datepickerOtherMonth+" "+o.prioritySecondary+" "+o.datepickerUnselectable:this.calendar._isDisabled()||(E+=" wijmo-wijcalendar-day-selectable"),E+=" "+o.stateDefault+(y?" "+o.stateDisabled:"")+(g?" "+o.stateActive+" "+o.stateHighlight:""),s.writeBeginTag("td"),s.writeAttribute("class",E),s.writeAttribute("role","gridcell"),s.writeAttribute("index",m.toString()),s.writeAttribute("value",w.toString()),s.writeAttribute("other",y.toString()),s.writeTagRightChar(),s.writeBeginTag("a"),y&&s.writeAttribute("onclick","return false;"),s.writeAttribute("href","#"),s.writeTagRightChar(),s.write(b),s.writeEndTag("a"),s.writeEndTag("td")}s.writeEndTag("tr")}return s.writeEndTag("table"),s.toString()},e}();n.wijMyGrid=h})(t.calendar||(t.calendar={}));var n=t.calendar})(wijmo||(wijmo={}))});