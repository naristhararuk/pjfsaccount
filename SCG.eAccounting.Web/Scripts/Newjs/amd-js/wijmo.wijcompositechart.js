var wijmo;define(["./wijmo.wijbarchart","./wijmo.wijbubblechart","./wijmo.wijpiechart","./wijmo.wijlinechart","./wijmo.wijscatterchart","./wijmo.wijcandlestickchart"],function(){var e=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};(function(t){(function(n){var r=$.wijmo.wijcandlestickchart,i=function(i){function s(){i.apply(this,arguments)}return e(s,i),s.prototype._create=function(){var e=this,t=e.options,r=e._getDefFill(),s,o,u;$.each(t.seriesList,function(r,i){if(i.type==="bar")return $.isArray(t.axis.y)?$.each(t.axis.y,function(t,n){n.compass=e._adjustCompassForBarChart(n.compass,"y")}):t.axis.y.compass=e._adjustCompassForBarChart(t.axis.y.compass,"y"),t.axis.x.compass=e._adjustCompassForBarChart(t.axis.x.compass,"x"),!0;i.type==="pie"&&i.pieSeriesList?i.data=i.pieSeriesList:i.type==="sharedPie"&&i.sharedPieChartSeries&&i.sharedPieChartSeries.length>0?($.each(i.sharedPieChartSeries,function(e,t){t.pieSeriesList&&(t.data=t.pieSeriesList)}),i.data=i.sharedPieChartSeries):i.candlestickSeries&&i.candlestickSeries.data&&$.inArray(i.type,["hl","ohlc","candlestick"])!=-1?i.data=i.candlestickSeries.data:i.type===n.ChartConsts.strTrendline&&i.trendlineSeries&&(i.trendlineSeries.data&&(i.data=i.trendlineSeries.data),i.fitType=i.trendlineSeries.fitType,i.order=i.trendlineSeries.order,i.sampleCount=i.trendlineSeries.sampleCount)}),$.extend(!0,{compass:"east"},t.hint),t.is100Percent&&(t.is100Percent=!1),u=t,u.yAxes&&$.isArray(u.yAxes)&&u.yAxes.length>0&&(o=[],$.each(u.yAxes,function(e,t){o.push($.extend({},u.axis.y,t))}),t.axis.y=o),e._handleChartStyles(),e._checkChartType(),i.prototype._create.call(this),e.chartElement.addClass(t.wijCSS.compositechart)},s.prototype._setOption=function(e,t){e!=="is100Percent"&&(e==="axis"&&this.isContainsCandlestick&&r&&r.prototype._handleMaxMinInAxis.apply(this,[t]),i.prototype._setOption.call(this,e,t))},s.prototype._seriesListSeted=function(){this._checkChartType()},s.prototype._supportStacked=function(){return!0},s.prototype._adjustCompassForBarChart=function(e,t){var n;switch(e){case"west":t==="y"?n="south":n=e;break;case"east":t==="y"?n="north":n=e;break;case"south":t==="x"?n="west":n=e;break;case"north":t==="x"?n="east":n=e;break;default:t==="x"?n="west":n="south"}return n},s.prototype.destroy=function(){var e=this,t=e.chartElement,n=t.data("fields"),r=n&&n.aniBarsAttr;t.removeClass(e.options.wijCSS.compositechart),this.timeUtil&&this.timeUtil.dispose(),i.prototype.destroy.call(this),e._destroyRaphaelArray(r),e.aniPathsAttr=null,t.data("fields",null)},s.prototype._isBarChart=function(){return!0},s.prototype._clearChartElement=function(){var e=this,t=e.options,n=e.chartElement,r=n.data("fields");r&&r.allElements&&($.each(r.allElements,function(t,n){t==="scatters"&&n.length&&$.each(n,function(e,t){t.length&&($.each(t,function(e,n){n&&n.remove&&n.remove(),t[e]=null}),n[e]=null)}),e._destroyRaphaelArray(n)}),r.allElements=null),i.prototype._clearChartElement.call(this),r&&r.ctracers&&(r.ctracers=null),e.element.removeData("plotInfos"),t.seriesTransition.enabled||r&&r.aniBarsAttr&&(r.aniBarsAttr=null),r&&r.pieSeriesTitles&&e._destroyRaphaelArray(r.pieSeriesTitles)},s.prototype._bindSeriesData=function(e,t,n){var r=this,s=this,o=t.data,u=t.type,a,f,l,c=[],h;if(u==="pie")a=o.label,f=o.value,l=o.offset,a&&a.bind&&(a=this._getBindData(e,a.bind)),f&&f.bind&&(f=this._getBindData(e,f.bind)),l&&l.bind&&(l=this._getBindData(e,l.bind)),a&&$.isArray(a)&&a.length&&f&&$.isArray(f)&&f.length&&($.each(f,function(e,t){var n,r=0;e>=0&&e<a.length&&(n=a[e]),l&&$.isArray(f)&&l.length&&e>=0&&e<l.length&&(r=typeof l[e]=="undefined"?0:l[e]),c.push({data:t,label:n,offset:r,legendEntry:!0})}),t.data=c);else if(u==="sharedPie"){if($.isArray(o)){t.sharedPieChartSeries=[],$.each(o,function(e,n){var r=n.data,i=n.datasource;i&&(a=r.label,f=r.value,l=r.offset,a&&a.bind&&(a=s._getBindData(i,a.bind)),f&&f.bind&&(f=s._getBindData(i,f.bind)),l&&l.bind&&(l=s._getBindData(i,l.bind)),h={center:n.center,label:n.label,legendEntry:n.legendEntry,radius:n.radius,data:[]},f&&$.each(f,function(e,t){var n,r=0;e>=0&&e<a.length&&(n=a[e]),l&&$.isArray(f)&&l.length&&e>=0&&e<l.length&&(r=typeof l[e]=="undefined"?0:l[e]),h.data.push({data:t,label:n,offset:r,legendEntry:!0})}),t.sharedPieChartSeries.push(h))});var p=[],d;a&&$.isArray(a)&&$.each(a,function(e,n){d={},d.valueArray=[],d.label=n,d.legendEntry=t.legendEntry!==!1,p.push(d)}),t.sharedPieLegends=p}}else i.prototype._bindSeriesData.call(this,e,t,n),o.x&&$.isArray(o.x)&&(this.bindXData=!0),$.each(["high","low","open","close","y1"],function(t,n){var i=o[n];i&&i.bind&&(o[n]=r._getBindData(e,i.bind))})},s.prototype._preHandleSeriesData=function(){var e=this,t=e.options,n,r;e.isContainsCandlestick&&(e.timeUtil&&(e.timeUtil.dispose(),e.timeUtil=null),e._handleXDataForCandlestick()),i.prototype._preHandleSeriesData.call(this),$.each(t.seriesList,function(e,t){if(t.type==="sharedPie"){if(!t.sharedPieChartSeries||t.sharedPieChartSeries.length===0){t.sharedPieChartSeries=[];for(var i=0;i<t.data.length;i++)t.data[i]&&t.sharedPieChartSeries.push(t.data[i])}if(!t.sharedPieLegends||t.sharedPieLegends.length===0){t.sharedPieLegends=[];if(t.sharedPieChartSeries.length===0)return;n=t.sharedPieChartSeries[0],$.each(n.data,function(e,n){r={},r.label=n.label,r.legendEntry=n.legendEntry,r.visible=n.visible!==!1,t.sharedPieLegends.push(r)})}}})},s.prototype.getElement=function(e,t,r){var i=this.chartElement,s=i.data("fields"),o=s.chartElements;switch(e){case"bar":case"column":return o.bars[t];case"line":case"area":return o.paths[t];case"linemarkers":return o.markersSet[t];case"pie":case"sharedPie":return this._getPie(o,t,r);case n.ChartConsts.strTrendline:return o.trendLines[t]}return null},s.prototype._getPie=function(e,t,n){if(n!==undefined)return e["sectors"+n]?e["sectors"+n][t]:null;var r=[];return $.each(e,function(e,t){/sectors/.test(e)&&e!=="sectors"&&$.each(t,function(e,t){r.push(t)})}),r.length===0&&(r=e.sectors),r[t]},s.prototype._getLegendSeriesInfoList=function(){var e=this,t=e.options,r,i=t.seriesList,s=t.seriesStyles,o=[],u=0;return $.each(i,function(t,i){var a;if(i.isTrendline)i.legendEntry!==!1&&(r=e._getTrendLineLegendInfoFromSeries(u,i,s[u]),r&&o.push(r)),n.TrendlineRender.validateType(i.fitType)&&u++;else{a=i.type;if(a!=="pie"&&a!=="sharedPie")i.legendEntry!==!1&&(r=e._getLegendInfoFromSeries(u,i,s[u]),o.push(r)),u++;else{var f=a==="pie"?i.data:i.sharedPieLegends;$.each(f,function(t,n){n=$.extend({legendEntry:i.legendEntry},n),n.legendEntry!==!1&&(r=e._getLegendInfoFromSeries(u,n,s[u]),o.push(r)),u++})}}}),o},s.prototype._getLegendInfoFromSeries=function(e,t,n){if(t.LegendEntry===!1)return undefined;var r=this.options,s=t.type,o,u,a,f,l;l=i.prototype._getLegendInfoFromSeries.call(this,e,t,n),a=l.iconStyle;if(s==="line"||s==="area"||s==="spline"||s==="bezier")l.icon="line",o=$.extend(!0,{width:22,height:3},this.options.legend.size),a&&(u=o.height,a=$.extend(!0,{},a,{"stroke-width":u}),a["stroke-dasharray"]&&(a=$.extend(!0,{},a,{"stroke-width":1,"stroke-dasharray":a["stroke-dasharray"]}))),l.iconSize=o,l.iconStyle=a,l.markers=t.markers?t.markers.type:undefined,l.markerVisible=t.markers?t.markers.visible:!1,f=$.extend({fill:a.stroke,stroke:a.stroke,opacity:1},t.markerStyle),l.markerStyle=f;else if(s==="scatter"||s==="bubble"){o=$.extend(!0,{width:20,height:10},this.options.legend.size);var c=s==="scatter"?6:o.r?o.r:Math.min(o.width,o.height);f=$.extend({fill:a.fill,stroke:a.stroke,opacity:1},t.markerStyle),l.iconStyle=f,t.markerType?l.icon=t.markerType:l.icon="circle",l.markers=undefined,l.markerVisible=!1,l.markerStyle=undefined,l.iconSize=$.extend(!0,{},{r:c},o)}return l},s.prototype._showHideCandlestickSeries=function(e,t){r&&r.prototype._showHideSeries.apply(this,arguments)},s.prototype._showSerieEles=function(e){var t=e.type,r=e.eles,i=[],s=this.options.showChartLabels,o;switch(t){case"pie":r?i=[e]:i=e.sharedSeriesEles,$.each(i,function(e,t){r=t.eles,r.sector&&(r.sector.show(),r.sector.shadow&&r.sector.shadow.show(),r.sector.tracker&&r.sector.tracker.show()),r.label&&r.label.show()});break;case"line":case"spline":case"bezier":case"area":r.markers&&$.each(r.markers,function(e,t){o=$(t.node).data("wijchartDataObj");if(o&&o.lineSeries&&o.lineSeries.markers&&!o.lineSeries.markers.visible)return!0;t.show()}),r.dcl&&$.each(r.dcl,function(e,t){s&&t.show()});if(r.path){o=$(r.path.node).data("wijchartDataObj");if(o.visible||!(!o.visible&&o.markers&&o.markers.visible))r.path.show(),r.path.shadow&&r.path.shadow.show(),r.path.area&&r.path.area.show(),r.path.tracker&&r.path.tracker.show(),$(r.path.node).data("wijchartDataObj")&&$(r.path.node).data("wijchartDataObj").virtualMarkers&&$.each($(r.path.node).data("wijchartDataObj").virtualMarkers,function(e,t){t.visible=!0})}break;case"bar":case"column":$.each(r,function(e,t){t.bar&&(t.bar.show(),t.bar.shadow&&t.bar.shadow.show(),t.bar.tracker&&t.bar.tracker.show(),$(t.bar.node).data("wijchartDataObj")&&($(t.bar.node).data("wijchartDataObj").visible=!0)),t.dcl&&t.dcl.show(),t.animatedBar&&!t.animatedBar.removed&&t.animatedBar.show()});break;case"scatter":$.each(r,function(e,t){t.show(),t.label&&t.label.show(),$(t.element).data("wijchartDataObj")&&($(t.element).data("wijchartDataObj").visible=!0)});break;case"ohlc":case"hl":case"candlestick":this._showHideCandlestickSeries(r,"show");break;case"bubble":$.each(r,function(e,t){t.bubble&&(t.bubble.show(),t.bubble.shadow&&t.bubble.shadow.show(),t.bubble.tracker&&t.bubble.tracker.show(),$(t.bubble.node).data("wijchartDataObj")&&($(t.bubble.node).data("wijchartDataObj").visible=!0)),t.dcl&&t.dcl.show(),t.symbol&&t.symbol.show()});case n.ChartConsts.strTrendline:n.TrendlineRender.showSerieEles(r)}},s.prototype._hideSerieEles=function(e){var t=e.type,r=e.eles,i=[];switch(t){case"pie":r?i=[e]:i=e.sharedSeriesEles,$.each(i,function(e,t){r=t.eles,r.sector&&(r.sector.hide(),r.sector.shadow&&r.sector.shadow.hide(),r.sector.tracker&&r.sector.tracker.hide()),r.label&&r.label.hide()});break;case"line":case"spline":case"bezier":case"area":r.markers&&$.each(r.markers,function(e,t){t.hide()}),r.dcl&&$.each(r.dcl,function(e,t){t.hide()}),r.path&&(r.path.hide(),r.path.shadow&&r.path.shadow.hide(),r.path.area&&r.path.area.hide(),r.path.tracker&&r.path.tracker.hide(),$(r.path.node).data("wijchartDataObj")&&$(r.path.node).data("wijchartDataObj").virtualMarkers&&$.each($(r.path.node).data("wijchartDataObj").virtualMarkers,function(e,t){t.visible=!1}));break;case n.ChartConsts.strTrendline:n.TrendlineRender.hideSerieEles(r);break;case"bar":case"column":$.each(r,function(e,t){t.bar&&(t.bar.hide(),t.bar.shadow&&t.bar.shadow.hide(),t.bar.tracker&&t.bar.tracker.hide(),$(t.bar.node).data("wijchartDataObj")&&($(t.bar.node).data("wijchartDataObj").visible=!1)),t.dcl&&t.dcl.hide(),t.animatedBar&&!t.animatedBar.removed&&t.animatedBar.hide()});break;case"scatter":$.each(r,function(e,t){t.hide(),t.label&&t.label.hide(),$(t.element).data("wijchartDataObj")&&($(t.element).data("wijchartDataObj").visible=!1)});break;case"ohlc":case"hl":case"candlestick":this._showHideCandlestickSeries(r,"hide");break;case"bubble":$.each(r,function(e,t){t.bubble&&(t.bubble.hide(),t.bubble.shadow&&t.bubble.shadow.hide(),t.bubble.tracker&&t.bubble.tracker.hide(),$(t.bubble.node).data("wijchartDataObj")&&($(t.bubble.node).data("wijchartDataObj").visible=!1)),t.dcl&&t.dcl.hide(),t.symbol&&t.symbol.hide()})}},s.prototype._indicatorLineShowing=function(e){var t;i.prototype._indicatorLineShowing.call(this,e),$.each(e,function(e,n){t=n.type,t==="column"||t==="bar"?n.bar&&n.bar.attr(n.hoverStyle):t==="marker"?n.marker&&n.marker.attr(n.markerHoverStyle):t==="scatter"&&n.dot&&(n.dot.attr(n.hoverStyle),n.dot.scale(1.5,1.5))})},s.prototype._removeIndicatorStyles=function(e){var t;$.each(e,function(e,n){t=n.type,t==="column"||t==="bar"?n.bar&&n.bar.attr(n.style):t==="marker"?n.marker&&(n.marker.attr(n.markerStyle),n.marker.transform("s1")):t==="scatter"&&n.dot&&(n.dot.attr(n.style),n.dot.scale(1,1))})},s.prototype._paintTooltip=function(){var e=this,t=e.chartElement,n=t.data("fields")||{},r=n.ctracers||[];i.prototype._paintTooltip.call(this),e.tooltip&&$.each(r,function(t,n){n.trackers&&n.trackers.length&&t===0&&e.tooltip.setOptions({relatedElement:n.trackers[0]})})},s.prototype._setDefaultTooltipText=function(e){return e.type==="candlestick"&&r?r.prototype._setDefaultTooltipText.apply(this,arguments):i.prototype._setDefaultTooltipText.call(this,e)},s.prototype._checkChartType=function(){var e=this;this.isContainsBubble=!1,this.isContainsCandlestick=!1,$.each(this.options.seriesList,function(t,n){var r=n.type;!!e.isContainsCandlestick||r!=="ohlc"&&r!=="hl"&&r!=="candlestick"?!e.isContainsBubble&&r==="bubble"&&(e.isContainsBubble=!0):e.isContainsCandlestick=!0})},s.prototype._handleXDataForCandlestick=function(){r&&r.prototype._handleXData.apply(this,arguments)},s.prototype._isCandlestickSeries=function(e){var t=e.type;return t==="ohlc"||t==="hl"||t==="candlestick"},s.prototype._paintChartArea=function(){var e=this,t=e.options.seriesList;if(e._isSeriesListDataEmpty())return;$.each(t,function(t,n){var r=n.data;e._isCandlestickSeries(n)&&(r.y=[].concat(r.high).concat(r.low))}),this.bubbleAxisAdjust&&this.bubbleAxisAdjust.dispose(),this.bubbleAxisAdjust=new n.BubbleAxisAdjust(this),i.prototype._paintChartArea.call(this),$.each(t,function(t,n){e._isCandlestickSeries(n)&&delete n.data.y,n.data&&n.data.originalXValue&&(n.data.x=n.data.originalXValue,delete n.data.originalXValue)})},s.prototype._checkSeriesDataEmpty=function(e){var t=e.type,n=e.data,r=!1,s=this._checkEmptyData;if(this._isCandlestickSeries(e)){if(!n||s(n.x)||s(n.high)||s(n.low))return!0;if(t==="ohlc"||t==="candlestick")if(s(n.open)||s(n.low))return!0;return!1}if(t==="pie")return!n||!$.isArray(n)?!0:!1;if(t==="sharedPie")return n=e.sharedPieChartSeries,!n||!$.isArray(n)?r=!0:$.each(e.sharedPieChartSeries,function(e,t){if(t.data&&$.isArray(t.data))return r=!1,!1}),r;if(t==="bubble")if(!n||s(n.y1))return!0;return i.prototype._checkSeriesDataEmpty.call(this,e)},s.prototype._getXAxisInfoValueLabels=function(e,t){this.isContainsCandlestick&&e.id==="x"?r.prototype._getXAxisInfoValueLabels.apply(this,arguments):i.prototype._getXAxisInfoValueLabels.call(this,e,t)},s.prototype._calculateMajorMinor=function(e,t){this.isContainsCandlestick&&t.id==="x"?r.prototype._calculateMajorMinor.apply(this,arguments):i.prototype._calculateMajorMinor.call(this,e,t)},s.prototype._adjustXValueLabelsByMajorUnit=function(e,t){this.isContainsCandlestick&&t.id==="x"&&r.prototype._adjustXValueLabelsByMajorUnit.apply(this,arguments)},s.prototype._getXTickText=function(e){var t=this,n=t.formatString;return t.isContainsCandlestick&&r?r.prototype._getXTickText.apply(this,arguments):e},s.prototype._adjustTickValuesForCandlestickChart=function(e){return this.isContainsCandlestick&&r?r.prototype._adjustTickValuesForCandlestickChart.apply(this,arguments):i.prototype._adjustTickValuesForCandlestickChart.call(this,e)},s.prototype._getTickTextForCalculateUnit=function(e,t,n){return t.id==="x"&&this.isContainsCandlestick?r.prototype._getTickTextForCalculateUnit.apply(this,arguments):i.prototype._getTickTextForCalculateUnit.call(this,e,t,n)},s.prototype._AdjustAxisBounds=function(e,t){var r=this,i=r.options,s,o,u,a,f=e.max,l=e.min,c=f-l,h=n.ChartDataUtil.nicePrecision(c),p=h+1,d=e.bounds,v=$.extend(!0,{},i.textStyle,t.textStyle,t.labels.style);s=r._text(-1e3,-1e3,$.round(f,p).toString()).attr(v),o=r._text(-1e3,-1e3,$.round(l,p).toString()).attr(v),u=s.wijGetBBox(),a=o.wijGetBBox(),e.isStartAxis||(d.startY+=a.height),e.isLastAxis||(d.endY-=u.height)},s.prototype._initYAxisHeight=function(){var e=this,t=e.options,n=t.axis,r=n.y,i=e.canvasBounds,s=i.endX-i.startX,o=i.endY-i.startY,u=e.axisInfo,a=u.y,f=0,l=-1,c=0,h;$.isArray(r)&&($.each(r,function(e,t){t.height&&!isNaN(t.height)?f+=t.height:t.height==="auto"&&(l=e),a[e].height=t.height}),l>-1&&(a[l].height=o-f),$.each(a,function(t,n){var s=n.height;if(s===undefined||s===null)return!0;s>0&&(n.isPartAxis=!0,n.isLastAxis=parseInt(t)===r.length-1,n.isStartAxis=parseInt(t)===0),h?n.bounds={startY:h.endY,endY:h.endY+s}:n.bounds={startY:i.startY,endY:i.startY+s},n.bounds.startX=i.startX,n.bounds.endX=i.endX,e._AdjustAxisBounds(n,r[t]),n.bounds&&(h=$.extend({},n.bounds))}))},s.prototype._getDataExtreme=function(e){var t=this;return t._initYAxisHeight(),i.prototype._getDataExtreme.call(this,e)},s.prototype._getPieRendererData=function(e,t,n,r,i){var s={},o={},u={},a=e.data;return s.sIndex=i,$.each(a,function(e,a){a.pieID=t,o=$.extend({},n[i]),u=$.extend({},r[i]),s.seriesList||(s.seriesList=[]),s.seriesStyles||(s.seriesStyles=[]),s.seriesHoverStyles||(s.seriesHoverStyles=[]),s.seriesList.push(a),s.seriesStyles.push(o),s.seriesHoverStyles.push(u),i++}),s.radius=e.radius,s.center=e.center,s.label=e.label,s},s.prototype._saveTrakers=function(e){var t=this,n=t.options,r=t.chartElement.data("fields"),i=r.trackers,s;if(e&&i&&i.length)for(s=0;s<i.length;s++)e.push(i[s])},s.prototype._paintPlotArea=function(){var e=this,i=e.options,s="seriesList",o="seriesStyles",u="seriesHoverStyles",a=i[o],f=i[u],l=e.canvasBounds,c={},h=0,p=-1,d=[],v=$.isArray(i.axis.y),m={canvas:e.canvas,tooltip:e.tooltip,bounds:l,widgetName:e.widgetName,seriesTransition:i.seriesTransition,showChartLabels:i.showChartLabels,textStyle:i.textStyle,chartLabelStyle:i.chartLabelStyle,chartLabelFormatString:i.chartLabelFormatString,chartLabelFormatter:i.chartLabelFormatter,shadow:i.shadow,stacked:i.stacked,hint:i.hint,animation:i.animation,disabled:e._isDisabled(),culture:e._getCulture(),widget:this,wijCSS:i.wijCSS,mouseDown:function(t,n){e._trigger("mouseDown",t,n)},mouseUp:function(t,n){e._trigger("mouseUp",t,n)},mouseOver:function(t,n){e._trigger("mouseOver",t,n)},mouseOut:function(t,n){e._trigger("mouseOut",t,n)},mouseMove:function(t,n){e._trigger("mouseMove",t,n)},click:function(t,n){e._trigger("click",t,n)}},g=e.chartElement.data("fields"),y=-1,b,w,E,S,x,T,N,C=e.canvas.set();g&&(g.ctracers=[]),$.each(i[s],function(t,r){var l=n.TrendlineRender.getSeriesChartType(r),d={},m=l,g={},b=$.extend({},a[h]),S=$.extend({},f[h]),x=r.yAxis;if(!l||l.length===0)return!0;if(m==="spline"||m==="bezier")m="line";m==="sharedPie"&&(m="pie"),d=c[m],d||(l==="pie"||l==="sharedPie"?d=[]:d={},c[m]=d,r.hint&&(d.hint=r.hint,i.hint.content||(i.hint.content=r.hint.content),i.hint.title||(i.hint.title=r.hint.title)));if(l==="pie")return y===-1&&(y=t+1),p===-1&&(p=h),g=e._getPieRendererData(r,y,a,f,h),d.push(g),y++,h=p+(r.data.length?r.data.length:0),p=-1,!0;if(l==="sharedPie")return y===-1&&(y=t+1),w=r.sharedPieChartSeries,E={type:"sharedPies",pies:[]},p===-1&&(p=h),$.each(w,function(t,n){g={},n.radius=n.radius||r.radius,n.label=n.label||r.label,!n.center&&r.center&&(n.center={x:r.center.x,y:r.center.y}),h=p,g=e._getPieRendererData(n,y,a,f,h),E.pies.push(g),y++,h=p+(n.data.length?n.data.length:0)}),l==="sharedPie"&&d.push(E),p=-1,!0;l==="column"?d.horizontal=!1:l==="bar"?d.horizontal=!0:l==="spline"?r.fitType="spline":l==="bezier"&&(r.fitType="bezier"),v&&(d.yAxis=x||0);if(l==="line"||l==="spline"||l==="bezier"||l===n.ChartConsts.strTrendline)delete b.fill,delete S.fill;d[s]||(d[s]=[]),d[o]||(d[o]=[]),d[u]||(d[u]=[]),l==="scatter"&&(d.showChartLabels=i.showChartLabels,r.showChartLabels!==undefined&&(d.showChartLabels=r.showChartLabels)),r.sIndex=h,d[s].push(r),d[o].push(b),d[u].push(S),h++}),$.each(c,function(s,o){var u=t.chart,a=o.yAxis,f;a!==undefined&&e.axisInfo.y[a].bounds&&(m.bounds=e.axisInfo.y[a].bounds);switch(s){case"pie":var c;$.each(o,function(t,n){var r=n.type==="sharedPies",o=r?n.pies:[n];$.each(o,function(t,n){var o=n.center,a=n.radius||50,f,c=l.endX-l.startX,h=l.endY-l.startY,p=n.label,d=$.extend(!0,{},i.textStyle,i.chartLabelStyle),v,g;c<2*a&&(a=c/2),h<2*a&&(a=h/2),n.radius=a,o=o?o:{x:l.startX+c/2,y:l.startY+h/2},f={startX:o.x-a,startY:o.y-a,endX:o.x+a,endY:o.y+a},S=$.extend(!0,{},m,{bounds:f,radius:a,isTouchBehaviorEnable:!1},n),T=new u.PieChartRender(e.chartElement,S),T.render(),r&&p&&p.length&&(v=e._text(0,0,p).attr(d),g=v.wijGetBBox(),v.transform(Raphael.format("...T{0},{1}",o.x,o.y-a-(g.height/2+6))),e.chartElement.data("fields").pieSeriesTitles||(e.chartElement.data("fields").pieSeriesTitles=[]),e.chartElement.data("fields").pieSeriesTitles.push(v)),e._saveTrakers(C),e.chartElement.data("fields").aniSectorAttrs=null,e.chartElement.data("fields").aniLabelAttrs=null,e._savechartData(s,n.sIndex)})});break;case"bar":case"column":S=$.extend(!0,{},m,{stacked:i.stacked,axis:i.axis,clusterOverlap:i.clusterOverlap,clusterWidth:i.clusterWidth,clusterSpacing:i.clusterSpacing,is100Percent:i.is100Percent,clusterRadius:i.clusterRadius,isYTime:e.axisInfo.y[0].isTime,isXTime:e.axisInfo.x.isTime,yAxisInfo:e.axisInfo.y,yAxisIndex:a},o),T=new u.BarChartRender(e.chartElement,S),T.render(),d=[],$.each(o.seriesList,function(e,t){d.push(t.sIndex)}),e._saveTrakers(C),e._savechartData(s,d);break;case"line":case"spline":case"bezier":case"area":x=e._getyAxisGroup(o),e.aniPathsAttr||(e.aniPathsAttr={}),$.each(x,function(t,n){e.aniPathsAttr[s]||(e.aniPathsAttr[s]=[]),S=$.extend(!0,{},m,{axis:i.axis,isXTime:e.axisInfo.x.isTime,isYTime:e.axisInfo.y[0].isTime,type:s==="area"?"area":"line",hole:i.hole},n),S.aniPathsAttr=e.aniPathsAttr[s],S.chartLabelEles=e.chartLabelEles,v&&(S.axis.y=i.axis.y[t]),S.extremeValue={txx:e.extremeValue.txx,txn:e.extremeValue.txn,tyx:e.extremeValue.y[t].tyx,tyn:e.extremeValue.y[t].tyn},T=new u.LineChartRender(e.chartElement,S),T.render(),d=[],$.each(n.seriesList,function(e,t){d.push(t.sIndex)}),e._saveTrakers(C),e._savechartData(s,d)});break;case n.ChartConsts.strTrendline:x=e._getyAxisGroup(o),e.aniPathsAttr||(e.aniPathsAttr={}),$.each(x,function(t,n){e.aniPathsAttr[s]||(e.aniPathsAttr[s]=[]),S=$.extend(!0,{},m,{axis:i.axis,hole:i.hole},n),S.aniPathsAttr=e.aniPathsAttr[s],v&&(S.axis.y=i.axis.y[t]),S.extremeValue={txx:e.extremeValue.txx,txn:e.extremeValue.txn,y:{}},S.extremeValue.y[t]=e.extremeValue.y[t],T=new u.TrendlineRender(e.chartElement,S),T.render(),d=[],$.each(n.seriesList,function(e,t){d.push(t.sIndex)}),e._savechartData(s,d)});break;case"scatter":x=e._getyAxisGroup(o),$.each(x,function(t,n){S=$.extend(!0,{},m,{axis:i.axis,isXTime:e.axisInfo.x.isTime,isYTime:e.axisInfo.y[0].isTime,zoomOnHover:i.zoomOnHover},n),v&&(S.axis.y=i.axis.y[t]),T=new u.ScatterChartRender(e.chartElement,S),T.render(),d=[],$.each(n.seriesList,function(e,t){d.push(t.sIndex)}),e._savechartData(s,d)});break;case"ohlc":case"hl":case"candlestick":x=e._getyAxisGroup(o),$.each(x,function(t,n){S=$.extend(!0,{},m,{axis:i.axis,timeUtil:e.timeUtil,type:s},n),v&&(S.axis.y=i.axis.y[t]),S.seriesStyles=r.prototype._getStyles(s,S.seriesStyles,"seriesStyles",!0),S.seriesHoverStyles=r.prototype._getStyles(s,S.seriesHoverStyles,"seriesHoverStyles",!0),T=new u.CandlestickChartRender(e.chartElement,S),T.render(),d=[],$.each(n.seriesList,function(e,t){d.push(t.sIndex)}),e._savechartData(s,d),e._saveTrakers(C)});break;case"bubble":x=e._getyAxisGroup(o),f||(f={visible:i.showChartLabels,style:i.chartLabelStyle}),$.each(x,function(t,n){S=$.extend(!0,{},m,{axis:i.axis,isXTime:e.axisInfo.x.isTime,isYTime:e.axisInfo.y[0].isTime,xAxisInfo:e.axisInfo.x,yAxisInfo:e.axisInfo.y,chartLabel:f,minimumSize:i.minimumSize||5,maximumSize:i.maximumSize||20,sizingMethod:i.sizingMethod||"diameter",bubbleRadius:e.bubbleAxisAdjust.bubbleRadius},n),v&&(S.axis.y=i.axis.y[t]),S.yAxisInfo=e.axisInfo.y[t]||e.axisInfo.y[0],T=new u.BubbleChartRender(e.chartElement,S),T.render(),d=[],$.each(n.seriesList,function(e,t){d.push(t.sIndex)}),e._savechartData(s,d),e._saveTrakers(C)})}}),e.chartElement.data("fields").seriesEles=null,N=e.chartElement.data("fields"),N&&(N.trackers=C,e.chartElement.data("fields",N)),e._bindtooltip()},s.prototype._savechartData=function(e,t){var n=this,r=n.chartElement.data("fields"),i=r.seriesEles,s=r.allElements||{},o,u=t,a;$.isArray(u)&&(u=0),$.each(i,function(r,i){$.isArray(t)?(n.seriesEles[t[u]]={eles:i,type:e},u++):(e==="pie"&&n.seriesEles[u]?(n.seriesEles[u].sharedSeriesEles||(a=[n.seriesEles[u]],n.seriesEles[u]={type:"pie",sharedSeriesEles:a}),n.seriesEles[u].sharedSeriesEles.push({eles:i,type:e})):n.seriesEles[u]={eles:i,type:e},u++)}),o=r.ctracers||[],o.push({trackers:r.trackers,type:e}),r.ctracers=o,r&&r.chartElements&&$.each(r.chartElements,function(e,t){n._copyElements(s,e,t)}),r.allElements=s},s.prototype._copyElements=function(e,t,n){var r;n&&$.isArray(n)?(r=e[t]||[],e[t]=r.concat(n)):n&&(r=e[t]||[],r.concat([n]))},s.prototype._getyAxisGroup=function(e){var t={};return $.each(e.seriesList,function(n,r){var i=r.yAxis||0;t[i]||(t[i]={seriesList:[],seriesStyles:[],seriesHoverStyles:[]}),t[i].seriesList.push(r),t[i].seriesStyles.push(e.seriesStyles[n]),t[i].seriesHoverStyles.push(e.seriesHoverStyles[n])}),t},s.prototype._bindtooltip=function(){var e=this,t=e.widgetName,n=e.chartElement.data("fields");n&&n.ctracers&&$.each(n.ctracers,function(e,t){var n=t.type;t.trackers&&t.trackers.toFront()}),e.chartElement.delegate(".linetracker, .wijchart-canvas-marker, .bartracker, .pietracker, .wijscatterchart, .bubbletracker, .candlesticktracker, .trendlinetracker","mouseover."+t,$.proxy(e._tooltipMouseOver,e)),e.chartElement.delegate(".linetracker, .wijchart-canvas-marker, .bartracker, .pietracker, .wijscatterchart, .bubbletracker, .candlesticktracker, .trendlinetracker","mouseout."+t,$.proxy(e._tooltipMouseOut,e)),e.chartElement.delegate(".linetracker, .wijchart-canvas-marker, .bartracker, .pietracker, .wijscatterchart, .bubbletracker, .candlesticktracker, .trendlinetracker","mousemove."+t,$.proxy(e._tooltipMouseMove,e))},s.prototype._tooltipMouseOver=function(e){var t=e.target,r=this,i=r.tooltip,s=r.options.hint,o=null,u=s.title,a=s.content,f=s.style,l=$.isFunction(u),c=$.isFunction(a),h,p,d,v;d=$(r.canvas.canvas.parentNode).offset();if(r.indicatorLine)return;$(t).data("owner")&&(t=$(t).data("owner")),t=$(t),h=t.data("wijchartDataObj");if(r.tooltip){o=i.getOptions();if(l||c)l&&(o.title=$.proxy(u,h)),c&&(o.content=$.proxy(a,h));if(h.type==="line"||h.type==="marker"){h.type==="marker"&&(h=h.lineSeries);if(h.path.removed)return;if(r.hoverLine!==h||r.hoverLine===null)r.isNewLine=!0,r.hoverLine&&(r.hoverLine.path.removed||(r.hoverLine.path.wijAttr(r.hoverLine.lineStyle),r.hoverPoint&&!r.hoverPoint.isSymbol&&(r.hoverPoint.marker.wijAttr(r.hoverPoint.markerStyle),r.hoverPoint.marker.transform("s1")))),h.lineHoverStyle&&h.path.wijAttr(h.lineHoverStyle),r.hoverLine=h,r.hoverPoint=null,r.hoverVirtualPoint=null}else if(h.type==="scatter"||s.relativeTo==="element")r._clearHoverState(),h.type==="scatter"?p=h.dot.getBBox():t[0]&&t[0].raphael&&t[0].raphaelid&&(v=r.canvas.getById(t[0].raphaelid),v&&(p=v.getBBox())),o.style.stroke=f.stroke||t.attr("stroke"),p&&r.tooltip.showAt({x:p.x+p.width/2,y:p.y},e);else{r._clearHoverState();if(h.type===n.ChartConsts.strTrendline)return;o.style.stroke=f.stroke||t.attr("stroke"),r.tooltip.showAt({x:e.pageX-d.left,y:e.pageY-d.top},e)}}},s.prototype._tooltipMouseMove=function(e){var t=this,r=e.target,i,s=t.options.hint,o=$(t.canvas.canvas.parentNode).offset();$(r).data("owner")&&(r=$(r).data("owner")),r=$(r),i=r.data("wijchartDataObj"),t.tooltip&&!this.indicatorLine&&i.type!=="line"&&i.type!=="marker"&&i.type!=="scatter"&&s.relativeTo!=="element"&&i.type!==n.ChartConsts.strTrendline&&t.tooltip.showAt({x:e.pageX-o.left,y:e.pageY-o.top},e)},s.prototype._tooltipMouseOut=function(e){var t=this,n=e.target,r;$(n).data("owner")&&(n=$(n).data("owner")),n=$(n),r=n.data("wijchartDataObj"),r.type!=="line"&&r.type!=="marker"&&!t.indicatorLine&&t.tooltip&&t.tooltip.hide()},s.prototype._mouseMoveInsidePlotArea=function(e,t){var n=this,r=n.tooltip,s=n.options.hint,o,u,a=0,f,l,c,h,p=null,d=null,v=null,m=s.title,g=s.content,y=$.isFunction(m),b=$.isFunction(g),w=0,E;r&&(v=r.getOptions());if(n.hoverLine&&!n.indicatorLine){E=n.hoverLine,n.isNewLine&&(s.enable&&r&&r.hide(),n.isNewLine=!1),o=E.lineMarkers,u=E.virtualMarkers,a=-1,f={x:0,y:0};if(o&&o.length){$.each(o,function(e,n){if(n.removed)return!0;var r=n.wijGetBBox(),i=r.x+r.width/2,s=Math.abs(i-t.left);if(e===0||s<w)w=s,a=e,f={x:i,y:r.y+r.height/2}});if(n.hoverPoint&&n.hoverPoint.index===a)return;if(a>-1){if(o[a].removed)return;l=$(o[a].node).data("wijchartDataObj"),l&&(n.hoverPoint&&!n.hoverPoint.isSymbol&&(n.hoverPoint.removed||(n.hoverPoint.marker.wijAttr(n.hoverPoint.markerStyle),n.hoverPoint.marker.transform("s1"))),l.isSymbol||l.marker.removed||l.marker.wijAttr(l.markerHoverStyle)),n.hoverPoint=l,n.hoverVirtualPoint=u[a]}}else{$.each(u,function(e,n){var r=Math.abs(n.x-t.left);if(e===0||r<w)w=r,a=e,f={x:n.x,y:n.y}});if(n.hoverVirtualPoint&&n.hoverVirtualPoint.index===a)return;a>-1&&(n.hoverPoint=null,n.hoverVirtualPoint=u[a])}if(r){d=n.hoverVirtualPoint,c=d.valX,h=d.valY;if(y||b)y&&(v.title=function(){var e={pointIndex:a,lineIndex:E.index,x:c,y:h,label:E.label,data:d,fmt:m},t=$.proxy(e.fmt,e),n=t();return n}),b&&(v.content=function(){var e={pointIndex:a,lineIndex:E.index,x:c,y:h,label:E.label,data:d,fmt:g},t=$.proxy(e.fmt,e),n=t();return n});p=$.extend({stroke:E.path.attr("stroke")},s.style),v.style.stroke=p.stroke,r.showAt(f)}}i.prototype._mouseMoveInsidePlotArea.call(this,e,t)},s.prototype._mouseDownInsidePlotArea=function(e,t){i.prototype._mouseDownInsidePlotArea.call(this,e,t),this._clearHoverState(!0)},s.prototype._mouseMoveOutsidePlotArea=function(e,t){var n=this;n._clearHoverState(),i.prototype._mouseMoveOutsidePlotArea.call(this,e,t)},s.prototype._clearHoverState=function(e){var t=this,n=t.tooltip,r=t.options.hint;t.hoverLine&&(r.enable&&n&&!e&&n.hide(),t.hoverLine.path.removed||(t.hoverLine.path.wijAttr(t.hoverLine.lineStyle),t.hoverPoint&&!t.hoverPoint.isSymbol&&(t.hoverPoint.marker.wijAttr(t.hoverPoint.markerStyle),t.hoverPoint.marker.transform("s1")))),t.hoverLine=null,t.hoverPoint=null,t.hoverVirtualPoint=null},s.prototype._getTooltipText=function(e,t){return""},s.prototype._calculateParameters=function(e,t){var n=this,s=!1,o,u=0,a=0,f,l,c,h,p;i.prototype._calculateParameters.call(this,e,t),l=e.max,c=e.min,$.each(n.options.seriesList,function(e,t){if(t.type==="column"||t.type==="bar")return s=!0,!1}),e.id==="x"&&(o=t.unitMinor,s&&(h=n._getBarAdjustment(e,o),u=Math.max(u,h.maxAdj),a=Math.max(a,h.minAdj)),n.isContainsCandlestick&&r&&(p=r.prototype._getCandlestickAdjustment.apply(this,[e,o]),u=Math.max(u,p),a=Math.max(a,p))),n.isContainsBubble&&$.wijmo.wijbubblechart&&(f=this.bubbleAxisAdjust.getAdjust(e,t),u=Math.max(u,f.max-l),a=Math.max(a,c-f.min)),a&&(e.min=c-a),u&&(e.max=l+u),(u||a)&&n._calculateMajorMinor(t,e)},s.prototype._getBarAdjustment=function(e,t){var n=0,r=this.options,i=e.max,s=e.min,o=0,u;$.each(r.seriesList,function(e,t){if(t.type==="pie")return!0;if(t.data.x===undefined||t.data.y===undefined)return!0;o=t.data.x.length,n<o&&(n=o)});if(n>1){var a=(i-s)/(n-1)*(r.clusterWidth/100);u=a*1.25/2}else n===1?(s===0&&i===1&&(s=-1),u=(i-s)*.0125):u=0;return u===0?u=t:t<u&&t!==0&&(u=Math.floor(u/t)*t),{maxAdj:u,minAdj:e.min-s+u}},s}(n.wijchartcore);n.wijcompositechart=i,i.prototype.widgetEventPrefix="wijcompositechart";var s=function(t){function n(){t.apply(this,arguments),this.compositechart="wijmo-wijcompositechart",this.barLabel="wijbarchart-label",this.barElement="wijbarchart",this.barTracker="bartracker",this.bubbleElement="wijbubblechart-bubble",this.bubbleTracker="bubbletracker",this.bubbleLabel="wijbubblechart-label",this.bubbleSymbol="wijbubblechart-symbol",this.scatterElement="wijscatterchart",this.pieLabel="wijpiechart-label",this.pieElement="wijpiechart",this.pieTracker="pietracker",this.lineLabel="wijlinechart-label",this.lineElement="wijlinechart",this.areaElement="wijlinechart-area",this.lineTracker="linetracker",this.canvasMarker="wijchart-canvas-marker",this.wijCandlestickChart="wijmo-wijcandlestickchart",this.candlestickChart="wijcandlestickchart",this.candlestickChartTracker="candlesticktracker"}return e(n,t),n}(n.wijchartcore_css);n.wijcompositechart_css=s;var o=function(n){function r(){n.apply(this,arguments),this.initSelector=":jqmData(role='wijcompositechart')",this.wijCSS=new t.chart.wijcompositechart_css,this.stacked=!1,this.clusterOverlap=0,this.clusterWidth=85,this.clusterRadius=0,this.clusterSpacing=0,this.seriesList=[],this.animation={enabled:!0,duration:400,easing:">"},this.seriesTransition={enabled:!0,duration:400,easing:">"},this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null,this.hole={}}return e(r,n),r}(n.wijchartcore_options);i.prototype.options=$.extend(!0,{},t.wijmoWidget.prototype.options,new o),$.wijmo.registerWidget("wijcompositechart",i.prototype)})(t.chart||(t.chart={}));var n=t.chart})(wijmo||(wijmo={}))});