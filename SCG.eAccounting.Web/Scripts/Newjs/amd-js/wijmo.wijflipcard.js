var wijmo;define(["./wijmo.wijutil","./wijmo.widget"],function(){var e=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};(function(t){(function(n){var r=jQuery,i="wijmo-wijflipcard",s="wijmo-wijflipcard-panels",o="wijmo-wijflipcard-panel",u="wijmo-wijflipcard-frontpanel",a="wijmo-wijflipcard-backpanel",f=function(t){function n(){t.apply(this,arguments)}return e(n,t),n.prototype._create=function(){var e=this;t.prototype._create.call(this);var n=this.element.children("div");this.nativeDivsLength=n.length,this._storeNativePanelsStyles(),n.length===2?(this._getPanelsFromElements(n),this._storeFrontAndBackPanelsStyles()):this._createPanels(),this.isCSS3Enabled=p(),this.isHover=!1,this._decorateFlipCard(),this.frontEleOpacity=this.frontPanel.css("opacity"),this.backEleOpacity=this.backPanel.css("opacity"),this._createAnimation(),this.bounds=this._getBounds(this.element),this._isDisabled()||this._bindEvents()},n.prototype._storeNativePanelsStyles=function(){var e=this.element.attr("class"),t=this.element.attr("style");this.nativeOuterPanelClass=e&&e!==""?e:undefined,this.nativeOuterPanelStyle=t&&t!==""?t:undefined},n.prototype._reStoreNativePanelsStyles=function(){this.nativeOuterPanelClass?this.element.attr("class",this.nativeOuterPanelClass):this.element.removeAttr("class"),this.nativeOuterPanelStyle?this.element.attr("style",this.nativeOuterPanelStyle):this.element.removeAttr("style")},n.prototype._storeFrontAndBackPanelsStyles=function(){var e=this.frontPanel.attr("class"),t=this.frontPanel.attr("style"),n=this.backPanel.attr("class"),r=this.backPanel.attr("style");this.nativeFrontPanelClass=e&&e!==""?e:undefined,this.nativeFrontPanelStyle=t&&t!==""?t:undefined,this.nativeBackPanelClass=n&&n!==""?n:undefined,this.nativeBackPanelStyle=r&&r!==""?r:undefined},n.prototype._reStoreFrontAndBackPanelsStyles=function(){this.nativeFrontPanelClass?this.frontPanel.attr("class",this.nativeFrontPanelClass):this.frontPanel.removeAttr("class"),this.nativeFrontPanelStyle?this.frontPanel.attr("style",this.nativeFrontPanelStyle):this.frontPanel.removeAttr("style"),this.nativeBackPanelClass?this.backPanel.attr("class",this.nativeBackPanelClass):this.backPanel.removeAttr("class"),this.nativeBackPanelStyle?this.backPanel.attr("style",this.nativeBackPanelStyle):this.backPanel.removeAttr("style")},n.prototype._bindEvents=function(){var e=this,t="",n=this.options.triggerEvent;r.support.isTouchEnabled&&r.support.isTouchEnabled()&&r.mobile?this.element.on("touchend.wijflipcard","."+o,r.proxy(this._flipPanels,this)):n==="click"?this.element.on(t+"click.wijflipcard","."+o,r.proxy(this._flipPanels,this)):this.isCSS3Enabled?this.element.on(t+"mouseenter.wijflipcard",this.element,r.proxy(this._flipPanels,this)).on(t+"mouseleave.wijflipcard",this.element,r.proxy(this._flipPanels,this)):(r("body").on(t+"mousemove.wijflipcard",function(t){e.mousePostion={x:t.pageX||t.clientX,y:t.pageY||t.clientY}}),this.element.on(t+"mouseenter.wijflipcard",this.element,r.proxy(this._flipPanelsByMouseEnter,this)).on(t+"mouseleave.wijflipcard",this.element,r.proxy(this._flipPanelsByMouseLeave,this)))},n.prototype._unbindEvents=function(){this.element.off(".wijflipcard"),r("body").off(".wijflipcard")},n.prototype._getBounds=function(e){var t=e.height(),n=e.width(),r=e.offset().top,i=e.offset().left;return{h:t,w:n,t:r,l:i}},n.prototype._isMouseInsideRect=function(e,t){return e.x<t.l||e.x>=t.l+t.w?!1:e.y<=t.t||e.y>=t.t+t.h?!1:!0},n.prototype._flipPanelsByMouseEnter=function(e,t){return!this.isHover&&r(e.currentTarget).data("flipLock")!==1&&(this.isHover=!0,this._flipPanels(e)),t||(e.preventDefault(),e.stopPropagation()),!1},n.prototype._flipPanelsByMouseLeave=function(e,t){return r(e.currentTarget).data("flipLock")!==1&&(this.isHover=!1,this._flipPanels(e)),t||(e.preventDefault(),e.stopPropagation()),!1},n.prototype._flipPanels=function(e){var t=this,n=this.options,i=n.animation,s=i.type,o,u,a=r.wijmo.wijflipcard.animations,f=this.frontPanel.is(":visible"),l,c=f?this.frontPanel:this.backPanel,h=f?this.backPanel:this.frontPanel;i.disabled?this._flipWithoutAnimation(c,h):a&&s&&a[s]&&a[s].animation?a[s].animation(i,this.element,function(){return t._onFlipping()},function(){t.options.triggerEvent!=="click"&&!t.isCSS3Enabled&&(o=t._isMouseInsideRect(t.mousePostion,t.bounds),o!==t.isHover&&(u={currentTarget:t.element},o?t._flipPanelsByMouseEnter(u,!0):t._flipPanelsByMouseLeave(u,!0))),t.isCSS3Enabled?l=t.element.hasClass("wijflipshowback"):l=t.frontPanel.css("visibility")==="hidden",t._onFlipped(l)}):r.effects&&(r.effects[s]||r.effects.effect&&r.effects.effect[s])?this._flipWithJQueryAnimation(c,h):this._flipWithoutAnimation(c,h)},n.prototype._flipWithJQueryAnimation=function(e,t){var n=this,r=this.options,i=r.animation,s=r.duration,o=i.type,u;u=this._trigger("flipping",null,{frontPanel:this.frontPanel,backPanel:this.backPanel});if(u===!1)return;e.hide(o,i,s),t.show(o,i,s,function(){t.css("transform","none"),n._onFlipped()})},n.prototype._flipWithoutAnimation=function(e,t){var n;n=this._trigger("flipping",null,{frontPanel:this.frontPanel,backPanel:this.backPanel});if(n===!1)return;e.hide(),t.show(),this._onFlipped()},n.prototype._onFlipping=function(){return this._trigger("flipping",null,{frontPanel:this.frontPanel,backPanel:this.backPanel})},n.prototype._onFlipped=function(e){if(e===undefined||e===null)e=this.frontPanel.css("display")==="none";this._trigger("flipped",null,{frontPanel:this.frontPanel,backPanel:this.backPanel,isFlipped:e})},n.prototype._createAnimation=function(){var e=this.options,t=e.animation,n=t.type,i=r.wijmo.wijflipcard.animations,s;t.disabled||i&&n&&i[n]&&(s=i[n].create,s&&r.isFunction(s)&&s(t,this.element))},n.prototype._decorateFlipCard=function(){var e=this.options,t=e.wijCSS;this.element.addClass(i).addClass(t.widget),t.wijFlipCardClass.length&&this.element.addClass(t.wijFlipCardClass),this.frontPanel.addClass(o).addClass(u).addClass(t.cornerAll).addClass(t.stateDefault).addClass(t.content),this.backPanel.addClass(o).addClass(a).addClass(t.cornerAll).addClass(t.stateDefault).addClass(t.content),t.wijFlipCardPanelClass.length&&(this.frontPanel.addClass(t.wijFlipCardPanelClass),this.backPanel.addClass(t.wijFlipCardPanelClass)),t.wijFlipCardFrontPanelClass.length&&this.frontPanel.addClass(t.wijFlipCardFrontPanelClass),t.wijFlipCardBackPanelClass.length&&this.backPanel.addClass(t.wijFlipCardBackPanelClass),this._isDisabled()&&this.element.addClass(t.stateDisabled),this._setWidth(e.width),this._setHeight(e.height),this._setCSS3Options()},n.prototype._removeDecoration=function(){var e=this.options,t=e.wijCSS;this.nativeDivsLength===2?(this.frontPanel.appendTo(this.element),this.backPanel.appendTo(this.element),this._reStoreFrontAndBackPanelsStyles()):(this.frontPanel.remove(),this.backPanel.remove()),this.panels.remove(),this._reStoreNativePanelsStyles()},n.prototype._setWidth=function(e){e!==undefined&&e!==null&&(this.element.width(e),this.frontPanel.width(e),this.backPanel.width(e))},n.prototype._setHeight=function(e){e!==undefined&&e!==null&&(this.element.height(e),this.element.find(".wijmo-wijflipcard-frontpanel").height(e),this.element.find(".wijmo-wijflipcard-backpanel").height(e))},n.prototype._setCSS3Options=function(){if(!this.isCSS3Enabled)return;var e=this.element.find(".wijmo-wijflipcard-panel").outerHeight(!0)/2,t=this.element.find(".wijmo-wijflipcard-panel").outerWidth(!0)/2;v(this.element.find(".wijmo-wijflipcard-panels")[0],"transformOrigin",t+"px "+e+"px")},n.prototype._getPanelsFromElements=function(e){this.frontPanel=r(e[0]),this.backPanel=r(e[1]),this.panels=r("<div></div>").appendTo(this.element).addClass(s),this.frontPanel.appendTo(this.panels),this.backPanel.appendTo(this.panels)},n.prototype._createPanels=function(){this.element.empty(),this.panels=r("<div></div>").appendTo(this.element).addClass(s),this.frontPanel=r("<div></div>").appendTo(this.panels),this.backPanel=r("<div></div>").appendTo(this.panels)},n.prototype._setOption=function(e,n){if(this.options[e]!==n)switch(e){case"triggerEvent":this.options[e]=n,this._isDisabled()||(this._unbindEvents(),this._bindEvents());break;case"width":this._setWidth(n),this._setCSS3Options();break;case"height":this._setHeight(n),this._setCSS3Options();break;case"animation":this.options[e]=n,this._resettingAnimation();break;default:}t.prototype._setOption.call(this,e,n)},n.prototype._innerDisable=function(){t.prototype._innerDisable.call(this),this._toggleDisableFlipCard(!0)},n.prototype._innerEnable=function(){t.prototype._innerEnable.call(this),this._toggleDisableFlipCard(!1)},n.prototype._toggleDisableFlipCard=function(e){e?this._unbindEvents():(this._unbindEvents(),this._bindEvents()),this.element.toggleClass(this.options.wijCSS.stateDisabled,e)},n.prototype._resettingAnimation=function(){this.element.removeClass("wijflip").removeClass("wijvflip").removeClass("wijflipshowback").removeClass("ie").removeClass("nonie"),this.frontPanel.css("opacity",this.frontEleOpacity).show(),this.backPanel.css("opacity",this.frontEleOpacity).show(),this.isCSS3Enabled||(this.frontPanel.css("visibility","visible"),this.backPanel.css("visibility","visible")),this._unbindEvents(),this._createAnimation(),this._isDisabled()||this._bindEvents()},n.prototype.destroy=function(){t.prototype.destroy.call(this),this._unbindEvents(),this._removeDecoration()},n}(t.wijmoWidget);n.wijflipcard=f;var l=function(){function e(){this.initSelector=":jqmData(role='wijflipcard')",this.wijCSS={wijFlipCardClass:"",wijFlipCardPanelClass:"",wijFlipCardFrontPanelClass:"",wijFlipCardBackPanelClass:""},this.wijMobileCSS={},this.disabled=!1,this.width=null,this.height=null,this.triggerEvent="click",this.animation={disabled:!1,type:"flip",duration:500,direction:"horizontal"},this.flipping=null,this.flipped=null}return e}();f.prototype.options=r.extend(!0,{},t.wijmoWidget.prototype.options,new l),r.wijmo.registerWidget("wijflipcard",f.prototype);var c=function(e){e.elem.style[e.prop]=parseInt(e.now,10)+e.unit},h=function(){return!1};r.extend(r.fx.step,{borderTopWidth:c,borderBottomWidth:c,borderLeftWidth:c,borderRightWidth:c}),r.fn.wijRevertFlip=function(){return this.each(function(){var e=r(this);e.wijFlip(e.data("flipRevertedSettings"))})},r.fn.wijFlip=function(e){return this.each(function(){var t=r(this),n,i,s,o,u,a=h();if(t.data("flipLock")||!e)return!1;if(e&&e.animationStart&&r.isFunction(e.animationStart)&&!e.animationStart.call(this))return!1;var f={direction:function(e){switch(e){case"tb":return"bt";case"bt":return"tb";case"lr":return"rl";case"rl":return"lr";default:return"bt"}}(e.direction),bgColor:e.color||"#999",color:e.bgColor||t.css("background-color"),speed:e.speed||500,animationStart:e.animationStart||function(){},onBefore:e.onBefore||function(){},onEnd:e.onEnd||function(){},onAnimation:e.onAnimation||function(){}};t.data("flipRevertedSettings",f).data("flipLock",1).data("flipSettings",f),n={width:t.width(),height:t.height(),bgColor:e.bgColor||t.css("background-color"),fontSize:t.css("font-size")||"12px",direction:e.direction||"tb",toColor:e.color||"#999",speed:e.speed||500,top:t.offset().top,left:t.offset().left,target:e.content||null,transparent:"transparent",dontChangeColor:e.dontChangeColor||!1,onBefore:e.onBefore||function(){},onEnd:e.onEnd||function(){},onAnimation:e.onAnimation||function(){}},t.data("flipObj",n),a&&(n.transparent="#123456"),i=t.css("visibility","hidden").clone(!0).data("flipLock",1).appendTo("body").html("").css({visibility:"visible",position:"absolute",left:n.left,top:n.top,margin:0,zIndex:9999,"-webkit-box-shadow":"0px 0px 0px #000","-moz-box-shadow":"0px 0px 0px #000"}),t.data("clone",i);var l=function(){return{backgroundColor:n.transparent,fontSize:0,lineHeight:0,borderTopWidth:0,borderLeftWidth:0,borderRightWidth:0,borderBottomWidth:0,borderTopColor:n.transparent,borderBottomColor:n.transparent,borderLeftColor:n.transparent,borderRightColor:n.transparent,background:"none",borderStyle:"solid",height:0,width:0}},c=function(){var e=n.height/100*25,t=l();return t.width=n.width,{start:t,first:{borderTopWidth:0,borderLeftWidth:e,borderRightWidth:e,borderBottomWidth:0,borderTopColor:"#999",borderBottomColor:"#999",top:n.top+n.height/2,left:n.left-e},second:{borderBottomWidth:0,borderTopWidth:0,borderLeftWidth:0,borderRightWidth:0,borderTopColor:n.transparent,borderBottomColor:n.transparent,top:n.top,left:n.left}}},p=function(){var e=n.height/100*25,t=l();return t.height=n.height,{start:t,first:{borderTopWidth:e,borderLeftWidth:0,borderRightWidth:0,borderBottomWidth:e,borderLeftColor:"#999",borderRightColor:"#999",top:n.top-e,left:n.left+n.width/2},second:{borderTopWidth:0,borderLeftWidth:0,borderRightWidth:0,borderBottomWidth:0,borderLeftColor:n.transparent,borderRightColor:n.transparent,top:n.top,left:n.left}}};o={tb:function(){var e=c();return e.start.borderTopWidth=n.height,e.start.borderTopColor=n.bgColor,e.second.borderBottomWidth=n.height,e.second.borderBottomColor=n.toColor,e},bt:function(){var e=c();return e.start.borderBottomWidth=n.height,e.start.borderBottomColor=n.bgColor,e.second.borderTopWidth=n.height,e.second.borderTopColor=n.toColor,e},lr:function(){var e=p();return e.start.borderLeftWidth=n.width,e.start.borderLeftColor=n.bgColor,e.second.borderRightWidth=n.width,e.second.borderRightColor=n.toColor,e},rl:function(){var e=p();return e.start.borderRightWidth=n.width,e.start.borderRightColor=n.bgColor,e.second.borderLeftWidth=n.width,e.second.borderLeftColor=n.toColor,e}},s=o[n.direction](),a&&(s.start.filter="chroma(color="+n.transparent+")"),u=function(){var e=n.target;return e&&e.jquery?e.html():e},i.queue(function(){n.onBefore(i,t),i.html("").css(s.start),i.dequeue()}),i.animate(s.first,n.speed),i.queue(function(){n.onAnimation(i,t),i.dequeue()}),i.animate(s.second,n.speed),i.queue(function(){n.dontChangeColor||t.css({backgroundColor:n.toColor}),t.css({visibility:"visible"});var e=u();e&&t.html(e),i.remove(),t.removeData("flipLock"),n.onEnd(i,t),i.dequeue()})})};var p=function(){var e=!1;if("WebkitTransform"in document.body.style||"MozTransform"in document.body.style||"OTransform"in document.body.style||"transform"in document.body.style)e=!0;return e},d=function(e){return e.toLowerCase().replace(/(\-[a-z])/g,function(e){return e.toUpperCase().replace("-","")})},v=function(e,t,n){var i=["-moz-","-webkit-","-o-","-ms-","-khtml-",""];r.each(i,function(i,s){var o=r.camelCase(s+t);o in e.style&&(e.style[o]=n)})};r.extend(r.wijmo.wijflipcard,{animations:{flip:{create:function(e,t){var n=e.direction==="horizontal"?"h":"v",i="wij"+(n==="h"?"":"v")+"flip";t.addClass(i),r.browser&&r.browser.msie?t.addClass("ie"):t.addClass("nonie")},animation:function(e,t,n,i){var s=e,o=t.find("."+u),l=t.find("."+a),c=i,h=s.duration||500,d=h+"ms",v=h/2,m=s.direction==="horizontal"?"h":"v",g="wij"+(m==="h"?"":"v")+"flip";if(p()){s.duration&&(r.browser.msie?t.find(".wijmo-wijflipcard-panel").css("transition-duration",d):t.find(".wijmo-wijflipcard-panels").css("transition-duration",d).css("-ms-transition-duration",d));if(n&&r.isFunction(n)&&n.call(f)===!1)return;t.on("transitionend.wij webkitTransitionEnd.wij oTransitionEnd.wij otransitionend.wij MSTransitionEnd.wij",function(){i&&r.isFunction(i)&&i.call(f),t.off(".wij")}),t.toggleClass("wijflipshowback")}else t.data("flipped")?(t.wijRevertFlip(),t.data("flipped",!1)):(t.stop(!0,!0).wijFlip({direction:s.direction==="horizontal"?"lr":"tb",speed:h,color:l.css("background-color"),bgColor:o.css("background-color"),animationStart:n,onBefore:function(){o.css("visibility","hidden"),l.css("visibility","hidden")},onEnd:function(){t.data("flipped")?l.css("visibility","visible").css("transform","none"):o.css("visibility","visible").css("transform","none"),i&&r.isFunction(i)&&i.call(this)}}),t.data("flipped",!0))},destroy:function(e){e.removeClass("wijflip").removeClass("wijvflip").removeClass("ie").removeClass("nonie")}}}})})(t.flipcard||(t.flipcard={}));var n=t.flipcard})(wijmo||(wijmo={}))});