var wijmo;define(["./wijmo.widget","./wijmo.wijslider","./wijmo.wijpager","./wijmo.wijcarousel","swfobject"],function(){var e=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};(function(t){(function(n){var r=jQuery,i="wijgallery",s="wijmo-wijgallery",o="wijmo-wijgallery-",u=o+"selected",a=o+"button-",f=o+"button",l="wijmo-wijgallery-thumbs-pointer-{0}",c="wijmo-wijgallery-flashwrapper",h='<div class="wijmo-wijgallery-frame"><div class="wijmo-wijgallery-content"></div></div>',p='<div class="wijmo-wijgallery-thumbs"></div>',d="<a><span></span></a>",v='<div class="wijmo-wijgallery-frame-{0}"><a href="#" class="wijmo-wijgallery-frame-link"></a></div>',m="<div></div>",g="li.wijmo-wijcarousel-item";!window.S&&window.swfobject&&(window.S={flash:window.swfobject});var y=function(t){function n(){t.apply(this,arguments)}return e(n,t),n.prototype._setOption=function(e,n){var i=this,s=i.options,o,u,a,f;if(e==="framePosition"||e==="thumbnailPosition"||e==="transitions"||e==="pagingPosition")r.extend(!0,s[e],n);else{a=s[e],t.prototype._setOption.call(this,e,n);switch(e){case"showThumbnailCaptions":i.thumbs[i.thumbWidgetName]({showCaption:n});break;case"thumbnailOrientation":i.thumbs[i.thumbWidgetName]({orientation:n}),i._wijdestroy(),i._create();break;case"thumbsDisplay":i.thumbs[i.thumbWidgetName]({display:n});break;case"autoPlay":i[n?"play":"pause"]();break;case"showCounter":case"showTimer":case"showControls":o=e.replace(/show/i,"").toLowerCase(),u=e.replace(/show/i,"_create"),n!==a&&(n===!0?i[o]?i[o].jquery&&i[o].show():i[u]():i[o].hide());break;case"showCaption":n?(i._createCaption(i.size),f=i._loadCaption(i.images[i.currentIdx]),f.show()):i.element.find(".wijmo-wijgallery-caption,.wijmo-wijgallery-text").remove();break;case"showPager":case"thumbsLength":case"thumbnailDirection":case"showControlsOnHover":case"mode":case"data":i._wijdestroy(),i._create();break;default:}}},n.prototype._innerDisable=function(){t.prototype._innerDisable.call(this),this.isPlaying&&this.pause(),this._handleDisabledOption(!0,this.element)},n.prototype._innerEnable=function(){t.prototype._innerEnable.call(this),this._handleDisabledOption(!1,this.element)},n.prototype._handleDisabledOption=function(e,t){var n=this;n.pager&&!n.pager.is(":hidden")?n.pager.wijpager("option","disabled",e):n.thumbs&&!n.thumbs.is(":hidden")&&n.thumbs[n.thumbWidgetName]({disabled:e})},n.prototype._initLi=function(e){var t=e.children("a:eq(0)"),n=e.find("img:eq(0)"),i=e.find("span:eq(0)"),s={url:null,thumbUrl:null,title:n.attr("alt"),caption:undefined};return t.length&&t.attr("href")?(s.url=t.attr("href"),s.title||(s.title=t.attr("title"))):n.length&&(s.url=n.attr("src")),i.length?s.caption=i:n.attr("title")&&(s.caption=r("<span>").html(n.attr("title"))),s.thumbUrl=n.attr("src"),s},n.prototype._initStatus=function(){var e=this,t;e.images=[],e.ul=e.element.children("ul"),t=e.ul.children("li"),e._count=t.length,t.each(function(t){var n=e._initLi(r(this));e.images.push(n)})},n.prototype._createMarkupFromData=function(){var e=this,t=e.options,n=t.data,i=e.element,s=i.children("ul:eq(0)");e.images=n,s.length?s.empty():s=r("<ul>").appendTo(i),e.ul=s,r.each(n,function(e,t){var n=r("<a>"),i=r("<li>"),o=r("<img>");t.url&&n.attr("href",t.url),t.thumbUrl&&o.attr("src",t.thumbUrl),t.title&&o.attr("alt"),n.append(o).appendTo(i),i.appendTo(s)}),e._count=n.length},n.prototype._create=function(){var e=this,n=e.options;e.container=e.element,e.container.addClass([s,n.wijCSS.widget].join(" ")),e.currentThumbIdx=0,e.currentIdx=-1,e.timerCount=0,window.wijmoApplyWijTouchUtilEvents&&(r=window.wijmoApplyWijTouchUtilEvents(r)),n.showPager?(n.pagingPosition=!0,n.thumbnails=!1):n.thumbnails=!0,n.data&&n.data.length?e._createMarkupFromData():e._initStatus(),n.loadCallback&&r.isFunction(n.loadCallback)&&e._trigger("loadCallback",null,e),e._createDom(),n.autoPlay&&e._play(!0),n.showControlsOnHover&&(e.frame.find(".wijmo-wijpager,.wijmo-wijgallery-button-next,.wijmo-wijgallery-counter,.wijmo-wijgallery-button-previous").hide(),!e.isPlaying&&e.timer&&e.timer.hide()),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijgallery"),t.prototype._create.call(this)},n.prototype._createDom=function(){var e=this,t=e.options;t.thumbnails?e._createThumbnails():e.ul.hide(),e._createFrame(),t.control&&e._createControls(),t.showCounter&&e._createCounter(),t.showTimer&&e._createTimer(),t.showPager&&e._createPager()},n.prototype._getFrameSize=function(){var e=this,t=e.options.thumbnailOrientation==="horizontal",n=e.element.height()-(t?e.thumbs?e.thumbs.outerHeight(!0):0:0),r=e.element.width()-(t?0:e.thumbs?e.thumbs.outerWidth(!0):0);return{w:r<2||!r?750:r,h:n<2||!n?300:n}},n.prototype._createFrame=function(){var e=this,t=e.options,n,i,s=e._getFrameSize(),o=t.thumbnailDirection==="after";e.frame=r(h).addClass(t.wijCSS.content+" "+t.wijCSS.helperClearFix)[o?"prependTo":"appendTo"](e.container).setOutWidth(s.w-1).setOutHeight(s.h).wrap('<div class="wijmo-wijgallery-framewrapper">'),e.size=s,n=e.frame.width(),i=e.frame.height(),e.frameWrapper=e.frame.parent(),t.thumbnailOrientation==="vertical"&&e.frameWrapper.addClass("wijmo-wijgallery-framewrapper-vertical"),t.showControlsOnHover&&e.frame.bind("mouseenter."+e.widgetName,function(){if(e._isDisabled())return;e._showControls("controls")}).bind("mouseleave."+e.widgetName,function(){if(e._isDisabled())return;e._hideControls("controls")}),e.content=e.frame.children("div.wijmo-wijgallery-content"),t.mode==="img"&&e._createFrameMask(),e._createPrevNextBtn(),e._createCaption(s),e._createLoading(),e.last=r('<div class="'+t.wijCSS.overlay+' wijmo-wijgallery-last"></div>').appendTo(e.content).width(n).height(i).css({"line-height":s.h+"px"}),e.current=r('<div class="'+t.wijCSS.overlay+' wijmo-wijgallery-current"></div>').appendTo(e.content).width(n).height(i).css({"line-height":s.h+"px"}),e._show(0)},n.prototype._createControls=function(){var e=this,t=e.options,n={collision:"none",of:e.container,my:"center bottom",at:"center bottom"};t.control&&(e.controls=r(t.control).css({position:"absolute"}).appendTo(e.container),r.extend(n,t.controlPosition),e.controls.position(n))},n.prototype._createLoading=function(){var e=this;e.loading=r("<div></div>").addClass("wijmo-wijgallery-loading").appendTo(e.content),e.loading.css({left:(e.content.width()-e.loading.width())/2,top:(e.content.height()-e.loading.height())/2}),e.loading.hide()},n.prototype._createFrameMask=function(){var e=this,t=e.options;r.each(["previous","next"],function(n,i){var s=r(v.replace(/\{0\}/,i)).appendTo(e.frame),o=s.children("a");r.browser.msie&&parseInt(r.browser.version)<=9&&s.css({"background-color":"#fff"}),t.showControlsOnHover&&s.bind("mouseenter."+e.widgetName,function(){if(e._isDisabled())return;e._showControls(i)}).bind("mouseleave."+e.widgetName,function(){if(e._isDisabled())return;e._hideControls(i)}),o.bind("click."+e.widgetName,function(t){if(e._isDisabled())return;e[i](),t.preventDefault()})})},n.prototype._createCounter=function(){var e=this,t=e.options;if(!t.showCounter){e.counter&&(e.counter.remove(),e.counter=undefined);return}e.counter||(e.counter=r("<div></div>").addClass("wijmo-wijgallery-counter "+t.wijCSS.stateDefault+" "+t.wijCSS.cornerTL).appendTo(e.frame)),e._refreshCounter()},n.prototype._refreshCounter=function(){var e=this,t=e.options,n;if(!e.counter)return;e.counter.empty(),t.counter&&(n=t.counter.replace(/\[i\]/,e.currentIdx+1),n=n.replace(/\[n\]/,e._count),r("<span></span>").text(n).appendTo(e.counter))},n.prototype._createPrevNextBtn=function(){var e=this,t=e.options.wijCSS;r.each(["next","previous"],function(n,i){var s=i==="next"?t.iconArrowRight:t.iconArrowLeft,o;o=e.frame.find(".wijmo-wijgallery-frame-"+i);if(!o.length||e.options.mode!=="img")o=e.frame;e[i+"Btn"]=r(e._createBtn(a+i,s)).bind("click."+e.widgetName,r.proxy(e[i],e)).appendTo(o),e._applyBtnStyle(i)})},n.prototype._applyBtnStyle=function(e){var t=this,n=t.options,r=e==="next",i=t[e+"Btn"],s=r?"right center":"left center",o=s,u=n.wijCSS,a=r?u.cornerLeft:u.cornerRight,f=e==="next"?t.currentIdx>=t._count:t.currentIdx<=0,l={collision:"none",of:t.frame,my:o,at:s};i.addClass(a).position(l),f?i.removeClass(u.stateHover).addClass(u.stateDisabled):i.hasAllClasses(u.stateDisabled)&&i.removeClass(u.stateDisabled)},n.prototype._createCaption=function(e){var t=this,n=t.options,i=n.wijCSS;n.showCaption&&(t.overlay=r(m).addClass([i.content,i.helperClearFix,"wijmo-wijgallery-caption"].join(" ")).width(e.w).appendTo(t.content),t.caption=r(m).addClass([i.content,i.helperClearFix,"wijmo-wijgallery-text"].join(" ")).width(e.w).appendTo(t.content))},n.prototype._loadCaption=function(e){var t=this,n=e.caption,i,s=r("<span></span>"),o=t.element.find(".wijmo-wijgallery-text,.wijmo-wijgallery-caption");return n&&(o.show(),n.jquery&&n.show(),s.html(n),t.caption.empty().append(s),i=s.outerHeight(!0),o.height(i),r.browser.msie&&o.height(s.css("display","block").outerHeight(!0))),o.hide(),o},n.prototype._showCaption=function(e){var t=this;e&&e.caption&&(t.caption.length&&t.caption.fadeIn(500),t.overlay.length&&t.overlay.show().animate({opacity:.5},500))},n.prototype._createTooltip=function(e){var t=this,n=t.options.wijCSS,i=e||"bottom";t.pointer=r("<div>").addClass([n.content,n.stateDefault,l.replace(/\{0\}/,i)].join(" ")),t.pointer.appendTo(t.thumbsWrapper).hide()},n.prototype._createThumbnails=function(){var e=this,t=e.options,n=t.thumbnailDirection==="after",i="wijmo-wijgallery-thumbs-{0}",s=t.thumbnailOrientation==="horizontal",o=n?s?"bottom":"right":s?"top":"left";e.thumbPosition=o,e.thumbs=r(p).appendTo(e.container).addClass(t.wijCSS.content).addClass(s?"wijmo-wijcarousel-horizontal-multi":"wijmo-wijcarousel-vertical-multi"),s?e.thumbs.css({height:t.thumbsLength+"px"}).setOutWidth(e.element.width()):e.thumbs.css({width:t.thumbsLength+"px"}).setOutHeight(e.element.height()),e.ul.appendTo(e.thumbs),e.ul.children("li").each(function(t,n){var i=r(n).children("a"),s=e.images[t],o=s.thumbUrl;i.length||(i=r(n).wrapInner("<a>").children("a"),i.attr("href",o))}),r[e.namespace][e.thumbWidgetName]&&(e.thumbs.addClass(i.replace(/\{0\}/,o)).find("li").addClass(t.wijCSS.stateDefault).hover(function(){r(this).addClass(t.wijCSS.stateHover)},function(){r(this).removeClass(t.wijCSS.stateHover)}),e.thumbsWrapper=e.thumbs[e.thumbWidgetName]({display:t.thumbsDisplay,step:t.thumbsDisplay-1,itemPadding:"0 10px",showCaption:t.showThumbnailCaptions,orientation:t.thumbnailOrientation,loop:!1,itemClick:function(t,n){var r=n.index;e.show(r),t.preventDefault()},afterScroll:function(t,n){e.currentThumbIdx=n.firstIndex,e.activeLi&&e.activeLi.is("li")&&e.activeLi.index()>=n.firstIndex&&e.activeLi.index()<=n.lastIndex&&e._highlightThumb(e.activeLi),e.isScrolling=!1},beforeScroll:function(n,r){e.isScrolling=!0,t.mode==="swf"||t.mode==="flv"?e.pointer.hide():e.pointer.fadeOut(100)}}).wrap('<div class="wijmo-wijgallery-thumbswrapper">').parent(),s||e.thumbsWrapper.addClass("wijmo-wijgallery-thumbswrapper-vertical"),e._createTooltip(o))},n.prototype._calculatePosition=function(e,t,n,r,i,s){var o=this;o.thumbPosition==="bottom"?(e.left=e.left+(r-t)/2+s,e.top=e.top-n):o.thumbPosition==="top"?(e.left=e.left+(r-t)/2+s,e.top=e.top+i+2*s):o.thumbPosition==="left"?(e.left=e.left+r+2*s,e.top=e.top+(i-n)/2+s):o.thumbPosition==="right"&&(e.left=e.left-t,e.top=e.top+(i-n)/2+s)},n.prototype._highlightThumb=function(e){var t=this,n,r,i,s,o,a,f=[u,t.options.wijCSS.stateActive].join(" ");e&&e.length&&(e.siblings("li."+u).removeClass(f),e.addClass(f),n=t.pointer.outerWidth(!0),r=t.pointer.outerHeight(!0),i=e.width(),s=e.height(),o=e.offset(),a=5,t._calculatePosition(o,n,r,i,s,a),t.pointer.fadeIn(100),t.pointer.offset(o))},n.prototype._getSelector=function(e,t){var n,r=".wijmo-wijgallery-button-",i=".wijmo-wijpager,.wijmo-wijgallery-counter";return t&&(i+=",.wijmo-wijgallery-timerbar"),e==="next"||e==="previous"?n=r+e:e==="controls"?n=i:n=i+","+r+"next,"+r+"previous",n},n.prototype._showControls=function(e){var t=this,n;n=t._getSelector(e,!!t.timer),t.frame.find(n).stop(!0,!0).fadeIn(400,function(){r(this).css("opacity","")})},n.prototype._hideControls=function(e){var t=this,n;n=t._getSelector(e,!!t.timer),this.frame.find(n).stop(!0,!0).fadeOut(600)},n.prototype._createPager=function(){var e=this,t=e.options,n,i=t.thumbsDisplay,s=1,o=e.currentIdx,u=e.currentIdx,a={collision:"none",of:e.container,my:"right top",at:"right bottom"};t.thumbnails?(n=r("<div></div>").appendTo(e.thumbs),i!==0&&(s=Math.ceil(e._count/i),o=Math.ceil(e.currentIdx/i)),e.pager=n.wijpager({pageCount:s,pageIndex:o,pageButtonCount:s,mode:"numeric",pageIndexChanged:function(t,n){var r=n.newPageIndex;(u<r*i||u>=(r+1)*i)&&e.thumbs[e.thumbWidgetName]("scrollTo",r*i),t.preventDefault()}}).css({position:"absolute"})):(n=r("<div></div>").appendTo(e.container),e.pager=n.wijpager({pageCount:e._count,pageIndex:e.currentIdx,pageButtonCount:e._count,mode:"numeric",pageIndexChanged:function(t,n){var r=n.newPageIndex;e._show(r)}}).css({position:"absolute"}),r.extend(a,t.pagingPosition),e.pager.addClass("wijmo-wijgallery-pager").position(a),e._adjustPagerLeft())},n.prototype._adjustPagerLeft=function(){var e=this.pager.css("left").replace(/px/,""),t=parseFloat(e);isNaN(t)||this.pager.css("left",t-1)},n.prototype._createBtn=function(e,t){var n=r(d),i=this.options;return n.addClass(i.wijCSS.stateDefault+" "+e).attr("role","button").bind("mouseover"+this.widgetName,function(){if(r(this).hasAllClasses(i.wijCSS.stateDisabled))return;r(this).addClass(i.wijCSS.stateHover)}).bind("mouseout"+this.widgetName,function(){if(r(this).hasAllClasses(i.wijCSS.stateDisabled))return;r(this).removeClass(i.wijCSS.stateHover)}),n.children("span:eq(0)").addClass(i.wijCSS.icon+" "+t),n},n.prototype._createTimer=function(){var e=this,t=e.options;e._createPausePlay(),e.progressBar=r("<div></div>").addClass("wijmo-wijgallery-timerbar-inner "+t.wijCSS.cornerAll).css({width:"0%"}).attr("role","progressbar"),e.timer=r("<div></div>").addClass("wijmo-wijgallery-timerbar "+t.wijCSS.cornerAll).appendTo(e.frame).append(e.progressBar).append(e.playPauseBtn)},n.prototype._createPausePlay=function(){var e=this,t=e.options;e.playPauseBtn=r(e._createBtn(f,t.autoPlay?t.wijCSS.iconPause:t.wijCSS.iconPlay)).bind("wijclick."+e.widgetName,function(){if(!r(this).hasAllClasses(t.wijCSS.stateDisabled)){var n=r(this).children("span:eq(0)");e[n.hasAllClasses(t.wijCSS.iconPlay)?"play":"pause"]()}})},n.prototype._show=function(e){var t=this,n=t.images[e],i,s,o,u=t._getFrameSize(),a=t.options,f=a.mode;if(t.currentIdx===e)return;n&&r.isPlainObject(n)&&(t.loading.delay(500).fadeIn(100),o=t.last.children("img,div."+c),o.length&&o.remove(),f==="swf"||f==="flv"?(t.last.hide(),t.current.empty(),t._wrapFlash(t.current,f,n.url),t.picture=t.current.children("div."+c),t._setCurrentStates(e),t.loading.stop().hide(),t._thumbsScroll(e)):f==="img"?(t.picture&&t.picture.length&&t.last.append(t.picture),t.current.addClass("ui-helper-hidden-accessible"),t.last.show(),t.picture=r("<img>"),t.picture.one("load",function(){t.picture.data("itemIndex",e).appendTo(t.current),t._imageLoaded(t,u)}).attr({src:n.url,alt:n.title})):f==="iframe"&&(t.current.is(":hidden")?(i=t.current,s=t.last):(i=t.last,s=t.current),t.picture=r("<iframe></iframe>").addClass("wijmo-wijgallery-iframe").attr({frameborder:"0",marginwidth:"0",marginheight:"0",scrolling:"auto",allowtransparency:"true",src:n.url}).hide().appendTo(i).data("itemIndex",e).bind("load",function(){var e=r(this),n=e.data("itemIndex");t.loading.stop().hide(),t.pointer&&t.pointer.fadeOut(100),t._setCurrentStates(n),n!==undefined&&(a.showCaption,e.show(),s.fadeOut(function(){s.empty()}),i.fadeIn())})))},n.prototype._imageLoaded=function(e,t){var n=e.picture.attr("role","img"),r=n.data("itemIndex"),i=n[0].naturalWidth||n.width(),s=n[0].naturalHeight||n.height(),o=e.images[r];e.loading.stop().hide(),e.current.removeClass("ui-helper-hidden-accessible"),e.current.hide(),e.pointer&&e.pointer.fadeOut(100),i>=t.w||s>=t.h?i/s>t.w/t.h?n.css({width:"100%"}):n.css({height:"100%"}):i<t.w&&s<t.h&&n.addClass(e.options.wijCSS.stateDefault).addClass("wijmo-wijgallery-small-image"),r!==undefined&&o!==undefined&&(e.options.showCaption&&e.caption&&e._loadCaption(o),e._animate(r))},n.prototype._animate=function(e){var t=this,n=t.options,i=n.transitions,s=n.thumbnailOrientation==="horizontal",o,u,a,f,l,c,h=i.animated,p=i.duration;if(!t.last.children().length){t._setCurrentStates(e),t.last.hide(),t.current.show();return}l={index:t.currentIdx,to:e,toImg:t.images[e]};if(!t._trigger("beforeTransition",null,l))return;h?h==="slide"?(o=t.size.w,u=t.size.h,t.current.show(),c=t.currentIdx>e?!0:!1,a=r.createWrapper(t.last).css({overflow:"hidden",width:s?o*2:o,height:s?u:u*2,left:s?c?-o:0:0,top:s?0:c?-u:0}),a[c?"prepend":"append"](t.current),a.animate({left:s?c?0:-o:0,top:s?0:c?0:-u},p,function(){t.last.parent().is(".ui-effects-wrapper")&&t.last.unwrap(),t.last.hide(),t._setCurrentStates(e)})):r.mobile?(f=p/2,t.last.fadeOut(f,function(){t.current.stop(!0,!0).fadeIn(f,function(){t._setCurrentStates(e)})})):h==="explode"||h==="scale"||h==="blind"||h==="fold"?(t.current.css({position:"absolute"}),t.current.stop(!0,!0).show(h,p,function(){t.last.hide(),t._setCurrentStates(e)})):h==="size"?(t.last.hide(),t.current.stop(!0,!0).show(h,p,function(){t.last.hide(),t._setCurrentStates(e)})):(f=p/2,t.last.hide(h,f,function(){t.last.hide(),t.current.stop(!0,!0).show(h,f,function(){t._setCurrentStates(e)})})):(t.last.hide(),t.current.show(),t._setCurrentStates(e)),t._thumbsScroll(e)},n.prototype._thumbsScroll=function(e){var t,n=this,r=n.options;n.thumbs&&n.thumbs[n.thumbWidgetName]&&(r.scrollWithSelection?(t=e-Math.ceil(r.thumbsDisplay/2)+1,e>0&&e<n._count-1&&n.thumbs[n.thumbWidgetName]("scrollTo",t)):e>r.thumbsDisplay+n.currentThumbIdx-1?n.thumbs[n.thumbWidgetName]("scrollTo",e-r.thumbsDisplay+1):e<n.currentThumbIdx&&n.thumbs[n.thumbWidgetName]("scrollTo",e))},n.prototype._setCurrentStates=function(e){var t=this,n=t.options,r,i,s;s=t.currentIdx,t.currentIdx=e,r=e+1<t._count,t.isPlaying&&r?(t.timeout=null,t.isPlaying=!1,t._play()):t.progressBar&&t.pause(),e+1>=t._count?t.nextBtn.add(t.playPauseBtn).removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled):t.nextBtn.add(t.playPauseBtn).removeClass(n.wijCSS.stateDisabled),e<=0?t.previousBtn.removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled):t.previousBtn.removeClass(n.wijCSS.stateDisabled),n.showCaption&&t._showCaption(t.images[e]),t.thumbs&&t.thumbs[t.thumbWidgetName]?(t.activeLi=t.thumbs.find(g).eq(e),t.isScrolling||t._highlightThumb(t.activeLi)):t.pager&&t.pager.is(":wijmo-wijpager")&&t.pager.wijpager("option","pageIndex",e),t._refreshCounter(),t._clearCss(),i={last:s,index:t.currentIdx,toImg:t.images[t.currentIdx]},t._trigger("afterTransition",null,i)},n.prototype._clearCss=function(){this.current.css({position:"",visibility:""})},n.prototype._resetState=function(){var e=this;e._stopAnimation(),e.isPlaying&&e.progressBar&&(e.progressBar.stop(),e.progressBar.css({width:"0%"}))},n.prototype._stopAnimation=function(){var e=this,t;t=e.content.find(".ui-effects-wrapper"),t.length&&t.stop(!0,!0),e.current.stop(!0,!0),e.last.stop(!0,!0)},n.prototype.count=function(){return this._count},n.prototype._wijdestroy=function(){var e=this,t=e.options.wijCSS;e.frame.unwrap().remove(),e.frame=null,e.options.thumbnails?r[e.namespace][e.thumbWidgetName]&&(e.thumbs[e.thumbWidgetName]("destroy"),e.element.find("li").unbind().removeClass([t.stateDefault,t.stateActive].join(" ")).filter("."+u).removeClass(u),e.thumbs.children("ul").unwrap().unwrap(),e.thumbs=null):(e.pager&&e.pager.length&&(e.pager.remove(),e.pager=null),e.element.find("ul").css({display:""})),e.pointer&&(e.pointer.remove(),e.pointer=null),e.element.removeClass([s,t.widget,t.content,t.cornerAll].join(" "))},n.prototype.destroy=function(){this._wijdestroy(),t.prototype.destroy.call(this)},n.prototype.show=function(e){var t=this;t._resetState(),t._show(e)},n.prototype.next=function(){var e=this,t;if(e._isDisabled())return;e._resetState(),t=e.currentIdx+1,t<e._count&&e._show(t)},n.prototype.previous=function(){var e=this,t;if(e._isDisabled())return;e._resetState(),t=e.currentIdx-1,t>=0&&e._show(t)},n.prototype.play=function(){this._play()},n.prototype._play=function(e){var t=this,n=t.options;if(t.isPlaying||t._isDisabled())return;if(n.interval===0)return t.pause();if(e&&n.mode!=="swf"){t.isPlaying=!0;return}if(n.showTimer&&t.progressBar)t.progressBar.css({width:"0%"}),t.playPauseBtn.children("span:eq(0)").removeClass(n.wijCSS.iconPlay).addClass(n.wijCSS.iconPause),t.progressBar.animate({width:"100%"},n.interval,null,function(){t._show(t.currentIdx+1)});else{if(t.timeout)return;t.timeout=window.setTimeout(function(){t.timerCount<=1&&t.next(),t.timerCount--},n.interval),t.timerCount++}t.isPlaying=!0},n.prototype.pause=function(){var e=this,t=e.options;if(t.showTimer&&e.progressBar)e.progressBar.stop(),e.progressBar.css({width:"0%"}),e.playPauseBtn.children("span:eq(0)").removeClass(t.wijCSS.iconPause).addClass(t.wijCSS.iconPlay);else{if(e.timeout===null)return;window.clearTimeout(e.timeout),e.timeout=null}e.isPlaying=!1},n.prototype.add=function(e,t){var n=this,i,s,o;if(typeof e=="string")i=r(e),o=n._initLi(i);else if(e.jquery)i=e,o=n._initLi(i);else{if(!r.isPlainObject(e))return;o=e}!t||t>n._count?s=n._count:t<0?s=0:s=t,n.images.splice(s,0,o),n._count++,n.thumbs&&n.thumbs[n.thumbWidgetName]&&(n.pointer&&n.pointer.is(":hidden")&&n.pointer.show(),n.thumbs[n.thumbWidgetName]("add",i,s)),n._count===1&&n.show(0),n._refreshStateWithItemsChanged(s)},n.prototype.remove=function(e){var t=this,n;isNaN(e)||e>=t._count?n=t._count-1:e<0?n=0:n=e;if(n>=0){t.images.splice(n,1),t._count--,t.thumbs&&t.thumbs[t.thumbWidgetName]&&t.thumbs[t.thumbWidgetName]("remove",n);if(t.currentIdx==n)t.current.children("img").remove(),t.last.children("img").remove(),t.picture=null,t.currentIdx=-1,t._count>0&&(n===t._count?t.show(n-1):t.show(n));else if(t.currentIdx>n){var r=t.currentIdx;t.currentIdx=-1,t.show(r)}t._refreshStateWithItemsChanged(n)}},n.prototype._refreshStateWithItemsChanged=function(e){var t=this,n=t.options;t._count===0?(t.nextBtn.removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled),t.previousBtn.removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled),t.playPauseBtn&&t.playPauseBtn.removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled),t.pointer&&t.pointer.hide()):t.currentIdx<=0?t.previousBtn.removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled):t.currentIdx>=t._count-1?(t.nextBtn.removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled),t.playPauseBtn&&t.playPauseBtn.removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled)):(t.nextBtn.removeClass(n.wijCSS.stateDisabled),t.previousBtn.removeClass(n.wijCSS.stateDisabled),t.playPauseBtn&&t.playPauseBtn.removeClass(n.wijCSS.stateDisabled),t.pointer&&t.pointer.is(":hidden")&&t.pointer.show()),t._refreshCounter()},n.prototype._getExt=function(e){var t,n,r=/[0-9a-z]+$/i,i=e.indexOf("?");return i>-1&&(e=e.substring(0,i)),n=e.match(r),n&&(t=n[0].toLowerCase()),t},n.prototype._getPlayerName=function(e){if(e.indexOf("#")===0||e.indexOf("#")>0&&e.indexOf(document.location.href)===0)return"inline";var t=["bmp","gif","jpg","jpeg","png"],n=["swf"],i=["flv","m4v"],s=["dv","mov","moov","movie","mp4","avi","mpg","mpeg"],o=["asf","avi","mpg","mpeg","wm","wmv"],u=this._getExt(e);if(u){if(r.inArray(u,t)>=0)return"img";if(r.inArray(u,n)>=0)return"swf";if(r.inArray(u,i)>=0)return"flv";if(r.inArray(u,o)>=0)return"wmp";if(r.inArray(u,s)>=0)return"qt"}return"unknown"},n.prototype._wrapFlash=function(e,t,n){var i=this,s=i.options,o=n,u,a="100%",f="100%",l=s.flashInstall,h=s.flashVersion,p=s.flashVars,d=s.flashParams,v=i._newId();t==="flv"&&(o=s.flvPlayer,p=r.extend({file:n,width:a,height:f,autostart:s.autoPlayMovies?"true":"false",controlbar:s.showMovieControls?"bottom":"none",backcolor:"0x000000",frontcolor:"0xCCCCCC",lightcolor:"0x557722"},s.flashVars),d=r.extend({autostart:s.autoPlayMovies?"true":"false",allowscriptaccess:"always"},s.flashParams)),u=r("<div/>").addClass(c).appendTo(e),r("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).attr("id",v).appendTo(u),S.flash.embedSWF(o,v,a,f,h,l,p,d)},n.prototype._newId=function(){var e="a|b|c|d|e|f|g|h|i|j|k|l|m|n|o|p|q|r|s|t|u|v|w|x|y|z",t=[],n="",r;t=e.split("|");for(r=0;r<16;r++)n+=t[Math.round(Math.random()*25)];return n},n}(t.wijmoWidget);n.wijgallery=y,y.prototype.thumbWidgetName="wijcarousel";var b=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-a",stateDefault:"ui-btn-up-a",stateHover:"ui-btn-down-a",stateActive:"ui-btn-down-b",iconPlay:"ui-icon-arrow-r",iconPause:"ui-icon-grid"},this.initSelector=":jqmData(role='wijgallery')",this.autoPlay=!1,this.scrollWithSelection=!1,this.showTimer=!0,this.interval=5e3,this.showCaption=!0,this.showThumbnailCaptions=!1,this.data=[],this.showControls=!1,this.control="",this.controlPosition={},this.showCounter=!0,this.counter="[i] of [n]",this.showPager=!1,this.pagingPosition={},this.thumbnailOrientation="horizontal",this.thumbnailDirection="after",this.transitions={animated:"slide",duration:1e3,easing:null},this.showControlsOnHover=!0,this.thumbsDisplay=5,this.thumbsLength=100,this.beforeTransition=null,this.afterTransition=null,this.loadCallback=null,this.showMovieControls=!1,this.autoPlayMovies=!0,this.flashParams={bgcolor:"#000000",allowfullscreen:!0,wmode:"transparent"},this.flashVars={},this.flashVersion="9.0.115",this.flvPlayer="player\\player.swf",this.flashInstall="player\\expressInstall.swf",this.mode="img"}return e}();y.prototype.options=r.extend(!0,{},t.wijmoWidget.prototype.options,new b),r.wijmo.registerWidget("wijgallery",y.prototype)})(t.gallery||(t.gallery={}));var n=t.gallery})(wijmo||(wijmo={}))});