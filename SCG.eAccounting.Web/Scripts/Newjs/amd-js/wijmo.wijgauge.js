var wijmo;define(["./wijmo.widget","./wijmo.raphael","globalize"],function(){var e=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};(function(t){(function(n){var r=jQuery;(function(e){e[e.east=0]="east",e[e.west=1]="west",e[e.south=2]="south",e[e.north=3]="north"})(n.Compass||(n.Compass={}));var i=n.Compass,s=function(){function e(){}return e.mod360=function(e){var t=e%360;return e<0&&(t+=360),t},e.getAngle=function(e,t,n){var r=this,i=r.distance(t,n),s=r.distance(t,e),o=r.distance(n,e),u=i*i,a=s*s,f=o*o,l=Math.acos((f-a-u)/(-2*s*i));return Math.round(180/Math.PI*l)},e.distance=function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},e.log=function(e,t){return e<=0?NaN:t===1||t<0?NaN:Math.log(e)/Math.log(t)},e.generateValues=function(e,t,n){var r=[],i,s;if(t>e&&n>0){i=parseInt(((t-e)/n+1).toString(),10);for(s=0;s<i;s++)r.push(e+s*n)}else n===0&&r.push(e);return r},e.isInRange=function(e,t,n){return e>=t&&e<=n||e<=t&&e>=n},e.paintMarker=function(e,t,n,r,i,s,o){var u;return t==="rect"?e.rect(n-i/2,r-s/2,i,s):(o?u=e.paintMarker(t,n,r,s):u=e.paintMarker(t,n,r,i),u)},e.formatString=function(e,t){if(r.isFunction(t))return t.call(this,e);if(t!==""){var n=/\{0(?::((?:n|d|p|c)\d?))?\}/gi,i,s;if(n.test(t))return i=t.match(n),s="$1",t.replace(/\{0(?::(?:(?:n|d|p|c)\d?))?\}/gi,Globalize.format(e,s))}return e},e.getPositionByAngle=function(e,t,n,r){var i={x:0,y:0},s=Raphael.rad(r);return i.x=e-n*Math.cos(s),i.y=t-n*Math.sin(s),i},e.donut=function(e,t,n,r,i,s,o){var u=this.getPositionByAngle,a=u(t,n,r,s),f=u(t,n,r,o),l=u(t,n,i,s),c=u(t,n,i,o),h=o-s>180,p;(o-s)%360!==0?(p=["M",a.x,a.y,"A",r,r,0,+h,1,f.x,f.y,"L",c.x,c.y,"A",i,i,0,+h,1,l.x,l.y,"L",a.x,a.y,"z"],e.path(p.join(" "))):e.circle(t,n,r)},e}();n.GaugeUtil=s,Raphael.fn.isoTri=function(e,t,n,r,i){var s=e,o=t+r/2,u=e+n,a=t,f=e+n,l=t+r,c;return i==3?(s=e,o=t,u=e-n/2,a=t+r,f=e+n/2,l=t+r):i===0?(s=e-n/2,o=t-r/2,u=e-n/2,a=t+r/2,f=e+n/2,l=t):i===1&&(s=e-n/2,o=t,u=e+n/2,a=t-r/2,f=e+n/2,l=t+r/2),c=["M",s,o,"L",u,a,"L",f,l,"z"],this.path(c.join(" "))};var o=function(t){function n(){t.apply(this,arguments)}return e(n,t),n.prototype._create=function(){var e=this,n=e.options,i;window.wijmoApplyWijTouchUtilEvents&&(r=window.wijmoApplyWijTouchUtilEvents(r)),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.redraw(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijgauge"),isNaN(n.width)&&e._setDefaultWidth(),isNaN(n.height)&&e._setDefaultHeight(),e._setDefaultWidthHeight(),n.face&&n.face.template&&typeof n.face.template=="string"&&window[n.face.template]&&(n.face.template=window[n.face.template]),n.pointer&&n.pointer.template&&typeof n.pointer.template=="string"&&window[n.pointer.template]&&(n.pointer.template=window[n.pointer.template]),n.cap&&n.cap.template&&typeof n.cap.template=="string"&&window[n.cap.template]&&(n.cap.template=window[n.cap.template]),e.element.addClass(n.wijCSS.widget);try{e.canvas=Raphael(e.element[0],n.width,n.height)}catch(s){var o=e.element.css("display");i=r("<div></div>").insertBefore(e.element).append(e.element),e.element.addClass("ui-helper-hidden-accessible").appendTo(r("body")),o==="none"&&e.element.css("display","block"),e.canvas=Raphael(e.element[0],n.width,n.height),e.element.appendTo(i).unwrap().removeClass("ui-helper-hidden-accessible"),o==="none"&&e.element.css("display","none")}e._autoCalculate(),e._draw(),e._bindResizeEvent(),t.prototype._create.call(this)},n.prototype._setDefaultWidth=function(){},n.prototype._setDefaultHeight=function(){},n.prototype._setDefaultWidthHeight=function(){var e=this,t=e.element,n=e.options,r=t.get(0).style,i=r.width,s=r.height;i!==""&&(n.width=t.width()),s!==""&&(n.height=t.height())},n.prototype._autoCalculate=function(){},n.prototype._setOption=function(e,n){var i=this,s=i.options,o=s[e];if(e==="value")i._trigger("beforeValueChanged",null,{newValue:n,oldValue:o})!==!1&&(t.prototype._setOption.call(this,e,n),i._set_value(n,o),i._trigger("valueChanged",null,{newValue:n,oldValue:o}));else{t.prototype._setOption.call(this,e,n),r.isPlainObject(n)&&(s[e]=r.extend({},o,n));if(s.radius==="auto"){i._autoCalculate(),i.redraw();return}i["_set_"+e]&&i["_set_"+e](n,o)}},n.prototype._innerDisable=function(){t.prototype._innerDisable.call(this),this._handleDisabledOption(!0,this.element)},n.prototype._innerEnable=function(){t.prototype._innerEnable.call(this),this._handleDisabledOption(!1,this.element)},n.prototype._set_value=function(e,t){this._setPointer()},n.prototype._set_autoResize=function(){this._unbindResizeEvent(),this._bindResizeEvent()},n.prototype._set_max=function(){this._redrawMarksAndLabels(),this._set_ranges(),this._setPointer()},n.prototype._set_min=function(){this._redrawMarksAndLabels(),this._set_ranges(),this._setPointer()},n.prototype._set_width=function(){this.redraw()},n.prototype._set_height=function(){this.redraw()},n.prototype._set_isInverted=function(){this.redraw()},n.prototype._set_tickMajor=function(){this._redrawMarksAndLabels()},n.prototype._set_tickMinor=function(){this._redrawMarksAndLabels()},n.prototype._set_pointer=function(){var e=this;e._removePointer(),e._paintPointer(),e._setPointer()},n.prototype._removePointer=function(){var e=this;e.pointer&&(e._destroyRaphaelElement(e.pointer),e.pointer=null)},n.prototype._set_islogarithmic=function(){var e=this;e._redrawMarksAndLabels(),e._setPointer()},n.prototype._set_logarithmicBase=function(){var e=this;e._redrawMarksAndLabels(),e._setPointer()},n.prototype._set_labels=function(){this._redrawMarksAndLabels()},n.prototype._set_margin=function(e,t){e!==t&&this.redraw()},n.prototype._set_marginTop=function(e,t){this._set_margin(e,t)},n.prototype._set_marginBottom=function(e,t){this._set_margin(e,t)},n.prototype._set_marginLeft=function(e,t){this._set_margin(e,t)},n.prototype._set_marginRight=function(e,t){this._set_margin(e,t)},n.prototype._set_ranges=function(){var e=this;e._removeRanges(),e._paintRanges(),e._resetElementPosition()},n.prototype._set_face=function(){var e=this;e._removeFace(),e._paintFace(),e._resetElementPosition(!0)},n.prototype._removeFace=function(){var e=this;e.face&&(e._destroyRaphaelElement(e.face),e.face=null)},n.prototype._clearState=function(){var e=this;e.labels=[],e.majorMarks=[],e.minorMarks=[],e.face=null,e.pointer=null},n.prototype._resetElementPosition=function(e){var t=this;e&&t.ranges&&r.each(t.ranges,function(e,t){t.toFront()}),t.majorMarks&&r.each(t.majorMarks,function(e,t){t.toFront()}),t.minorMarks&&r.each(t.minorMarks,function(e,t){t.toFront()}),t.labels&&r.each(t.labels,function(e,t){t.toFront()}),t.pointer&&t.pointer.toFront(),t.cap&&t.cap.toFront()},n.prototype._redrawMarksAndLabels=function(){var e=this;e._removeMarksAndLabels(),e._drawMarksAndLabels()},n.prototype._removeMarksAndLabels=function(){var e=this;e._unbindEvents(e.labels),e._destroyRaphaelArray(e.labels),e._unbindEvents(e.majorMarks),e._destroyRaphaelArray(e.majorMarks),e._unbindEvents(e.minorMarks),e._destroyRaphaelArray(e.minorMarks)},n.prototype._destroyRaphaelArray=function(e){if(!e)return;var t=e.length,n=0,r;for(;t&&n<t;n++)r=e[n],this._destroyRaphaelElement(r),e[n]=null;e=null},n.prototype._destroyRaphaelElement=function(e){var t;e&&e[0]&&(t=r(e.node),t.unbind().removeData(),e.wijRemove(),t.remove(),t=null,e=null)},n.prototype._drawMarksAndLabels=function(){var e=this;e.labels=[],e.majorMarks=[],e.minorMarks=[],e._paintMarks()},n.prototype._handleDisabledOption=function(e,t){var n=this;e?(n.disabledDiv||(n.disabledDiv=n._createDisabledDiv(t)),n.disabledDiv.appendTo("body")):n.disabledDiv&&(n.disabledDiv.remove(),n.disabledDiv=null)},n.prototype._createDisabledDiv=function(e){var t=this,n=t.options,i=e||t.element,s=i.offset(),o=n.width||i.outerWidth(),u=n.height||i.outerHeight(),a;return a=r("<div></div>").css({"z-index":"99999",position:"absolute",width:o,height:u,left:s.left,top:s.top}),Raphael.vml&&a.addClass(n.stateDisabled).css("background-color","#fff"),a},n.prototype._triggerPainted=function(){return this._trigger("painted")},n.prototype._draw=function(){var e=this,t=e.options;e.pointer=null,e._innerBbox={width:t.width-t.marginLeft-t.marginRight,height:t.height-t.marginTop-t.marginBottom,left:t.marginLeft,top:t.marginTop},e.face=e._paintFace(),e.ranges&&e._removeRanges(),e._paintRanges(),e._drawMarksAndLabels(),e._paintPointer(),e.pointer&&(e._setOffPointerValue(),e._setPointer()),r.wijraphael.clearRaphaelCache(),e._triggerPainted()},n.prototype.redraw=function(){var e=this,t=e.options;e._clearElements(),e._clearState(),e.canvas.clear(),e.canvas.setSize(t.width,t.height),e._draw()},n.prototype.destroy=function(){var e=this;e._unbindResizeEvent(),e._clearElements(),e.canvas.clear(),e.canvas=null,e._clearVariables(),e.element.removeClass("ui-widget").empty(),e.disabledDiv&&(e.disabledDiv.remove(),e.disabledDiv=null),t.prototype.destroy.call(this)},n.prototype._clearVariables=function(){var e=this;e._innerBbox=null,e.resizeTimer=null},n.prototype._clearElements=function(){var e=this;e._removeMarksAndLabels(),e._removeRanges(),e._removeFace(),e._removePointer()},n.prototype.getCanvas=function(){return this.canvas},n.prototype._percentage=function(){var e=this,t=e.options,n=t.max,r=t.min,i=t.value;return isNaN(i)?0:n===r?1:(i-r)/(n-r)},n.prototype._valueToLogical=function(e){var t=this,n=t.options,r=n.min,i=n.max,o=n.logarithmicBase,u,a;return e<r?0:i<e?1:(u=(e-r)/(i-r),n.islogarithmic?a=s.log(1+(o-1)*u,n.logarithmicBase):a=u,a)},n.prototype._logicalToValue=function(e){var t=this,n=t.options,r=n.max,i=n.min,s;if(e<0)return i;if(1<=e)return r;if(!n.islogarithmic)s=e;else{if(n.logarithmicBase<=1)return n.min;s=(Math.pow(n.logarithmicBase,e)-1)/(n.logarithmicBase-1)}return i+(r-i)*s},n.prototype._bindResizeEvent=function(){var e=this;e.options.autoResize&&e.element.on("resize."+e.widgetName,function(){clearTimeout(e.resizeTimer),e.resizeTimer=setTimeout(function(){e.redraw()},250)})},n.prototype._unbindResizeEvent=function(){this.element.off("resize."+this.widgetName)},n.prototype._bindClickEvents=function(e){var t=this;r.each(e,function(e,n){r(n.node).bind("click."+t.widgetName,function(e){t._trigger("click",e,{ele:n})})})},n.prototype._unbindEvents=function(e){var t=this;r.each(e,function(e,n){r(n.node).unbind("."+t.widgetName)})},n.prototype._setOffPointerValue=function(){},n.prototype._setPointer=function(){},n.prototype._paintPointer=function(){},n.prototype._paintFace=function(){},n.prototype._paintRanges=function(){var e=this,t=e.options,n=t.ranges||[];e.ranges=[],r.each(n,function(t,n){e._paintRange(n)})},n.prototype._paintRange=function(e){},n.prototype._removeRanges=function(){var e=this;e.ranges&&e._destroyRaphaelArray(e.ranges)},n.prototype._paintMarks=function(){var e=this,t=e.options,n=s.generateValues,i=n(t.min,t.max,t.tickMajor.interval),o=n(t.min,t.max,t.tickMinor.interval),u=t.labels,a=u.visible;t.tickMajor.visible&&r.each(i,function(n,r){e.majorMarks.push(e._paintMark(r,t.tickMajor,!0)),a&&e.labels.push(e._paintLabel(r,u))}),t.tickMinor.visible&&r.each(o,function(n,s){var o=!1;r.each(i,function(e,t){if(s===t)return o=!0,!1}),o||e.minorMarks.push(e._paintMark(s,t.tickMinor,!1))}),e._bindClickEvents(e.majorMarks),e._bindClickEvents(e.minorMarks),e._bindClickEvents(e.labels)},n.prototype._paintMark=function(e,t,n){},n.prototype._paintLabel=function(e,t){},n}(t.wijmoWidget);n.wijgauge=o;var u=function(){function e(){this.value=0,this.max=100,this.min=0,this.width=600,this.height=400,this.autoResize=!0,this.tickMajor={position:"inside",style:{fill:"#1E395B",stroke:"none"},factor:2,visible:!0,marker:"rect",offset:0,interval:10},this.tickMinor={position:"inside",style:{fill:"#1E395B",stroke:"none"},factor:1,visible:!1,marker:"rect",offset:0,interval:5},this.pointer={length:1,style:{fill:"#1E395B",stroke:"#1E395B"},width:8,offset:0,shape:"tri",visible:!0,template:null},this.islogarithmic=!1,this.logarithmicBase=10,this.labels={format:"",style:{fill:"#1E395B","font-size":12,"font-weight":"800"},visible:!0,offset:0},this.animation={enabled:!0,duration:2e3,easing:">"},this.face={style:{fill:"270-#FFFFFF-#D9E3F0",stroke:"#7BA0CC","stroke-width":4},template:null},this.marginTop=0,this.marginRight=0,this.marginBottom=0,this.marginLeft=0,this.ranges=[],this.isInverted=!1,this.beforeValueChanged=null,this.valueChanged=null,this.painted=null}return e}();o.prototype.options=r.extend({},t.wijmoWidget.prototype.options,new u)})(t.gauge||(t.gauge={}));var n=t.gauge})(wijmo||(wijmo={}))});