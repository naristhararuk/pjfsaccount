var wijmo;define(["./wijmo.wijstringinfo","./wijmo.wijinputcore","./wijmo.wijcalendar","./wijmo.wijinputdateformat","./wijmo.wijinputdateroller","./wijmo.wijtabs"],function(){var e=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};(function(t){(function(n){var r=jQuery,i=t.getKeyCodeEnum(),s=function(t){function s(){t.apply(this,arguments)}return e(s,t),s.prototype._create=function(){n.CoreUtility.chrome&&this.element.attr("type","text"),this._wijinputdateroller=null,typeof n.wijinputdateroller!="undefined"&&(this._wijinputdateroller=new n.wijinputdateroller(this)),t.prototype._create.call(this)},s.prototype._createTextProvider=function(){this._textProvider=new u(this,this.options.dateFormat,this.options.displayFormat)},s.prototype._strToDate=function(e){return this._textProvider.parseDate(e)},s.prototype._beginUpdate=function(){var e,r=null;t.prototype._beginUpdate.call(this);if(this.options.minDate&&typeof this.options.minDate=="string"){var i=new Date(this.options.minDate);isNaN(i.getTime())&&(i=this._strToDate(this.options.minDate)),this.options.minDate=i}if(this.options.maxDate&&typeof this.options.maxDate=="string"){var s=new Date(this.options.maxDate);isNaN(s.getTime())&&(s=this._strToDate(this.options.maxDate)),this.options.maxDate=s}this.options.date===undefined?!!this.element.data("elementValue")&&!n.CoreUtility.IsFireFox4OrLater()&&(e=this.element.data("elementValue")):typeof this.options.date=="string"?e=this.options.date:r=this.options.date,this.options.date===undefined&&(this.options.date=new Date),e&&(r=new Date(e),isNaN(r.getTime())&&(r=this._strToDate(e))),r==null&&(r=this.options.date),this._safeSetDate(r);var o=this._getCulture();o!=null&&(this.options.amDesignator==""&&(this.options.amDesignator=this._getStandardAMPM("AM")),this.options.pmDesignator==""&&(this.options.pmDesignator=this._getStandardAMPM("PM"))),this.element.data({defaultDate:r===null?r:new Date(r.getTime()),preDate:r===null?r:new Date(r.getTime())}),this._resetTimeStamp(),this._initPicker();if(this.options.calendar){var u=this.element.data("calendar");u&&u.wijcalendar("option",this.options.calendar)}this.element.addClass(this.options.wijCSS.wijinputdate).attr({"aria-valuemin":new Date(1900,1,1),"aria-valuemax":new Date(2099,1,1),"aria-valuenow":this.options.date})},s.prototype._endUpdate=function(){var e=this;t.prototype._endUpdate.call(this),this.element.bind("click.wijinput",function(){if(!e._allowEdit())return;var t=e.options.activeField,r=e.element.wijtextselection();e._updateText();try{e.element.wijtextselection(r)}catch(i){}e.element.data("ignoreHighLight")!=1&&e._highLightCursor(),n.CoreUtility.chrome&&e.element.data("needResoteActiveField")==1&&e._setOption("activeField",t),e.element.data("ignoreHighLight",!1)})},s.prototype._getInnerNullText=function(){return this.options.placeholder!=null?this.options.placeholder:this.options.showNullText?this.options.nullText:null},s.prototype._getInnerAmDesignator=function(){return this.options.amDesignator==""?this._getStandardAMPM("AM"):this.options.amDesignator},s.prototype._getInnerPmDesignator=function(){return this.options.pmDesignator==""?this._getStandardAMPM("PM"):this.options.pmDesignator},s.prototype._getInnerIncrement=function(){var e=Number(this.options.increment);return isNaN(e)&&(e=1),e},s.prototype._getAllowSpinLoop=function(){return!!this.options.allowSpinLoop},s.prototype._getRealMaxDate=function(){return this.options.maxDate?this.options.maxDate:new Date(9999,11,31,23,59,59)},s.prototype._getRealMinDate=function(){if(this.options.minDate)return this.options.minDate;var e=new Date(1,0,1,0,0,0);return e.setFullYear(1),e},s.prototype._getRealEraMaxDate=function(){return this.options.maxDate?n.DateTimeInfo.GetEraMax()<this.options.maxDate?n.DateTimeInfo.GetEraMax():this.options.maxDate:n.DateTimeInfo.GetEraMax()},s.prototype._getRealEraMinDate=function(){return this.options.minDate?n.DateTimeInfo.GetEraMin()>this.options.minDate?n.DateTimeInfo.GetEraMin():this.options.minDate:n.DateTimeInfo.GetEraMin()},s.prototype._isEraFormatExist=function(){return this._textProvider._isEraFormatExist()},s.prototype._checkDate=function(){var e=this.options.date,t=this._checkRange(this.options.date);n.DateTimeInfo.Equal(e,t)||(this._setOption("date",t),this._trigger("valueBoundsExceeded",null))},s.prototype._checkRange=function(e){return e&&(this.options.minDate&&e<this.options.minDate&&(e=new Date(Math.max(this.options.minDate,e))),this.options.maxDate&&e>this.options.maxDate&&(e=new Date(Math.min(this.options.maxDate,e)))),e},s.prototype._safeSetDate=function(e,t){var n=e;return t||(e=this._checkRange(e)),isNaN(e)&&(e=n),this.options.date=e,!0},s.prototype._safeGetDate=function(e){var t=this.options.date;return t==null&&(t=new Date),e||(t=this._checkRange(t)),t},s.prototype._setOption=function(e,n){t.prototype._setOption.call(this,e,n);switch(e){case"calendar":var r=this.element.data("calendar");r&&r.wijcalendar("option",n);break;case"pickers":this._reInitPicker();break;case"minDate":case"maxDate":if(typeof this.options[e]=="string"){var i=this._strToDate(n);i=i===null?new Date(n):i,this.options[e]=i}var s=this.options.date;s===null&&(s=new Date);var o=this._getRealMinDate(),u=this._getRealMaxDate();(s<o||s>u)&&this._safeSetDate(s),this._updateText(),this._highLightField();break;case"date":if(!!n){if(typeof n=="string"){var a=this._strToDate(n);n=a===null?new Date(n):a}else typeof n=="object"?n=new Date(n.getTime()):n=new Date(n);isNaN(n)&&(n=new Date)}this._safeSetDate(n),this._updateText(),this._highLightField();break;case"midnightAs0":case"hour12As0":case"amDesignator":case"pmDesignator":case"promptChar":this._updateText(),this._highLightField();break;case"culture":case"cultureCalendar":this._textProvider._setFormat(this.options.dateFormat);var f=this.options.displayFormat==""?this.options.dateFormat:this.options.displayFormat;this._textProvider._setDisplayFormat(f),this.options.amDesignator=this._getStandardAMPM("AM"),this.options.pmDesignator=this._getStandardAMPM("PM"),this._updateText();var r=this.element.data("calendar");r&&r.wijcalendar("option",e,n),this._reInitPicker();break;case"dateFormat":this._textProvider._setFormat(this.options.dateFormat),this.options.displayFormat==""&&this._textProvider._setDisplayFormat(this.options.dateFormat);if(this._isEraFormatExist()&&this.options.date!=null){var l=this._getRealEraMinDate(),c=this._getRealEraMaxDate();this.options.date<l?this._setOption("date",l):this.options.date>c&&this._setOption("date",c)}this._updateText();var r=this.element.data("calendar");r&&r.wijcalendar("option",e,n),this._reInitPicker();break;case"displayFormat":var f=this.options.displayFormat==""?this.options.dateFormat:this.options.displayFormat;this._textProvider._setDisplayFormat(f),this._updateText();break;case"activeField":n=Math.min(n,this._textProvider.getFieldCount()-1),n=Math.max(n,0),this.options.activeField=n,this._checkDate(),this.element.data("ignoreHighLight")!=1&&this._highLightField(),this._resetTimeStamp();break;case"nextTooltip":case"prevTooltip":case"titleFormat":case"toolTipFormat":var r=this.element.data("calendar",r);r&&r.wijcalendar("option",e,n);break;case"comboItems":this._reInitPicker()}},s.prototype._setData=function(e){this.option("date",e)},s.prototype._resetData=function(){var e=this.element.data("defaultDate");e===undefined||e===null?this.options.date!==null&&(e=this.element.data("elementValue"),e!==undefined&&e!==null&&e!==""?this.setText(e):this._setData(null)):this._setData(e)},s.prototype._resetTimeStamp=function(){this.element.data("cursorPos",0),this.element.data("timeStamp",new Date("1900/1/1")),this.element.data("lastInputChar","")},s.prototype.getPostValue=function(){if(!this._isInitialized())return this.element.val();if(t.prototype._showNullText.call(this)&&this.isDateNull())return"";var e=this._textProvider.toString();return e===this.options.nullText?"":e},s.prototype._highLightAllField=function(){if(this.isFocused()){var e=this._textProvider.getAllRange();if(e)try{this.element.wijtextselection(e)}catch(t){}}},s.prototype._highLightField=function(e){typeof e=="undefined"&&(e=this.options.activeField);if(this.isFocused()){var t=this._textProvider.getFieldRange(e);if(t)try{this.element.wijtextselection(t)}catch(n){}}},s.prototype._highLightCursor=function(e){if(this._isNullText())return;e===undefined&&(e=Math.max(0,this.element.wijtextselection().start));var t=this._textProvider.getCursorField(e);if(t<0)return;this._setOption("activeField",t)},s.prototype._toNextField=function(){this._setOption("activeField",this.options.activeField+1)},s.prototype._toPrevField=function(){this._setOption("activeField",this.options.activeField-1)},s.prototype._toFirstField=function(){this._setOption("activeField",0)},s.prototype._toLastField=function(){this._setOption("activeField",this._textProvider.getFieldCount())},s.prototype._clearField=function(e){typeof e=="undefined"&&(e=this.options.activeField);var t=this._textProvider.getFieldRange(e),r,i=this;t&&(r=new n.wijInputResult,this._textProvider.removeAt(t.start,t.end,r),this._updateText(),window.setTimeout(function(){i._highLightField()},1))},s.prototype.spinUp=function(){this._doSpin(!0,!1)},s.prototype.spinDown=function(){this._doSpin(!1,!1)},s.prototype.drop=function(){t.prototype._onTriggerClicked.call(this)},s.prototype.focus=function(){t.prototype.focus.call(this),this._addState("focus",this.outerDiv),this._updateText(),this.options.highlightText=="all"?(this._highLightAllField(),this._setOption("activeField",0)):this._highLightField()},s.prototype.isDateNull=function(){return this.options.date===null||this.options.date===undefined},s.prototype._min=function(e,t){return t==undefined?e:e<t?e:t},s.prototype._max=function(e,t){return t==undefined?e:e>t?e:t},s.prototype._allowEdit=function(){return!this.option("disableUserInput")},s.prototype._onFocus=function(e){var r=this;t.prototype._onFocus.call(this,e);if(!this._allowEdit())return;this._updateText();if(this.element.data("IsInSelectTextMethod")==1)return;if(n.CoreUtility.chrome){var i=this;i.element.data("needResoteActiveField",!0),window.setTimeout(function(){i.element.data("needResoteActiveField",!1),i.options.highlightText=="all"?(i._highLightAllField(),this._setOption("activeField",0)):i._highLightField()},200)}else this.options.highlightText=="all"?(this._highLightAllField(),this.element.data("ignoreHighLight",!0),this._setOption("activeField",0)):this._highLightField();n.CoreUtility.IPad&&(this._ipadRefreshTimer=setInterval(function(){r.element.data("ignoreHighLight")!=1&&r._highLightCursor()},400))},s.prototype._simulate=function(e){var r=null;if(typeof e=="string")r=e;else{var i=this.element.wijtextselection(),s=this.element.data("lastSelection").start,o=i.end;o>=s&&(r=this.element.val().substring(s,o))}for(var u=0;u<n.DateTimeInfo.GetEraCount();u++)if(r.toLowerCase()===n.DateTimeInfo.GetEraShortNames()[u].toLowerCase()||r.toLowerCase()===n.DateTimeInfo.GetEraAbbreviations()[u].toLowerCase()||r.toLowerCase()===n.DateTimeInfo.GetEraSymbols()[u].toLowerCase()||r.toLowerCase()===n.DateTimeInfo.GetEraNames()[u].toLowerCase()){r=n.DateTimeInfo.GetEraShortNames()[u].toLowerCase();break}t.prototype._simulate.call(this,r)},s.prototype._doSpin=function(e,t){var r=this;if(!this._allowEdit())return!1;if(t&&this.element.data("breakSpinner"))return!1;e?this._trigger("spinUp",null):this._trigger("spinDown",null);if(this.options.date==null){this._setDefaultDate(e);return}var i=!1;e?i=this._textProvider.incEnumPart():i=this._textProvider.decEnumPart();if(i){this._updateText();if(n.CoreUtility.chrome){var s=this;setTimeout(function(){s.element.focus(),s._highLightField()},10)}else this._highLightField()}if(t&&!this.element.data("breakSpinner")){var o=window.setTimeout(function(){return r._doSpin(e,!0)},this._calcSpinInterval());this.element.data("spintimer",o)}return!0},s.prototype._setDefaultDate=function(e){e?this.options.date=this._isEraFormatExist()?this._getRealEraMinDate():this._getRealMinDate():this.options.date=this._isEraFormatExist()?this._getRealEraMaxDate():this._getRealMaxDate(),this._updateText(),this._highLightField()},s.prototype._onChange=function(){},s.prototype._afterFocused=function(){this._isNullText()&&this._doFocus()},s.prototype._onBlur=function(e){t.prototype._onBlur.call(this,e),this._checkDate(),this._removeState("focus",this.outerDiv),this._updateText(),n.CoreUtility.IPad&&window.clearInterval(this._ipadRefreshTimer)},s.prototype._keyDownPreview=function(e){if(t.prototype._keyDownPreview.call(this,e))return!0;var r=e.keyCode||e.which,s;switch(r){case i.UP:case i.DOWN:if(e.altKey)return this._onTriggerClicked(),!0;if(this.element.data("pickerCurrentTab")!="List")return this._doSpin(r==i.UP,!1),this._stopEvent(e),!0;break;case i.LEFT:return this.options.activeField!=0||this.options.blurOnLeftRightKey.toLowerCase()!="left"&&this.options.blurOnLeftRightKey.toLowerCase()!="both"?this._toPrevField():(n.CoreUtility.MoveFocus(this.element.get(0),!1),this._trigger("keyExit")),!0;case i.RIGHT:return this.options.activeField!=this._textProvider.getFieldCount()-1||this.options.blurOnLeftRightKey.toLowerCase()!="right"&&this.options.blurOnLeftRightKey.toLowerCase()!="both"?this._toNextField():(n.CoreUtility.MoveFocus(this.element.get(0),!0),this._trigger("keyExit")),!0;case i.ENTER:if(this._wasPopupShowing)return this.element.data("pickerCurrentTab")=="Calendar"?this.options.date==null&&this._setOption("date",new Date):this.element.data("pickerCurrentTab")=="List"?this._processKeyForDropDownList(e):this._okButtonMouseDown(null,null),this._hidePopup(),!0;this.options.hideEnter&&t.prototype._stopEvent.call(this,e);break;case i.TAB:if(this.options.tabAction!=="field"||this.options.highlightText!=="field"){this._trigger("keyExit");break}s=this.element.wijtextselection();if(s&&s.end-s.start!==this.element.val().length){if(e.shiftKey){if(!(this.options.activeField>0)){this._trigger("keyExit");break}this._toPrevField()}else{if(!(this.options.activeField<this._textProvider.getFieldCount()-1)){this._trigger("keyExit");break}this._toNextField()}return!0}break;case i.SPACE:case 188:case 190:case 110:case 191:if(e.shiftKey){if(this.options.activeField>0)return this._toPrevField(),!0}else if(this.options.activeField<this._textProvider.getFieldCount()-1)return this._toNextField(),!0;break;case i.HOME:return e.ctrlKey?this._setOption("date",new Date):this._toFirstField(),!0;case i.END:return e.ctrlKey?this._processClearButton():this._toLastField(),!0;case i.BACKSPACE:case i.DELETE:if(this._allowEdit())return this._processDeleteKey(),!0}return!1},s.prototype._processDeleteKey=function(){if(this.options.date==null)return;var e=this.element.wijtextselection();if(e.end-e.start===this.element.val().length){var t=this._isEraFormatExist()?this._getRealEraMinDate():this._getRealMinDate();if(this.options.date>t){this._setOption("date",t);return}}else{var n=this.options.activeField,r=this._textProvider.getFiledText(n);this._clearField();var i=this._textProvider.getFiledText(n);if(r!=i)return}this._processClearButton()},s.prototype._autoMoveToNextField=function(e,t){if(!this.options.autoNextField)return;this._textProvider.needToMove(this.options.activeField,e,t)&&this._toNextField()},s.prototype._processClearButton=function(){this._allowEdit()?this._setOption("date",null):this._updateText()},s.prototype._autoMoveToNextControl=function(e,t,r){if(!this.options.blurOnLastChar||r!==this._textProvider.getFieldCount()-1)return;this._textProvider.needToMove(r,e,t)&&(n.CoreUtility.MoveFocus(this.element.get(0),!0),this._trigger("keyExit"))},s.prototype._keyPressPreview=function(e){var t=e.keyCode||e.which,n,r,s,o,u,a,f,l,c,h;if(t===i.ENTER)return this.isDateNull()&&this._setOption("date",new Date),!1;n=this._textProvider.getFieldRange(this.options.activeField);if(n){if(t===i.TAB)return!0;if(t===i.SPACE)return this._stopEvent(e),!0;r=String.fromCharCode(t),s=this._textProvider.isFieldSep(r,this.options.activeField);if(s)return this._toNextField(),this._stopEvent(e),!0;o=this.element.data("cursorPos"),u=new Date,f=this.element.data("timeStamp"),h=this.element.data("lastInput"),a=u.getTime()-f.getTime()>this.options.keyDelay;var p=r;a?o=0:h&&(p=h+p),this.element.data({timeStamp:u,lastInput:p}),l=n.start+o,this.element.data("cursorPos",++o);var d=this.options.date==null;c=this._textProvider.addToField(p,this.options.activeField,l);var v=this.options.activeField;return c?(this._updateText(),this._autoMoveToNextField(o,r),this._highLightField(),this._autoMoveToNextControl(o,r,v)):(d&&this._setOption("date",null),this._resetTimeStamp(),this._fireIvalidInputEvent()),v!=this.options.activeField?this.element.data("lastInputChar",""):this.element.data("lastInputChar",r),this._stopEvent(e),!0}return!1},s.prototype._raiseDataChanged=function(){var e=this.options.date,t=this.element.data("preDate");this.element.data("preDate",e?new Date(e.getTime()):null);if(!t&&e||t&&!e||t&&e&&t.getTime()!==e.getTime())this._popupVisible()&&this._syncCalendar(),this.element.attr("aria-valuenow",e),this._trigger("dateChanged",null,{date:e})},s.prototype._isMinDate=function(e){return e.getFullYear()===1&&e.getMonth()===0&&e.getDate()===1},s.prototype._reInitPicker=function(){this._destroyPicker(),this._initPicker()},s.prototype._destroy=function(){t.prototype._destroy.call(this),this._destroyPicker()},s.prototype._destroyPicker=function(){var e=this.element.data("pickers");e!=undefined&&(this.element.data("pickers",null),this.element.data("calendar",null),this.element.data("datePicker",null),this.element.data("timePicker",null),this._comboDiv=undefined)},s.prototype._initPicker=function(){var e=this,t=this.element.data("pickers");if(t!=undefined)return;var i=this;this._initPickerData();var s=this._getPickerCount(),o=this.element.data("pickerWidth"),u=this.element.data("pickerHeight"),a=this.element.data("pickerAreaHeight");s>1&&(u+=8,a+=8);var f=s>1?u:a;t=r("<table/>").appendTo(document.body).attr({"class":"ui-widget-content ui-corner-all",borderWidth:"0px",cellspacing:"0px",cellpadding:"0px",cursor:"default"}).css({"font-size":"12px"}).mouseup(function(e){e.stopPropagation()});var l=r("<tr/>").appendTo(t),c=r("<tr/>").appendTo(t),h=r("<td/>").appendTo(l).css({width:"100%",height:"100%"}),p=r("<td/>").appendTo(c).attr("align","center").css({width:"100%",height:"30px",display:"none"}),d=r("<input type='button'/>").appendTo(p).attr({"class":"ui-state-active ui-widget",value:"OK"}).css({width:"80px",height:"26px",margin:"1px","text-align":"center",cursor:"pointer",visibility:"hidden"}).mousedown(function(e){i._okButtonMouseDown(e)}),v=r("<div/>").appendTo(h).css({width:"100%",height:"100%",padding:"0px",margin:"0px",borderWidth:"0px",overflow:"hidden"}),m=r("<ul/>").css({"line-height":"1px","font-size":"12px"});s>1&&m.appendTo(v);var g="";if(this._isCalendarPickerShown()){s>1?this._addPickerTab(m,"Calendar","#calendarDiv"):n.CoreUtility.IsIE9()&&(h.css({width:""}),v.css({width:""})),this._initCalendarPicker();var y=this.element.data("calendar");this._addPickerEditor(v,y,"calendarDiv"),g="Calendar"}this._isListPickerShown()&&(s>1&&this._addPickerTab(m,"List","#listDiv"),this._initListPicker(),this._addPickerEditor(v,this._comboDiv,"listDiv"),g=g==""?"List":g);if(this._isDatePickerShown()){s>1&&this._addPickerTab(m,"Date","#dateDiv"),this._wijinputdateroller._initDatePicker();var b=this.element.data("datePicker");this._addPickerEditor(v,b,"dateDiv"),g=g==""?"Date":g}if(this._isTimePickerShown()){s>1&&this._addPickerTab(m,"Time","#timeDiv"),this._wijinputdateroller._initTimePicker();var w=this.element.data("timePicker");this._addPickerEditor(v,w,"timeDiv"),g=g==""?"Time":g}if(g=="Calendar")t.css({width:o+"px",height:"","font-size":""});else if(g=="Date"||g=="Time")p.css({display:""}),t.css({width:o+"px",height:u+"px","font-size":"12px"}),v.css({height:f+"px"});this.element.data("pickerCurrentTab",g);var i=this;v.wijtabs({select:function(e,r){var s=r.tab.outerText||r.tab.text;p.css({display:"none"}),i.element.data("pickerCurrentTab",s);if(s=="Calendar")n.CoreUtility.IPad||i.focus(),t.css({width:o+"px",height:"","font-size":""}),v.css({height:"100%"});else if(s=="List"){var a=i._getListPickerWidth();i._comboDiv.wijlist("option","width",a),t.css({width:a,height:"","font-size":""}),v.css({height:"100%"}),i._comboDiv.wijlist("renderList"),n.CoreUtility.IPad||i._comboDiv.focus()}else{n.CoreUtility.IPad||i.focus();if(s=="Time"||s=="Date")p.css({display:""}),t.css({width:o+"px",height:u+"px","font-size":"12px"}),v.css({height:f+"px"})}}}),t.wijpopup({autoHide:!0,hidden:function(){e._trigger("dropDownClose"),e._wasPopupShowing=!1},shown:function(){e._trigger("dropDownOpen"),e._wasPopupShowing=!0;var t=e.options.calendar,n,r,i;if(!t||!t.calendarMode)return;n=e.element.data("calendar"),r=n.data("wijmo-wijcalendar"),r!=null&&setTimeout(function(){i=r._getMyGrid(),i.gridType=t.calendarMode,r._updateMyGrid(1)},0)}}),this.element.data("pickers",t),this.element.data("divPickers",v),this.element.data("divOK",d)},s.prototype._initPickerData=function(){var e=70,t=32,n=26,r=30,i=150,s=100,o=235,u=242,a=220,f=220,l=this._getPickerCount(),c=l*e,h=s;c=c<i?i:c,this._isCalendarPickerShown()&&(c=c<o?o:c,h=h<u?u:h);if(this._isListPickerShown()){var p=this._getcomboItems();if(p!=undefined){var d=p.length*n;h=h<d?d:h}}if(this._isDatePickerShown()){c=c<a?a:c,h=h<a?a:h;var v=this._wijinputdateroller._getDatePickerMinYear(),m=this._wijinputdateroller._getDatePickerMaxYear(),g=this._wijinputdateroller._getDefaultDatePickerFormat(),y=this.options.pickers.datePicker.format!=undefined?this.options.pickers.datePicker.format:g,b=y.split(",");b.length!=3&&(b=g.split(","),this.options.pickers.datePicker.format=g);var w=this._wijinputdateroller._getRollFormat(b,"y"),E=this._wijinputdateroller._getRollFormat(b,"M"),S=this._wijinputdateroller._getRollFormat(b,"d");if(!this._wijinputdateroller._isValidatePickerFormat(w)||!this._wijinputdateroller._isValidatePickerFormat(E)||!this._wijinputdateroller._isValidatePickerFormat(S))b=g.split(","),w=this._wijinputdateroller._getRollFormat(b,"y"),E=this._wijinputdateroller._getRollFormat(b,"M"),S=this._wijinputdateroller._getRollFormat(b,"d"),this.options.pickers.datePicker.format=g;this.element.data("pickerDateYearFormat",w),this.element.data("pickerDateMonthFormat",E),this.element.data("pickerDateDayFormat",S),this.element.data("pickerMinYear",v),this.element.data("pickerMaxYear",m),this.element.data("pickerDateFormat",b)}if(this._isTimePickerShown()){c=c<a?a:c,h=h<a?a:h;var x=this._wijinputdateroller._getDefaultTimePickerFormat(),T=this.options.pickers.timePicker.format!=undefined?this.options.pickers.timePicker.format:x,N=T.split(",");N.length!=3&&(N=x.split(","),this.options.pickers.timePicker.format=x);var C=this._wijinputdateroller._getRollFormat(N,"h"),k=this._wijinputdateroller._getRollFormat(N,"m"),L=this._wijinputdateroller._getRollFormat(N,"t");if(!this._wijinputdateroller._isValidatePickerFormat(C)||!this._wijinputdateroller._isValidatePickerFormat(k)||!this._wijinputdateroller._isValidatePickerFormat(L))N=x.split(","),C=this._wijinputdateroller._getRollFormat(N,"h"),k=this._wijinputdateroller._getRollFormat(N,"m"),L=this._wijinputdateroller._getRollFormat(N,"t"),this.options.pickers.timePicker.format=x;this.element.data("pickerTimeHourFormat",C),this.element.data("pickerTimeMinuteFormat",k),this.element.data("pickerTimeAMFormat",L),this.element.data("pickerTimeFormat",N)}var A=this.options.pickers.width!=undefined?this.options.pickers.width:0,O=this.options.pickers.height!=undefined?this.options.pickers.height:0;A=A<c?c:A,O=O<h?h:O,O-=l>1?t:0;var M=O-r,_=Math.floor(M/5)+1,D=_*2,P=_*5+6,H=_*4-3,B=_*2+2,j=_;this.element.data("itemHeight",_),this.element.data("indicatorHeight",D),this.element.data("pickerWidth",A),this.element.data("pickerHeight",O),this.element.data("pickerAreaHeight",M),this.element.data("indicatorTranslateTop",P),this.element.data("indicatorTranslateDown",H),this.element.data("indicatorTranslateSelector",B),this.element.data("indicatorTranslateContent",j)},s.prototype._initListPicker=function(){var e=this;if(this._comboDiv!==undefined)return;this._comboDiv=r("<div/>").css({overflow:"hidden",display:"block",left:"",top:"",position:""});var t=this._normalize(this._getcomboItems());this._comboDiv.wijlist({maxItemsCount:5,autoSize:!0,selected:function(t,n){e.options.disableUserInput||e._setData(n.item.value);var r=e.element.data("pickers");setTimeout(function(){try{r!=undefined&&r.wijpopup("hide")}catch(e){}},250),e._trySetFocus()}}),this._comboDiv.wijlist("setItems",t),this._comboDiv.wijlist("renderList"),n.CoreUtility.IsIE7()&&this._comboDiv.attr("align","left")},s.prototype._initCalendarPicker=function(){var e=this,t=this.element.data("calendar");if(t!=undefined)return;var n=r("<div/>");t=r(n);if(t.length!==1)return;this.element.data("calendar",t),this.options.localization&&(this.options.nextTooltip=this.options.localization.nextTooltip,this.options.prevTooltip=this.options.localization.prevTooltip,this.options.titleFormat=this.options.localization.titleFormat,this.options.toolTipFormat=this.options.localization.toolTipFormat),t.wijcalendar({popupMode:!0,culture:this.options.culture,cultureCalendar:this.options.cultureCalendar,nextTooltip:this.options.nextTooltip||"Next",prevTooltip:this.options.prevTooltip||"Previous",titleFormat:this.options.titleFormat||"MMMM yyyy",toolTipFormat:this.options.toolTipFormat||"dddd, MMMM dd, yyyy",afterSlide:function(){e.options.afterSlide!=null&&e.options.afterSlide.call(e,null)},selectedDatesChanged:function(){var n=t.wijcalendar("getSelectedDate"),r=e.option("date");e._wasPopupShowing=!1;var i=e.element.data("pickers");setTimeout(function(){try{i!=undefined&&i.wijpopup("hide"),n&&(r&&(n.setHours(r.getHours()),n.setMinutes(r.getMinutes()),n.setSeconds(r.getSeconds()),n.setMilliseconds(r.getMilliseconds())),e._allowEdit()&&(e.option("date",n),e.selectText())),e._trySetFocus()}catch(t){}},250)}}),t.css({display:"block",left:"",top:"",position:"","margin-bottom":"0px"}),this._syncCalendar(),this._updateCalendarPicker()},s.prototype._updateCalendarPicker=function(){var e=this.element.data("calendar"),t=this.options.pickers;if(e==undefined||t==undefined)return;if(t.calendar==undefined)return;t.calendar.allowQuickPick!=undefined&&e.wijcalendar("option","allowQuickPick",t.calendar.allowQuickPick),t.calendar.navButtons!=undefined&&e.wijcalendar("option","navButtons",t.calendar.navButtons),t.calendar.nextTooltip!=undefined&&e.wijcalendar("option","nextTooltip",t.calendar.nextTooltip),t.calendar.prevTooltip!=undefined&&e.wijcalendar("option","prevTooltip",t.calendar.prevTooltip),t.calendar.showDayPadding!=undefined&&e.wijcalendar("option","showDayPadding",t.calendar.showDayPadding),t.calendar.showOtherMonthDays!=undefined&&e.wijcalendar("option","showOtherMonthDays",t.calendar.showOtherMonthDays),t.calendar.showTitle!=undefined&&e.wijcalendar("option","showTitle",t.calendar.showTitle),t.calendar.showWeekDays!=undefined&&e.wijcalendar("option","showWeekDays",t.calendar.showWeekDays),t.calendar.showWeekNumbers!=undefined&&e.wijcalendar("option","showWeekNumbers",t.calendar.showWeekNumbers),t.calendar.titleFormat!=undefined&&e.wijcalendar("option","titleFormat",t.calendar.titleFormat),t.calendar.toolTipFormat!=undefined&&e.wijcalendar("option","toolTipFormat",t.calendar.toolTipFormat),t.calendar.weekDayFormat!=undefined&&e.wijcalendar("option","weekDayFormat",t.calendar.weekDayFormat)},s.prototype._okButtonMouseDown=function(e,t){var n=this.element.data("pickerYear"),r=this.element.data("pickerMonth")-1,i=this.element.data("pickerDay"),s=this.element.data("pickerHour"),o=this.element.data("pickerMinute"),u=this.element.data("pickerAM");s==12&&(s=0),u==1&&(s+=12);var a=this._getPickerValue();a.setFullYear(n),a.setMonth(r),a.setDate(i),a.setHours(s),a.setMinutes(o),this._wasPopupShowing=!1;var f=this.element.data("pickers");setTimeout(function(){if(f!=undefined)try{f.wijpopup("hide")}catch(e){}},250),this._allowEdit()&&(this.option("date",a),this.selectText()),this._trySetFocus()},s.prototype._getListPickerWidth=function(){var e=this._getcomboWidth(),t=this.element.data("pickerWidth"),n=e!=undefined?e:this.outerDiv.width();return t>n?t+"px":n+"px"},s.prototype._getPickerValue=function(){var e=this.options.date;return e=e==null?new Date:e,e},s.prototype._getStandardAMPM=function(e){var t=this._getCulture();if(t&&t.calendar){var n=t.calendars.standard[e];if(n)return n[0]}return e},s.prototype._syncCalendar=function(){var e=this.element.data("calendar");if(!e)return;var t=this._safeGetDate();if(t==null||this._isMinDate(t))t=new Date;e.wijcalendar("option","displayDate",new Date(t.getFullYear(),t.getMonth(),1)),this.options.minDate&&e.wijcalendar("option","minDate",this.options.minDate),this.options.maxDate&&e.wijcalendar("option","maxDate",this.options.maxDate),e.wijcalendar("unSelectAll"),e.wijcalendar("selectDate",t),e.wijcalendar("refresh")},s.prototype._showPopup=function(){this._isDatePickerNeedReInit()&&this._reInitPicker();var e=this.element.data("pickers");if(e==undefined)return!1;e.wijpopup("show",r.extend({},this.options.popupPosition,{of:this.outerDiv}));var t=this._getPickerValue(),n=t.getHours();n>12?n-=12:n==0&&(n=12),this.element.data("pickerValue",t),this.element.data("pickerYear",t.getFullYear()),this.element.data("pickerMonth",t.getMonth()+1),this.element.data("pickerDay",t.getDate()),this.element.data("pickerHour",n),this.element.data("pickerMinute",t.getMinutes()),this.element.data("pickerAM",t.getHours()<12?0:1),this.element.data("divOK").css("visibility",""),this._isTimePickerShown()&&(this._wijinputdateroller._updateTimePicker(),e.attr({"class":"ui-widget-content ui-corner-all"})),this._isDatePickerShown()&&(this._wijinputdateroller._updateDatePicker(),e.css({"font-size":"12px"}).attr({"class":"ui-widget-content ui-corner-all"}));if(this._isListPickerShown()){this._getPickerCount()==1&&(e.attr({"class":""}),this._comboDiv.focus());if(this.element.data("pickerCurrentTab")=="List"){var i=this._getListPickerWidth();e.css({width:i,height:""}),e.css({"font-size":""});var s=this._comboDiv[0].parentElement;this._comboDiv.wijlist("destroy"),this._comboDiv.remove(),delete this._comboDiv,this._initListPicker(),this._comboDiv.appendTo(s),this._comboDiv.focus()}}return this._isCalendarPickerShown()&&(this._syncCalendar(),this.element.data("pickerCurrentTab")=="Calendar"&&(this._getPickerCount()<=1&&e.css({width:""}),e.css({"font-size":""}))),!0},s.prototype._hidePopup=function(){var e=this.element.data("pickers");e!=undefined&&e.wijpopup("hide"),this.element.data("divOK").css("visibility","hidden")},s.prototype._popupVisible=function(){var e=this.element.data("pickers");return e!=undefined?e.wijpopup("isVisible"):!1},s.prototype._isComboListVisible=function(){return this._popupVisible()},s.prototype._isValidDate=function(e,t){if(e===undefined)return!1;if(isNaN(e))return!1;if(e.getFullYear()<1||e.getFullYear()>9999)return!1;if(t){if(this.options.minDate&&e<this.options.minDate)return!1;if(this.options.maxDate&&e>this.options.maxDate)return!1}return!0},s.prototype._isDatePickerNeedReInit=function(){if(!this._isDatePickerShown())return!1;var e=this.element.data("pickerMinYear"),t=this.element.data("pickerMaxYear"),n=this._getPickerValue().getFullYear();if(n<e||n>t)return!0;var r=this._isEraFormatExist()?this._getRealEraMinDate().getFullYear():this._getRealMinDate().getFullYear(),i=this._isEraFormatExist()?this._getRealEraMaxDate().getFullYear():this._getRealMaxDate().getFullYear();return e<r||t>i?!0:!1},s.prototype._isDropDownButtonShown=function(){return this.options.showDropDownButton},s.prototype._isCalendarPickerShown=function(){return this.options.pickers.calendar!=undefined&&this.options.pickers.calendar.visible!==!1||this._getPickerCount()==0},s.prototype._isListPickerShown=function(){var e=this._getcomboItems();return e!=undefined&&e.length!=undefined?e.length>0:!1},s.prototype._isTimePickerShown=function(){return this.options.pickers.timePicker!=undefined&&this.options.pickers.timePicker.visible!==!1&&this._wijinputdateroller!==null},s.prototype._isDatePickerShown=function(){return this.options.pickers.datePicker!=undefined&&this.options.pickers.datePicker.visible!==!1&&this._wijinputdateroller!==null},s.prototype._getPickerCount=function(){var e=0,t=this.options.pickers.calendar!=undefined&&this.options.pickers.calendar.visible!==!1;return e+=t?1:0,e+=this._isListPickerShown()?1:0,e+=this._isTimePickerShown()?1:0,e+=this._isDatePickerShown()?1:0,e},s.prototype._addPickerEditor=function(e,t,n){var i=r("<div/>").attr({id:n,align:"center"}).css({padding:"0px"}).append(t).appendTo(e)},s.prototype._addPickerTab=function(e,t,n){var i=r("<li/>").appendTo(e).css("line-height","1px"),s=r("<a/>").attr("href",n).html(t).appendTo(i)},s.prototype._internalSetDate=function(e){var t=this,n=this.options,r=this.element,i=!!r.data("typing"),s;i?(n.date=e,s=function(){var e=new Date,i=r.data("timeStamp");i&&(e.getTime()-i.getTime()>n.keyDelay?(t._safeSetDate(n.date,!0),t._updateText(),t._highLightField()):window.setTimeout(s,n.keyDelay))},window.setTimeout(s,n.keyDelay)):this._safeSetDate(e)},s.prototype.selectText=function(e,n){typeof e=="undefined"&&(e=0),typeof n=="undefined"&&(n=this.getText().length);if(this.isFocused())t.prototype.selectText.call(this,e,n);else{this.element.data("IsInSelectTextMethod",!0),this.focus();var r=this;setTimeout(function(){try{r.selectText(e,n)}catch(t){}},0),this.element.data("IsInSelectTextMethod",!1)}},s}(n.wijinputcore);n.wijinputdate=s;var o=function(){function e(){this.wijCSS={wijinputdate:n.wijinputcore.prototype.options.wijCSS.wijinput+"-date"},this.date=undefined,this.minDate=null,this.maxDate=null,this.dateFormat="d",this.displayFormat="",this.amDesignator="",this.pmDesignator="",this.midnightAs0=!0,this.hour12As0=!1,this.blurOnLastChar=!1,this.blurOnLeftRightKey="none",this.tabAction="field",this.startYear=1950,this.promptChar="",this.smartInputMode=!1,this.activeField=0,this.keyDelay=800,this.autoNextField=!0,this.calendar=null,this.popupPosition={offset:"0 4"},this.afterSlide=null,this.highlightText="field",this.increment=1,this.imeMode="auto",this.showDropDownButton=!0,this.showTrigger=undefined,this.pickers={list:undefined,width:undefined,height:undefined,calendar:undefined,datePicker:undefined,timePicker:undefined},this.dateChanged=null,this.spinUp=null,this.spinDown=null,this.valueBoundsExceeded=null}return e}();s.prototype.options=r.extend(!0,{},n.wijinputcore.prototype.options,new o),r.wijmo.registerWidget("wijinputdate",s.prototype);var u=function(){function e(e,t,r){this.inputWidget=e,this._disableSmartInputMode=!1,this.paddingZero=n.paddingZero,this.formatter=new n.wijDateTextFormatter(e,t,!1),r=r==""?t:r,this.displayFormatter=new n.wijDateTextFormatter(e,r,!0)}return e.prototype.initialize=function(){},e.prototype.getFiledText=function(e){var t=this.formatter.fields[e];return t.getText()},e.prototype.getFieldCount=function(){return this.formatter.fields.length},e.prototype.getFieldRange=function(e){e>=this.formatter.fields.length&&(e=this.formatter.fields.length-1);var t=this.formatter.fields[e];return{start:t.startIndex,end:t.startIndex+t.getText().length}},e.prototype.getAllRange=function(){return{start:0,end:this.formatter.toString().length}},e.prototype.getCursorField=function(e){if(this.formatter.desPostions.length==0)return 0;e=Math.min(e,this.formatter.desPostions.length-1),e=Math.max(e,0);var t=this.formatter.desPostions[e].desc,n;if(t.type===-1){n=r.inArray(t,this.formatter.descriptors);if(!(n>0&&this.formatter.descriptors[n-1].type!==-1))return-1;t=this.formatter.descriptors[n-1]}return r.inArray(t,this.formatter.fields)},e.prototype.needToMove=function(e,t,r){if(!this.inputWidget._isValidDate(this.inputWidget._safeGetDate(),!0))return!1;var i=this.formatter.fields[e];switch(i.type){case 72:case 73:case 74:for(var s=0;s<n.DateTimeInfo.GetEraCount();s++)if(r.toLowerCase()===n.DateTimeInfo.GetEraShortcuts()[s].toLowerCase()||r.toLowerCase()===n.DateTimeInfo.GetEraShortNames()[s].toLowerCase()||r.toLowerCase()===n.DateTimeInfo.GetEraAbbreviations()[s].toLowerCase()||r.toLowerCase()===n.DateTimeInfo.GetEraNames()[s].toLowerCase())return!0;return!1}var o=parseInt(r,10);if(t===i.maxLen)return!0;if(isNaN(o))return!1;var u=this.inputWidget.element.data("lastInputChar");switch(i.type){case 10:return this._isSmartInputMode()&&t===2;case 20:case 25:case 45:case 46:return u=="0"&&o==1?!0:o>1;case 47:case 48:return u=="0"&&o<=2?!0:o>2;case 30:case 31:return u=="0"&&o<=3?!0:o>3;case 50:case 51:case 60:case 61:return u=="0"&&o<=6?!0:o>6;case 70:case 71:return!1}return!1},e.prototype._isEraFormatExist=function(){return this.formatter._isEraFormatExist()},e.prototype._getCulture=function(){return this.inputWidget._getCulture()},e.prototype._isDigitString=function(e){e=r.trim(e);if(e.length===0)return!0;var t=e.charAt(0),n,i;if(t==="+"||t==="-")e=e.substr(1),e=r.trim(e);if(e.length===0)return!0;try{return n=parseFloat(e),i=n.toString(),i===e}catch(s){return!1}},e.prototype._setFormat=function(e){return this.formatter._setFormat(e)},e.prototype._setDisplayFormat=function(e){return this.displayFormatter._setFormat(e)},e.prototype._internalSetDate=function(e){this.inputWidget&&this.inputWidget._internalSetDate(e)},e.prototype.toString=function(){if(this.inputWidget._isEraFormatExist()&&this.inputWidget.options.date!=null){var e=this.inputWidget._getRealEraMinDate(),t=this.inputWidget._getRealEraMaxDate();if(this.inputWidget.options.date<e||this.inputWidget.options.date>t)return""}return this.inputWidget.isFocused()?this.formatter.toString():this.inputWidget.isDateNull()&&this.inputWidget._getInnerNullText()!=null?this.inputWidget._getInnerNullText():this.displayFormatter.toString()},e.prototype.parseDate=function(e){var t;return t=r.wijinputcore.parseDate(e,this.formatter.pattern,this._getCulture()),t},e.prototype.setText=function(e){if(e==="")this._internalSetDate(null);else{var t=new Date(e);isNaN(t.getTime())&&(t=this.parseDate(e)),t==null?this._internalSetDate(new Date(e)):this._internalSetDate(t)}return!0},e.prototype.haveEnumParts=function(){return!1},e.prototype.removeLiterals=function(e){return e=""+e+"",e=e.replace(new RegExp("[+]","g"),""),e=e.replace(new RegExp("[.]","g"),""),e=e.replace(new RegExp("[:]","g"),""),e=e.replace(new RegExp("[-]","g"),""),e=e.replace(new RegExp("[()=]","g"),""),e},e.prototype.getFirstDelimiterPos=function(e,t){var n=0,r=0,i,s;while(n<t.length&&r<e.length){i=t.charAt(n),s=e.charAt(r);if(i!==s)return r-1;r++,n++}return e.length-1},e.prototype.isFieldSep=function(e,t){var n=t++,r;return n<this.formatter.descriptors.length?(r=this.formatter.descriptors[n],r.type!==-1?!1:e===r.text):!1},e.prototype.getPositionType=function(e){var t=this.formatter.desPostions[e];return t.desc.type},e.prototype.addToField=function(e,t,n){var r=this.formatter.fields[t],i,s,o;return i=e,s={val:e,pos:0,offset:0,isreset:!1},this.inputWidget.element.data("typing",!0),o=r.setText(i,e.length===1?!1:!0,s,this._isSmartInputMode()),this.inputWidget.element.data("typing",!1),o},e.prototype.insertAt=function(e,t,r){typeof r=="undefined"&&(r=new n.wijInputResult),r.testPosition=-1;var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w;if(e.length===1){i=this.formatter.desPostions[t];if(i&&i.desc.type===-1&&i.text===e)return r.testPosition=t,r.hint=r.characterEscaped,!0}s=e,o=t,e=this.removeLiterals(e),u=e,a=!1,l=!1,o>0&&u.length===1&&(o--,t=o,i=this.formatter.desPostions[o],a=!0,i&&(i.desc.type===-1||i.desc.getText().length!==1)&&(t++,o++,a=!1)),f=!1;while(u.length>0&&o<this.formatter.desPostions.length){i=this.formatter.desPostions[o];if(i.desc.type===-1){o+=i.length;continue}if(i.desc.needAdjustInsertPos()){c=u.substr(0,i.length-i.pos),c=i.text.slice(0,i.pos)+c+i.text.slice(i.pos+c.length,i.length),a&&(c=i.text+c),l&&(c+=i.text),p=i.desc.getText().length,v="";try{e.length===1&&(i.pos?i.pos>0&&(v=c.substring(0,i.pos+1)):v=e)}catch(E){}p===1&&c.length>1&&e.length===1&&(i.desc.type===31||i.desc.type===25)&&(this._disableSmartInputMode=!0),h={val:e,pos:i.pos,offset:0,isreset:!1},f=i.desc.setText(c,e.length===1?!1:!0,h),this._disableSmartInputMode=!1,!f&&typeof v!="undefined"&&v.length>0&&(i.desc.type===26||i.desc.type===27||i.desc.type===100||i.desc.type===101||i.desc.type===250||i.desc.type===251)&&(f=i.desc.setText(v,e.length===1?!1:!0,h));if(f)r.hint=r.success,r.testPosition=o+h.offset,e.length===1&&(m=i.desc.getText().length,d=i.pos,i.pos>m-1&&(d=m),g=m-p,g>0&&i.pos===p-1&&(d=m-1),y=this.toString(),r.testPosition=i.desc.startIndex+d+h.offset),u=u.slice(i.length-i.pos,u.length);else{r.hint=r.invalidInput,r.testPosition!==-1&&(r.testPosition=t);if(i.desc.type!==-1&&e.length===1)return!1}o+=i.length}else b=this.getFirstDelimiterPos(u,s),b<0&&(b=0),c=u.substring(0,b+1),h={val:e,pos:i.pos,offset:0,isreset:!1},f=i.desc.setText(c,e.length===1?!1:!0,h),f?(r.hint=r.success,r.testPosition=o+h.offset,u=u.slice(b+1,u.length)):(r.hint=r.invalidInput,r.testPosition!==-1&&(r.testPosition=t)),b<0&&(b=0),w=b+1,o+=w}return f},e.prototype.removeAt=function(e,t,n,r){try{var i=this.formatter.desPostions[e],s,o,u,a,f=this.inputWidget,l=f.element,c=l.val().length;return c===t+1&&e===0&&(f.isDeleteAll=!0),i.desc.needAdjustInsertPos()&&(s="0",o=e,i.text=i.desc.getText(),s=i.text.slice(0,i.pos)+s+i.text.slice(i.pos+s.length,i.length),i.desc.name==="tt"?s="AM":i.desc.name==="t"?s="A":i.desc.formatString==="ee"?s="01":i.desc.formatString==="e"&&(s="1"),u={val:s,pos:i.pos,offset:0,isreset:!0,isfullreset:!1},t-e+1>=i.length&&(u.isfullreset=!0,e+=i.length,o=e),a=i.desc.setText(s,!1,u,this._isSmartInputMode()),a?(n.hint=n.success,n.testPosition=o):(n.hint=n.invalidInput,n.testPosition===-1&&(n.testPosition=e))),e<t&&this.removeAt(e+1,t,n),!0}catch(h){return!1}},e.prototype.incEnumPart=function(){var e=this.formatter.fields[this.inputWidget.options.activeField];return e&&e.inc(),!0},e.prototype.decEnumPart=function(){var e=this.formatter.fields[this.inputWidget.options.activeField];return e&&e.dec(),!0},e.prototype._isSmartInputMode=function(){return this._disableSmartInputMode?!1:this.inputWidget?this.inputWidget.options.smartInputMode:!0},e.prototype._getInt=function(e,t,n,i){var s,o;for(s=i;s>=n;s--){o=e.substring(t,t+s);if(o.length<n)return null;if(r.wij.charValidator.isDigit(o))return o}return null},e.prototype._tryParseDate=function(e,t){var n=this._getCulture().calendars,r,i,s,o;return t=t||n.standard.patterns.d,t&&(t.indexOf("MMM")===-1&&t.indexOf("MMMM")===-1&&(t=t.replace("MM","M")),t=t.replace("dd","d"),t=t.replace("tt","a")),r=t.replace("yyyy","yy"),i=n.standard["/"],s=[t,r,t.replace(new RegExp(i,"g"),"-"),r.replace(new RegExp(i,"g"),"-"),t.replace(new RegExp(i,"g"),"."),r.replace(new RegExp(i,"g"),".")],o=Globalize.parseDate(e,s,this._getCulture()),o?o:(o=new Date(e),o.toString()!=="Invalid Date"&&e&&e!==""?o:0)},e.prototype._formatDate=function(e,t,r){var i=this;if(!e.valueOf())return"&nbsp;";var s=this.inputWidget._getCulture().calendars.standard,o=t.replace(new RegExp("yyyy|MMMM|MMM|MM|M|mm|m|dddd|ddd|dd|d|hh|h|HH|H|ss|s|tt|t|a/p","gi"),function(t){var o;switch(t){case"yyyy":return n.paddingZero(e.getFullYear(),4);case"MMMM":return r.dateTimeFormat.monthNames[e.getMonth()];case"MMM":return r.dateTimeFormat.abbreviatedMonthNames[e.getMonth()];case"MM":return i.paddingZero(e.getMonth()+1,2);case"M":return i.paddingZero(e.getMonth()+1,1);case"mm":return i.paddingZero(e.getMinutes(),2);case"m":return i.paddingZero(e.getMinutes(),1);case"dddd":return r.dateTimeFormat.dayNames[e.getDay()];case"ddd":return r.dateTimeFormat.abbreviatedDayNames[e.getDay()];case"dd":return i.paddingZero(e.getDate(),2);case"d":return i.paddingZero(e.getDate(),1);case"hh":return o=e.getHours()%12,i.paddingZero(o?o:12,2);case"h":return o=e.getHours()%12,i.paddingZero(o?o:12,1);case"HH":return i.paddingZero(e.getHours(),2);case"H":return i.paddingZero(e.getHours(),1);case"ss":return i.paddingZero(e.getSeconds(),2);case"s":return i.paddingZero(e.getSeconds(),1);case"tt":return e.getHours()<12?s.AM[0]:s.PM[0];case"t":return e.getHours()<12?s.AM[0].length>0?s.AM[0].charAt(0):"":s.PM[0].length>0?s.PM[0].charAt(0):"";case"a/p":return e.getHours()<12?"a":"p"}return"N"});return o},e.prototype.replaceWith=function(e,t){var r=e.start,i=new n.wijInputResult;return e.start<e.end&&(this.removeAt(e.start,e.end-1,i,!0),r=i.testPosition),this.insertAt(t,r,i)?i:null},e}();n.wijDateTextProvider=u})(t.input||(t.input={}));var n=t.input})(wijmo||(wijmo={}))});