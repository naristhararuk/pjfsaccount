var wijmo;define(["./wijmo.widget","swfobject","jquery.bgiframe","jquery.cookie","./wijmo.wijvideo"],function(){var e=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};(function(t){(function(n){var r=jQuery,i="wijlightbox";!window.S&&window.swfobject&&(window.S={flash:window.swfobject});var s=function(n){function i(){n.apply(this,arguments)}return e(i,n),i.prototype._keyDownHandler=function(e){var n=this.options,r=this,i=t.getKeyCodeEnum();if(e.keyCode&&e.keyCode===i.ESCAPE){r._isFullSize()?r._toggleFullSize():n.closeOnEscape&&r._close(),e.preventDefault();return}if(n.keyNav&&e.keyCode)switch(e.keyCode){case i.LEFT:case i.DOWN:r.back(),e.preventDefault();break;case i.RIGHT:case i.UP:r.next(),e.preventDefault();break;case i.HOME:n.groupItems.length>0&&r.show(0),e.preventDefault();break;case i.END:n.groupItems.length>0&&r.show(n.groupItems.length-1),e.preventDefault()}},i.prototype._create=function(){var e=this.options,t=this;window.wijmoApplyWijTouchUtilEvents&&(r=window.wijmoApplyWijTouchUtilEvents(r)),e.groupItems||(e.groupItems=[]),this._defaults={transAnimation:{animated:"fade",duration:400,easing:"linear"},resizeAnimation:{animated:"sync",duration:400},textShowOption:{duration:300,easing:"linear"},textHideOption:{duration:300,easing:"linear"}},this._parse(),this.container=r("<div/>").addClass("wijmo-wijlightbox "+e.wijCSS.widget+" wijmo-wijlightbox-controls-"+e.controlsPosition).css("z-index",e.zIndex).attr({tabIndex:-1,role:"dialog"}).bind("keydown.wijlightbox",r.proxy(t,"_keyDownHandler")).appendTo(document.body).hide(),this.frame=r("<div></div>").addClass(["wijmo-wijlightbox-frame",e.wijCSS.content,e.wijCSS.cornerAll,e.wijCSS.helperClearFix].join(" ")).appendTo(this.container),this.content=r("<div></div>").addClass("wijmo-wijlightbox-content").appendTo(this.frame),e.activeIndex===undefined?(typeof e.activeIndex!="number"&&e.cookie&&(e.activeIndex=parseInt(t._cookie(),10)),e.activeIndex=e.activeIndex||(e.groupItems.length?0:-1)):e.activeIndex===null&&(e.activeIndex=-1),e.activeIndex=e.activeIndex>=0&&e.groupItems[e.activeIndex]||e.activeIndex<0?e.activeIndex:0,this._initClickBehavior(),this._createTimerBar(),this._createDialogButtons(),this._createCtrlButtons(),this._createText(),this._createCounter(),this._refreshCounter(),this.toolBox&&this.toolBox.find(".wijmo-wijlightbox-toolbox-button").bind({mouseover:function(){t._addState("hover",r(this))},mouseout:function(){t._removeState("hover",r(this))},mousedown:function(){t._addState("active",r(this))},mouseup:function(){t._removeState("active",r(this))}}),this._groupMode()&&this._createNavButtons(),this._initHoverBehavior(),this.container.width(this.frame.outerWidth()),n.prototype._create.call(this)},i.prototype.destroy=function(){var e=this.options,t=this;this._hideWaiting(),this._hideOverlay(),e.cookie&&this._cookie(null,e.cookie),this.element.find("a").unbind("click"),this.container.remove(),n.prototype.destroy.call(this)},i.prototype._setOption=function(e,t){var r=this.options[e];n.prototype._setOption.call(this,e,t);switch(e){case"groupItems":this.options.activeIndex>=t.length?this.show(t.length-1):this.options.activeIndex<0&&t.length?this.show(0):this.show(this.options.activeIndex);break;case"activeIndex":this.show(t);break;case"textPosition":this._resetText();break;case"clickPause":this._initClickBehavior();break;case"showNavButtons":this._createNavButtons();break;case"showControlsOnHover":this._initHoverBehavior();break;case"controlsPosition":this._set_controlsPosition(r,t);break;case"showCounter":this._createCounter()}},i.prototype._set_controlsPosition=function(e,t){e!==t&&(this._removeCounter(),this._removeNavButtons(),this.container.removeClass("wijmo-wijlightbox-controls-outside wijmo-wijlightbox-controls-inside").addClass("wijmo-wijlightbox-controls-"+t),this._createCounter(),this._createNavButtons())},i.prototype._initClickBehavior=function(){var e=this.options,t=this;this.content.unbind("click"),e.clickPause?this._groupMode()&&this.content.click(function(){t[t.isPlaying()?"stop":"play"]()}):this._groupMode()&&this.content.click(function(n){if(t.isPlaying())return!1;var i=r.extend({},r(this).offset(),{width:r(this).outerWidth(!0),height:r(this).outerHeight(!0)});n.pageX>=i.left&&n.pageX<i.left+i.width/2?t.backBtn.hasAllClasses(e.wijCSS.stateDisabled)||t.back():t.nextBtn.hasAllClasses(e.wijCSS.stateDisabled)||t.next()})},i.prototype._initHoverBehavior=function(){var e=this.options,t=this;this.frame.unbind(".wijlightbox"),e.showControlsOnHover&&this.frame.bind({"mouseenter.wijlightbox":function(){if(t.container.data("moving.wijlightbox"))return!1;t._showAccessories(!0)},"mouseleave.wijlightbox":function(){if(t.container.data("moving.wijlightbox"))return!1;t._hideAccessories(!0)},"mousemove.wijlightbox":function(){t.container.data("moving.wijlightbox")===!1&&t.container.data("accessvisible.wijlightbox")===!1&&t.frame.trigger("mouseenter")}})},i.prototype._getPlugins=function(){var e=this.container.data("plugins.wijlightbox"),t,n,i;return e||(e={},window.navigator.plugins&&window.navigator.plugins.length?(t=[],r.each(window.navigator.plugins,function(e,n){t.push(n.name)}),t=t.join(","),i=t.indexOf("Flip4Mac")>-1,e={fla:t.indexOf("Shockwave Flash")>-1,qt:t.indexOf("QuickTime")>-1,wmp:!i&&t.indexOf("Windows Media")>-1,f4m:i}):(n=function(e){var t;try{t=new ActiveXObject(e)}catch(n){}return!!t},e={fla:n("ShockwaveFlash.ShockwaveFlash"),qt:n("QuickTime.QuickTime"),wmp:n("wmplayer.ocx"),f4m:!1}),this.container.data("plugins.wijlightbox",e)),e},i.prototype._sanitizeSelector=function(e){return e.replace(/:/g,"\\:")},i.prototype._getFragmentId=function(e){var t=/^#.+/,n=r(e).attr("href")||"",i=n.split("#")[0],s=r("base")[0];return i&&(i===window.location.toString().split("#")[0]||s&&i===s.attributes.href)&&(n=e.hash,e.href=n),t.test(n)?this._sanitizeSelector(n):""},i.prototype._parseLink=function(e){var t=this,n=this.options,i=r(e),s={href:undefined,player:undefined,img:undefined,gallery:undefined},o,u,a,f,l=["href","player","title","alt","height","width","gallery","wijvideosrc"];if(i.length>0&&i[0].tagName.toLowerCase()==="a"){o=i.attr("rel"),r.each(l,function(e,t){s[t]=i.attr(t)||""});if(!s.href)return;s.player||(s.player=n.player||t._getPlayerName(s.href)),u=i.find("img"),u&&u.length===0&&(u=i),u&&u.length>=1&&(r.each(["title","alt"],function(e,t){s[t]=u.attr(t)||s[t]}),s.img=u),o&&(a=o.match(/\[(.*?)\]/),a&&(s.gallery=a[1]||s.gallery),r.each(o.split(";"),function(e,t){var n=t.match(/\s*([a-z_]*?)\s*=\s*(.+)\s*/);n&&(s[n[1]]=n[2])})),s.player==="inline"&&(s.href=t._getFragmentId(e)),s.gallery?(f=n.groupItems.length,n.groupItems[f]=s,i.bind({click:function(e){return e.stopPropagation(),e.preventDefault(),t._isDisabled()||t._open(u,f),!1}})):i.bind({click:function(e){return e.stopPropagation(),e.preventDefault(),t._isDisabled()||t._open(u,s),!1}})}},i.prototype._parse=function(){var e=this;this._parseLink(this.element),this.element.find('a[rel^="wijlightbox"], a[rel^="lightbox"]').each(function(t,n){e._parseLink(n)})},i.prototype._showAccessories=function(e){this.container.data("accessvisible.wijlightbox",!0),this._showNavButtons(e),this._showToolboxButtons(e),this._showCounter(e)},i.prototype._hideAccessories=function(e){this.container.data("accessvisible.wijlightbox",!1),this._hideNavButtons(e),this._hideToolboxButtons(e),this._hideCounter(e)},i.prototype._groupMode=function(){var e=this.options;return e.groupItems&&e.groupItems.length>1},i.prototype._resetText=function(){this._removeText(),this._createText()},i.prototype._createText=function(e){var t=this,n=t.options,i,s,o,u,a;if(n.textPosition==="none")return;if(this.container.find(".wijmo-wijlightbox-text").length)return;i=n.textPosition.toLowerCase(),s=r("<div></div>").addClass("wijmo-wijlightbox-text wijmo-wijlightbox-text-"+i+" "+n.wijCSS.content+" "+n.wijCSS.helperClearFix),u=r("<h3></h3>").addClass("wijmo-wijlightbox-title wijmo-wijlightbox-title-"+i+" "+n.wijCSS.helperClearFix).appendTo(s),a=r("<p></p>").addClass("wijmo-wijlightbox-detail wijmo-wijlightbox-detail-"+i+" "+n.wijCSS.helperClearFix).appendTo(s);if(n.textPosition==="inside")s.addClass(n.wijCSS.content+" "+n.wijCSS.helperClearFix).width(this.frame.width()).appendTo(this.frame);else if(n.textPosition==="outside")s.addClass([n.wijCSS.content,n.wijCSS.cornerAll,n.wijCSS.helperClearFix].join(" ")).width(this.frame.width()).appendTo(this.container);else if(n.textPosition==="overlay"||n.textPosition==="titleOverlay")o=r("<div></div>").addClass("wijmo-wijlightbox-mask wijmo-wijlightbox-mask-"+i+" "+n.wijCSS.helperClearFix).width(this.frame.width()).appendTo(this.frame),s.width(this.frame.width()).appendTo(this.frame),n.textPosition==="titleOverlay"&&s.bind({mouseenter:function(){o.stop(),s.stop();var e=u.outerHeight(!0)+a.outerHeight(!0),i=r.extend({},t._defaults.textShowOption,n.textShowOption,{queue:!1});o.animate({height:e},i),s.animate({height:e},i)},mouseleave:function(){o.stop(),s.stop();var e=u.height(),i=r.extend({},t._defaults.textHideOption,n.textHideOption,{queue:!1});o.animate({height:e},i),s.animate({height:e},i)}});this._refreshText(e)},i.prototype._removeText=function(){this.container.find(".wijmo-wijlightbox-text,.wijmo-wijlightbox-mask").remove()},i.prototype._getActiveItem=function(){var e=this.options;return e.groupItems&&e.groupItems.length&&e.activeIndex>=0&&e.activeIndex<e.groupItems.length?e.groupItems[e.activeIndex]:null},i.prototype._refreshText=function(e){var t=this,n=this.options,i,s,o,u,a;if(n.textPosition==="none")return;i=this.container.data("item.wijlightbox")||this._getActiveItem();if(!i)return;s=this.container.find(".wijmo-wijlightbox-text"),o=this.container.find(".wijmo-wijlightbox-title"),u=this.container.find(".wijmo-wijlightbox-detail"),a=this.container.find(".wijmo-wijlightbox-mask"),a.stop(),s.stop(),o.html(i.title),u.html(i.alt),n.textPosition==="outside"&&s.width(this.frame.width());var f=o.outerHeight(!0),l=u.outerHeight(!0),c=r.extend({},t._defaults.textShowOption,n.textShowOption,{queue:!1});if(n.textPosition==="overlay"||n.textPosition==="titleOverlay"){var h=f+(n.textPosition==="overlay"?l:0);s.height(0),a.height(0),s.animate({height:h},c),a.animate({height:h},c)}else e?s.height(f+l):(s.height(0),s.animate({height:f+l},c))},i.prototype._addState=function(e,t){t.is(":not(."+this.options.wijCSS.stateDisabled+")")&&t.addClass("ui-state-"+e)},i.prototype._removeState=function(e,t){t.removeClass("ui-state-"+e)},i.prototype._createNavButtons=function(){var e=this,t=this.options;if(!t.showNavButtons||!this._groupMode()){this._removeNavButtons();return}this.backBtn||(this.backBtn=r("<a href='#'/>").addClass("wijmo-wijlightbox-button wijmo-wijlightbox-button-prev "+t.wijCSS.stateDefault+" "+(t.controlsPosition==="inside"?t.wijCSS.cornerRight:t.wijCSS.cornerLeft)).append("<span class='"+t.wijCSS.icon+" "+t.wijCSS.iconArrowLeft+"'></span>").hide().appendTo(this.frame).bind({click:function(){return r(this).hasAllClasses(t.wijCSS.stateDisabled)||e.back(),!1},mouseover:function(){e._addState("hover",r(this))},mouseout:function(){e._removeState("hover",r(this))},mousedown:function(){e._addState("active",r(this))},mouseup:function(){e._removeState("active",r(this))}})),this.nextBtn||(this.nextBtn=r("<a href='#'/>").addClass("wijmo-wijlightbox-button wijmo-wijlightbox-button-next "+t.wijCSS.stateDefault+" "+(t.controlsPosition==="inside"?t.wijCSS.cornerLeft:t.wijCSS.cornerRight)).append("<span class='"+t.wijCSS.icon+" "+t.wijCSS.iconArrowRight+"'></span>").hide().appendTo(this.frame).bind({click:function(){return r(this).hasAllClasses(t.wijCSS.stateDisabled)||e.next(),!1},mouseover:function(){e._addState("hover",r(this))},mouseout:function(){e._removeState("hover",r(this))},mousedown:function(){e._addState("active",r(this))},mouseup:function(){e._removeState("active",r(this))}}))},i.prototype._removeNavButtons=function(){this.backBtn&&(this.backBtn.remove(),this.backBtn=undefined),this.nextBtn&&(this.nextBtn.remove(),this.nextBtn=undefined)},i.prototype._refreshNavButtons=function(){var e=this.options,t;this.backBtn&&(t=e.activeIndex===0?"addClass":"removeClass",this.backBtn[t](e.wijCSS.stateDisabled)),this.nextBtn&&(t=e.activeIndex>=e.groupItems.length-1?"addClass":"removeClass",this.nextBtn[t](e.wijCSS.stateDisabled))},i.prototype._showNavButtons=function(e){if(this.isPlaying())return;this.container.find(".wijmo-wijlightbox-button").stop(!0,!0).fadeIn(e?600:0,function(){r(this).css("opacity","")})},i.prototype._hideNavButtons=function(e){this.container.find(".wijmo-wijlightbox-button").stop(!0,!0).fadeOut(e?600:0)},i.prototype._createToolbox=function(){this.toolBox||(this.toolBox=r("<div></div>").addClass("wijmo-wijlightbox-toolbox").appendTo(this.frame))},i.prototype._showToolboxButtons=function(e){this.container.find(".wijmo-wijlightbox-toolbox-button").stop(!0,!0).fadeIn(e?600:0,function(){r(this).css("opacity","")})},i.prototype._hideToolboxButtons=function(e){this.container.find(".wijmo-wijlightbox-toolbox-button").stop(!0,!0).fadeOut(e?600:0)},i.prototype._createCtrlButtons=function(){var e=this,t=this.options,n=t.wijCSS;if(!t.ctrlButtons||t.ctrlButtons.length===0||!this._groupMode()){this._removeCtrlButtons();return}this._createToolbox();var i=t.ctrlButtons.split("|");i.length===1&&i[0]===t.ctrlButtons&&(i=t.ctrlButtons.split(",")),r.each(i,function(t,i){i=r.trim(i),i==="play"&&!this.playBtn?e.playBtn=r("<a href='#'/>").addClass(["wijmo-wijlightbox-toolbox-button"," wijmo-wijlightbox-toolbox-button-play ",n.stateDefault,n.cornerAll].join(" ")).append("<span class='"+n.icon+" "+n.iconPlay+"'></span>").hide().click(function(){return e.isPlaying()?e.stop():e.play(),!1}):i==="stop"&&!this.stopBtn&&(e.stopBtn=r("<a href='#'/>").addClass(["wijmo-wijlightbox-toolbox-button","wijmo-wijlightbox-toolbox-button-stop",n.stateDefault,n.stateDisabled,n.cornerAll].join(" ")).append("<span class='"+n.icon+" "+n.iconStop+"'></span>").hide().click(function(){return e.isPlaying()&&(e.stop(),e.show(0)),!1}))}),this.stopBtn&&this.stopBtn.appendTo(this.toolBox),this.playBtn&&this.playBtn.appendTo(this.toolBox)},i.prototype._removeCtrlButtons=function(){this.playBtn&&(this.playBtn.remove(),this.playBtn=undefined),this.stopBtn&&(this.stopBtn.remove(),this.stopBtn=undefined)},i.prototype._refreshCtrlButtons=function(){var e=this.options.wijCSS;if(this.playBtn){var t=this.playBtn.find("."+e.icon);t&&(t.removeClass(e.iconPause+" "+e.iconPlay),t.addClass(this.isPlaying()?e.iconPause:e.iconPlay))}this.stopBtn&&this.stopBtn[this.isPlaying()?"removeClass":"addClass"](e.stateDisabled)},i.prototype._createDialogButtons=function(){var e=this,t=this.options,n;if(!t.dialogButtons||t.dialogButtons.length===0){this._removeDialogButtons();return}this._createToolbox(),n=t.dialogButtons.split("|"),n.length===1&&n[0]===t.dialogButtons&&(n=t.dialogButtons.split(",")),r.each(n,function(n,i){i=r.trim(i),i==="close"&&!this.closeBtn?e.closeBtn=r("<a href='#'/>").addClass("wijmo-wijlightbox-toolbox-button wijmo-wijlightbox-toolbox-button-close "+t.wijCSS.stateDefault+" "+t.wijCSS.cornerAll).append("<span class='"+t.wijCSS.icon+" "+t.wijCSS.iconClose+"'></span>").hide().click(function(){return e._close(),!1}):i==="fullSize"&&!this.fullBtn&&(e.fullBtn=r("<a href='#'/>").addClass("wijmo-wijlightbox-toolbox-button wijmo-wijlightbox-toolbox-button-fullsize "+t.wijCSS.stateDefault+" "+t.wijCSS.cornerAll).append("<span class='"+t.wijCSS.icon+" "+t.wijCSS.iconArrow4Diag+"'></span>").hide().click(function(){return e._toggleFullSize(),!1}))}),this.closeBtn&&this.closeBtn.appendTo(this.toolBox),this.fullBtn&&this.fullBtn.appendTo(this.toolBox),this.btnSep||(this.btnSep=r("<a href='#'/>").addClass("wijmo-wijlightbox-toolbox-separator").appendTo(this.toolBox))},i.prototype._removeDialogButtons=function(){this.closeBtn&&(this.closeBtn.remove(),this.closeBtn=undefined),this.fullBtn&&(this.fullBtn.remove(),this.fullBtn=undefined)},i.prototype._refreshDialogButtons=function(){var e=this.options.wijCSS;if(this.fullBtn){var t=this.fullBtn.find("."+e.icon);t&&(t.removeClass(e.iconArrow4Diag+" "+e.iconNewWin),t.addClass(this._isFullSize()?e.iconNewWin:e.iconArrow4Diag))}},i.prototype._createTimerBar=function(){var e=this,t=e.options;if(!t.showTimer||!e._groupMode()){e._removeTimerBar();return}e._createToolbox(),e.timerBar||(e.timerBar=r("<div></div>").addClass("wijmo-wijlightbox-timerbar "+t.wijCSS.content+" ui-priority-secondary "+t.wijCSS.cornerAll).appendTo(e.toolBox),e.timerMeter=r("<div></div>").addClass("wijmo-wijlightbox-timermeter ui-progressbar-value "+t.wijCSS.content+" "+t.wijCSS.cornerAll).appendTo(e.toolBox))},i.prototype._removeTimerBar=function(){this.timerMeter&&(this.timerMeter.remove(),this.timerMeter=undefined),this.timerBar&&(this.timerBar.remove(),this.timerBar=undefined)},i.prototype._createCounter=function(){var e=this,t=e.options;if(!t.showCounter||!e._groupMode()){e._removeCounter();return}e.counter||(e.counter=r("<div></div>").addClass("wijmo-wijlightbox-counter "+t.wijCSS.stateDefault+" "+(t.controlsPosition==="inside"?t.wijCSS.cornerTL:t.wijCSS.cornerAll)).hide().appendTo(e.frame))},i.prototype._removeCounter=function(){this.counter&&(this.counter.remove(),this.counter=undefined)},i.prototype._refreshCounter=function(e){var t=this,n=this.options,i="";if(!this.counter||!this._groupMode())return;this.counter.empty();if(n.showCounter&&n.groupItems.length>1&&this.counter){e===undefined&&(e=n.activeIndex);var s=n.groupItems.length;if(n.counterType==="sequence"){var o=0,u=s,a=parseInt(n.counterLimit,10)||0;if(a>=2&&a<s){var f=Math.floor(a/2);o=Math.min(u-a,Math.max(o,e-f)),u=Math.min(u,o+a)}while(o!==u)r("<a></a>").addClass("wijmo-wijlightbox-counter-item "+n.wijCSS.content+" "+n.wijCSS.stateDefault+(o===e?" wijmo-wijlightbox-counter-active "+n.wijCSS.stateActive:"")).text((++o).toString()).appendTo(this.counter);this.counter.find("a").click(function(e,n){return r(this).hasClass("wijmo-wijlightbox-counter-active")?!1:(t.show(parseInt(r(this).text(),10)-1),!1)})}else{var l=n.counterFormat||"[i] of [n]";i=l.replace("[i]",e+1),i=i.replace("[n]",s),r("<span></span>").text(i).appendTo(this.counter)}}},i.prototype._showCounter=function(e){this.container.find(".wijmo-wijlightbox-counter").stop(!0,!0).fadeIn(e?600:0,function(){r(this).css("opacity","")})},i.prototype._hideCounter=function(e){this.container.find(".wijmo-wijlightbox-counter").stop(!0,!0).fadeOut(e?600:0)},i.prototype._cookie=function(e,t){var n=this.cookie||(this.cookie=this.options.cookie.name);return r.cookie.apply(null,[n].concat(r.makeArray(arguments)))},i.prototype._showOverlay=function(){if(this.container.data("overlay.wijlightbox"))return;this.container.data("overlay.wijlightbox",new r.wijmo.wijlightbox.overlay(this))},i.prototype._hideOverlay=function(){var e=this.container.data("overlay.wijlightbox");if(!e)return;e.close(),this.container.removeData("overlay.wijlightbox")},i.prototype._hasOverlay=function(){return this.container.hasData("overlay.wijlightbox")},i.prototype._showWaiting=function(){if(this.container.data("waiting.wijlightbox"))return;this.container.data("waiting.wijlightbox",new r.wijmo.wijlightbox.overlay(this,!0))},i.prototype._hideWaiting=function(){var e=this.container.data("waiting.wijlightbox");if(!e)return;e.close(),this.container.removeData("waiting.wijlightbox")},i.prototype._hasWaiting=function(){return this.container.hasData("waiting.wijlightbox")},i.prototype._getUrl=function(e){var t=this.options,n=typeof e=="string"?e:e.href,r=t.rootUrl;return r&&r.length>0&&(r.indexOf("//")===-1&&(r=window.location.protocol+"//"+window.location.host+(r.startsWith("/")?"":"/")+r),r.substr(r.length-1,1)!=="/"&&(r+="/"),n=r+(n.substr(0,1)==="/"?n.substr(1):n)),n},i.prototype._preload=function(){var e=this.options,t;for(t=Math.max(0,e.activeIndex);t<Math.min(e.activeIndex+5,e.groupItems.length);t++)e.groupItems[t].image||(e.groupItems[t].image=new Image,e.groupItems[t].image.src=this._getUrl(e.groupItems[t]))},i.prototype._slideAnimate=function(e,t,n){var i=["position","top","bottom","left","right","width","height"],s=r.setMode(t,e.mode||"show"),o=s==="show",u=e.direction||"left",a=u==="up"||u==="down"?"top":"left",f=u==="up"||u==="left",l,c={};r.save(t,i),t.show(),l=e.distance||t[a==="top"?"outerHeight":"outerWidth"](!0),r.createWrapper(t).css({overflow:"hidden"}),o&&t.css(a,f?isNaN(l)?parseInt("-"+l):-l:l),c[a]=(o?f?"+=":"-=":f?"-=":"+=")+l,t.animate(c,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){s==="hide"&&t.hide(),r.restore(t,i),r.removeWrapper(t),n()}})},i.prototype._slideTo=function(e,t,n,i,s){var o=this.options,u=this,a=e.getElement(),f,l,c,h,p,d,v,m;a.parent().is(".wijmo-wijlightbox-aniwrapper")?f=a.parent():(f=r.createWrapper(a).css({overflow:"hidden"}),f.removeClass("ui-effects-wrapper"),f.addClass("wijmo-wijlightbox-aniwrapper")),f.parent().is(".wijmo-wijlightbox-aniwrapper")?l=f.parent():(l=r.createWrapper(f).css({overflow:"hidden"}),l.removeClass("ui-effects-wrapper"),l.addClass("wijmo-wijlightbox-aniwrapper")),c=o.slideDirection||"horizontal",h=a.outerWidth(),p=a.outerHeight(),c==="horizontal"?(a.width(h).css("float",i?"left":"right"),f.width(2*h).css({left:i?0:-1*h,position:"absolute"})):(a.height(p),f.width(h).css({top:i?0:-1*p,position:"absolute"}).height(2*p)),t.appendTo(f),d=t.getElement(),c==="horizontal"?d.width(h).css("float",i?"left":"right"):d.height(p),this.container.data("animating.wijlightbox",!0),v=function(){a=f.children(":last");while(a.parent().is(".wijmo-wijlightbox-aniwrapper"))a.parent().replaceWith(a);a.css({"float":"",width:"",height:""}),o.autoSize&&!u._isFullSize()?u._resize(s):(r.isFunction(s)&&s.apply(u),u._refreshText())},m={mode:"hide",direction:c==="horizontal"?i?"left":"right":i?"up":"down",easing:n.easing,distance:c==="horizontal"?h:p,duration:n.duration},r.effects?f.effect("slide",m,v):u._slideAnimate(m,f,v)},i.prototype._moveFrom=function(e,t,n){var i=this,s=this.options,o;r.isFunction(t)?(n=t,t=r.extend({},i._defaults.resizeAnimation,s.resizeAnimation)):t=r.extend({},i._defaults.resizeAnimation,s.resizeAnimation,t),i._removeText();if(t.animated==="none"||t.duration<=0){i._createText(),r.isFunction(n)&&n.apply(i),this.container.data("moving.wijlightbox",!1);return}o=r.extend({width:i.frame.width(),height:i.frame.height()},i.container.offset()),i.frame.width(e.width).height(e.height),i.container.css({left:e.left,top:e.top,width:i.frame.outerWidth(),position:"absolute",opacity:""}),i._moveTo(o,t,function(){i.frame.width(o.width),i.container.width(i.frame.outerWidth()),i._createText(),i.container.data("moving.wijlightbox",!1),r.isFunction(n)&&n.apply(i)})},i.prototype._moveTo=function(e,t,n){var i=this,s=this.options;r.isFunction(t)?(n=t,t=r.extend({},i._defaults.resizeAnimation,s.resizeAnimation)):t=r.extend({},i._defaults.resizeAnimation,s.resizeAnimation,t);var o=t.duration/2,u=t.animated,a=i._isOpen(),f=u==="wh"?{left:e.left,top:undefined}:{top:e.top},l=u==="wh"?{top:e.top,left:undefined}:{left:e.left},c=u==="wh"?{width:e.width,height:undefined}:{height:e.height},h=u==="wh"?{height:e.height,width:undefined}:{width:e.width};if(u==="wh"||u==="hw"){a&&i.container.animate(f,{duration:o,easing:t.easing,queue:!0}),i.frame.animate(c,{duration:o,easing:t.easing,complete:function(){a&&i.container.animate(l,{duration:o,easing:t.easing,queue:!0}),i.frame.animate(h,{duration:o,easing:t.easing,complete:function(){i.container.data("moving.wijlightbox",!1),r.isFunction(n)&&n.apply(i)}})}});return}a&&i.container.animate({left:e.left,top:e.top},{duration:t.duration,easing:t.easing,queue:!0}),i.frame.animate({width:e.width,height:e.height,opacity:1},{duration:t.duration,easing:t.easing,complete:function(){i.container.data("moving.wijlightbox",!1),r.isFunction(n)&&n.apply(i)}})},i.prototype.show=function(e){return this._show(e),this},i.prototype._resize=function(e){var t=this,n=r.extend({},t.container.offset(),{width:t.frame.width(),height:t.frame.height()});t._size(),t._isOpen()&&t._position(),t._moveFrom(n,e)},i.prototype._onAfterShow=function(){var e=this,t=this.options,n;e._refreshNavButtons(),e.container.data("animating.wijlightbox",!1),t.modal||e._hideOverlay(),n={index:t.activeIndex,item:t.groupItems[t.activeIndex]},e._trigger("show",null,n),e._startTimer()},i.prototype._show=function(e,t,n){var i=this,s=this.options,o,u;if(this.container.data("showing.wijlightbox"))return o=[function(){i._show(e,t,n)}],this.container.queue("showqueue",o),this;u=s.activeIndex;if(!r.isPlainObject(e)){u=e;if(u<0||u>=s.groupItems.length)return this;e=s.groupItems[u]}e&&this.container.data("item.wijlightbox",e),this._groupMode()&&this._preload(),r.isFunction(t)&&(n=t,t=undefined),n||(n=i._onAfterShow);var a={index:u,item:e};if(i._trigger("beforeShow",null,a)===!1)return this;this.container.data("showing.wijlightbox",!0);var f=function(){r.isFunction(n)&&n.apply(i),i.container.data("showing.wijlightbox",!1),i.container.dequeue("showqueue"),i.container.clearQueue("showqueue")};i._refreshCounter(u);var l=this.container.data("player.wijlightbox"),c,h=function(){i.container.data("playerwidth.wijlightbox",c.width),i.container.data("playerheight.wijlightbox",c.height);var e=r.extend({},i._defaults.transAnimation,s.transAnimation);if(s.activeIndex===u||e.animated==="none"||e.duration<=0||!i._isOpen()){s.activeIndex=u,l&&l.remove(),c.appendTo(i.content),i._refreshText(),f();return}s.cookie&&i._cookie(s.activeIndex,s.cookie);if(e.animated==="slide")t=t===undefined?u>s.activeIndex:t,i._slideTo(l,c,e,t,f),s.activeIndex=u;else{s.activeIndex=u;var n=function(){c&&(c.appendTo(i.content,!0),c.fadeIn(e.duration,f))};r.browser.msie&&i.frame.trigger("mouseleave");var o=function(){l&&l.remove(),s.autoSize&&!i._isFullSize()?i._resize(n):(n(),i._refreshText())};l?l.fadeOut(e.duration*.4,o):o()}};return c=this._createPlayer(e,h),this},i.prototype.next=function(){var e=this.options;if(!this._groupMode())return!1;var t=e.activeIndex+1;return e.loop&&(t%=e.groupItems.length),t<e.groupItems.length?(this._show(t,!0),!0):!1},i.prototype.back=function(){var e=this.options;if(!this._groupMode())return!1;var t=e.activeIndex-1;return e.loop&&(t=t<0?e.groupItems.length-1:t),t>=0?(this._show(t,!1),!0):!1},i.prototype.adjustPosition=function(){this._position()},i.prototype.isPlaying=function(){return!!this.container.data("playing.wijlightbox")},i.prototype._startTimer=function(){if(!this.isPlaying()||!this._groupMode())return;var e=this.options,t=this,n;e.showTimer===!0?(this.timerMeter||this._createTimerBar(),n=this.timerBar.width(),t.timerMeter.width("0"),t.timerMeter.animate({width:n},e.delay,null,function(){t.isPlaying()&&!t.next()&&t.stop()})):window.setTimeout(function(){t.isPlaying()&&!t.next()&&t.stop()},e.delay)},i.prototype.play=function(){var e=this.options;if(!this._groupMode())return!1;this.container.data("playing.wijlightbox")||this.container.data("playing.wijlightbox",!0),this._refreshCtrlButtons(),this._hideNavButtons(),e.activeIndex>=e.groupItems.length-1?this._show(0):this._startTimer()},i.prototype.stop=function(){this.container.removeData("playing.wijlightbox"),this._refreshCtrlButtons(),this._removeTimerBar()},i.prototype._size=function(e,t){var n=this.options,i=n.width,s=n.height,o=n.autoSize?this.container.data("playerwidth.wijlightbox")||i:i,u=n.autoSize?this.container.data("playerheight.wijlightbox")||s:s,a,f=u/o;if(typeof e=="boolean")t=e;else if(r.isPlainObject(e)&&"width"in e&&"height"in e)i=e.width,s=e.height;else{a=this.container.data("player.wijlightbox"),n.autoSize&&a&&a.name==="img"&&(o>i&&(o=i,u=Math.round(i*f)),u>s&&(u=s,o=Math.round(s/f))),i=o,s=u;if(t)return{width:i,height:s}}this.frame.width(i).height(s),this.container.width(this.frame.outerWidth(!0))},i.prototype._position=function(){var e=this.options,t=[],n=[0,0],i,s=e.position;if(s){if(typeof s=="string"||typeof s=="object"&&"0"in s)t=s.split?s.split(" "):[s[0],s[1]],t.length===1&&(t[1]=t[0]),r.each(["left","top"],function(e,r){+t[e]===t[e]&&(n[e]=t[e],t[e]=r)}),s={my:t.join(" "),at:t.join(" "),offset:n.join(" ")};s=r.extend({},e.position,s)}i=this.container.is(":visible"),i||this.container.show(),this.container.css({top:0,left:0}).position(s),i||this.container.hide()},i.prototype._getRelRect=function(e){var t;return e&&(r.isPlainObject(e)&&"left"in e&&"top"in e&&"width"in e&&"height"in e?t=r.merge({},e):e=r(e),e.jquery&&e.length&&(t=r.extend({},e.offset(),{width:e.width(),height:e.height()}))),t},i.prototype._close=function(e){var t=this.options,n=this,i,s,o;if(!this._isOpen())return;s={rel:e};if(!1===this._trigger("beforeClose",null,s))return;e=s.rel,!e&&this._groupMode()&&(e=t.groupItems[t.activeIndex].img),this.container.data("moving.wijlightbox",!0),this._hideAccessories(!1),this._hideWaiting(),this._hideOverlay(),this.stop(),o=function(){n._removePlayer(),n.container.hide(),n._trigger("close"),n.container.unbind("keypress.wijlightbox"),n.container.removeData("open.wijlightbox").removeData("rect.wijlightbox").removeData("moving.wijlightbox").removeData("fullsize.wijlightbox"),r(document).unbind("keydown.wijlightbox").unbind("click.wijlightbox")},i=this._getRelRect(e),i||this.container.data("rect.wijlightbox")&&(i=this.container.data("rect.wijlightbox")),this._removeText();if(i){this._moveTo(i,{animated:"sync",duration:200},o);return}return o.call(),this},i.prototype._isOpen=function(){return!!this.container.data("open.wijlightbox")},i.prototype._open=function(e,t){if(this._isOpen())return;var n=this.options,i=this;this.toolBox&&(this._isFullSize()?this.toolBox.css({top:"2px",right:"4px"}):this.toolBox.css({top:"",right:""}));var s=function(){n.modal&&i._showOverlay(),n.showControlsOnHover?this._hideAccessories(!1):this._showAccessories(!1);var t=i._getRelRect(e);i.container.css("opacity",0),i.container.show(),i._size(),i._createText(!0),i._refreshText(!0),i._position(),i.container.data("open.wijlightbox",!0);if(e&&t)i.container.data("rect.wijlightbox",t),i._moveFrom(t,{animated:"sync"});else{var s=r.extend({},i._defaults.transAnimation,n.transAnimation);s.animated==="fade"?(i.container.hide(),i.container.fadeIn(s.duration,function(){i._createText()})):i._createText(),this.container.data("moving.wijlightbox",!1)}r(document).bind("keydown.wijlightbox",r.proxy(i,"_keyDownHandler")).bind("click.wijlightbox",function(e){var t=e.target||e.srcElement;i._isOpen()&&!!n.closeOnOuterClick&&t!==i.container.get(0)&&r(t).parents().index(i.container)<0&&i._close()}),n.autoPlay&&this.play(),i._refreshNavButtons(),i._refreshDialogButtons();var o={index:n.activeIndex,item:n.groupItems[n.activeIndex]};i._trigger("show",null,o),i._trigger("open")};return this.container.data("moving.wijlightbox",!0),this._show(t,!0,s),this},i.prototype._getWinRect=function(){var e=r(window);return r.extend({width:e.width(),height:e.height()},e.offset()||{left:2,top:2})},i.prototype._resizeHandler=function(){var e=this;e._removeText(),e._size(e._getWinRect()),e._createText()},i.prototype._isFullSize=function(){return!!this.container.data("fullsize.wijlightbox")},i.prototype._toggleFullSize=function(){var e=this,t=r(window);if(!e._isOpen())return;if(this._isFullSize())e.toolBox&&e.toolBox.css({top:"",right:""}),this.container.data("fullsize.wijlightbox",!1),t.unbind("resize.wijlightbox",r.proxy(this,"_resizeHandler")),e._resize(function(){e._adjustPlayerSize(e.content.innerWidth(),e.content.innerHeight())});else{this.container.data("fullsize.wijlightbox",!0),t.bind("resize.wijlightbox",r.proxy(this,"_resizeHandler"));var n=e._getWinRect(),i=this.frame.borderSize();n.width-=i.width,n.height-=i.height,e._removeText(),e._moveTo(n,{animated:"sync"},function(){e.toolBox&&e.toolBox.css({top:"2px",right:"4px"}),e.frame.width(n.width),e.container.width(e.frame.outerWidth()),e._createText(),e._adjustPlayerSize(e.content.innerWidth(),e.content.innerHeight())})}this._refreshDialogButtons()},i.prototype._getExt=function(e){var t,n,r=/[0-9a-z]+$/i,i=e.indexOf("?");return i>-1&&(e=e.substring(0,i)),n=e.match(r),n&&(t=n[0].toLowerCase()),t},i.prototype._getPlayerName=function(e){if(e.indexOf("#")===0||e.indexOf("#")>0&&e.indexOf(document.location.href)===0)return"inline";var t=["bmp","gif","jpg","jpeg","png"],n=["swf"],i=["flv","m4v"],s=["dv","mov","moov","movie","mp4","avi","mpg","mpeg"],o=["asf","avi","mpg","mpeg","wm","wmv"],u=["mp4","mpg","mpeg","ogg","ogv"],a=this._getExt(e);if(a){if(r.inArray(a,t)>=0)return"img";if(r.inArray(a,n)>=0)return"swf";if(r.inArray(a,i)>=0)return"flv";if(r.inArray(a,o)>=0)return"wmp";if(r.inArray(a,s)>=0)return"qt";if(r.inArray(a,u)>=0)return"wijvideo"}return"iframe"},i.prototype._adjustPlayerSize=function(e,t){var n=this.container.data("player.wijlightbox");n&&n.adjustSize&&n.adjustSize(e,t)},i.prototype._removePlayer=function(){var e=this.container.data("player.wijlightbox");e&&(e.remove(),this.container.data("player.wijlightbox",null))},i.prototype._createPlayer=function(e,t,n){var i=e.player;if(!r.isFunction(r.wijmo.wijlightbox[i]))throw"unknown player "+i;var s=this,o=!1,u,a=function(){o=!0,this._hideWaiting(),r.isFunction(t)&&window.setTimeout(function(){t.apply(s)},1)},f=function(){this._hideWaiting(),r.isFunction(n)&&n.apply(s)};return u=new r.wijmo.wijlightbox[i](this,e,a,f),this.container.data("player.wijlightbox",u),window.setTimeout(function(){o===!1&&s._showWaiting()},200),u},i}(t.wijmoWidget);n.wijlightbox=s;var o=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn ui-btn-a",stateHover:"ui-btn-down-a",stateActive:"ui-btn-down-a",iconPlay:"ui-icon-arrow-r",iconPause:"ui-icon-grid"},this.initSelector=":jqmData(role='wijlightbox')",this.textPosition="overlay",this.width=600,this.height=400,this.autoSize=!0,this.player="",this.groupItems=null,this.rootUrl="",this.ctrlButtons="",this.dialogButtons="close",this.counterType="default",this.counterFormat="[i] of [n]",this.counterLimit=10,this.showCounter=!0,this.showNavButtons=!0,this.showTimer=!1,this.controlsPosition="inside",this.showControlsOnHover=!0,this.clickPause=!1,this.keyNav=!1,this.modal=!1,this.position={my:"center",at:"center",of:window,collision:"fit",using:function(e){var t=r(this);t.css(e);var n=t.offset().top;n<0&&t.css("top",e.top-n)}},this.zIndex=1e3,this.closeOnEscape=!0,this.closeOnOuterClick=!0,this.autoPlay=!1,this.delay=2e3,this.loop=!0,this.cookie=null,this.transAnimation={animated:"fade",duration:400,easing:"linear"},this.slideDirection="horizontal",this.resizeAnimation={animated:"sync",duration:400},this.textShowOption={duration:300,easing:"linear"},this.textHideOption={duration:300,easing:"linear"},this.showMovieControls=!0,this.autoPlayMovies=!0,this.flashParams={bgcolor:"#000000",allowfullscreen:!0},this.flashVars={},this.flashVersion="9.0.115",this.flvPlayer="player\\player.swf",this.flashInstall="player\\expressInstall.swf",this.beforeShow=null,this.show=null,this.open=null,this.beforeClose=null,this.close=null}return e}();s.prototype.options=r.extend(!0,{},t.wijmoWidget.prototype.options,new o),r.wijmo.registerWidget("wijlightbox",s.prototype),r.extend(r.wijmo.wijlightbox,{img:function(e,t,n,i){this.name="img",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t);var s=this;r("<img></img>").css({width:"auto",height:"auto",display:"none"}).appendTo(document.body).bind({load:function(){var i=r(this);s.width=t.width?parseInt(t.width,10):i.width(),s.height=t.height?parseInt(t.height,10):i.height(),i.remove(),n&&r.isFunction(n)&&n.apply(e)},error:function(){r(this).remove(),i&&r.isFunction(i)&&i.apply(e)}}).attr("src",this.url)},swf:function(e,t,n,i){this.name="swf";var s=e.options;this.id="flashhost",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t),this.width=t.width?parseInt(t.width,10):s.width,this.height=t.height?parseInt(t.height,10):s.height,n&&r.isFunction(n)&&n.apply(e)},iframe:function(e,t,n,i){this.name="swf",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t),t.width&&(this.width=parseInt(t.width,10)),t.height&&(this.height=parseInt(t.height,10)),this.$iframe=r("<iframe></iframe>").addClass("wijmo-wijlightbox-iframe").attr({frameborder:"0",marginwidth:"0",marginheight:"0",scrolling:"auto",allowtransparency:"true"}).hide().appendTo(e.content).bind("load",function(){n&&r.isFunction(n)&&n.apply(e)}).attr("src",this.url)},inline:function(e,t,n,i){this.name="inline";var s=e.options,o=s.wijCSS,u="wijmo-wijlightbox-frame "+o.content;" "+o.cornerAll+" "+o.helperClearFix,this.lightbox=e,this.item=t,this.width=t.width?parseInt(t.width,10):s.width;if(t.height)this.height=parseInt(t.height,10);else{var a=r(this.item.href).clone().show().append('<br clear="all" />').wrap('<div class="wijmo-wijlightbox '+o.widget+'">'+'<div class="'+u+'">'+'<div class="'+u+'">'+'<div class="wijmo-wijlightbox-content"> '+"</div></div></div></div>").appendTo(document.body).width(this.width);this.height=a.outerHeight(!0)+10,a.unwrap(),a.remove()}n&&r.isFunction(n)&&n.apply(e)},flv:function(e,t,n,i){this.name="flv";var s=e.options;this.id="flvhost",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t);var o=20;this.width=t.width?parseInt(t.width,10):s.width,this.height=t.height?parseInt(t.height,10):s.height,s.showMovieControls&&(this.height+=o),n&&r.isFunction(n)&&n.apply(e)},wmp:function(e,t,n,i){var s=e.options,o;this.name="wmp",this.id="wmphost",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t),o=r.browser.msie?70:45,this.width=t.width?parseInt(t.width,10):s.width,this.height=t.height?parseInt(t.height,10):s.height,s.showMovieControls&&(this.height+=o),n&&r.isFunction(n)&&n.apply(e)},qt:function(e,t,n,i){var s=e.options,o=16;this.name="qt",this.id="qthost",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t),this.width=t.width?parseInt(t.width,10):s.width,this.height=t.height?parseInt(t.height,10):s.height,s.showMovieControls&&(this.height+=o),n&&r.isFunction(n)&&n.apply(e)},wijvideo:function(e,t,n,i){var s=e.options;this.name="wijvideo",this.id="wijvideohost",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t),this.wijvideosrc=!t.wijvideosrc||t.wijvideosrc===""?null:this.lightbox._getUrl(t.wijvideosrc),this.width=t.width?parseInt(t.width,10):s.width,this.height=t.height?parseInt(t.height,10):s.height,n&&r.isFunction(n)&&n.apply(e)}}),r.extend(r.wijmo.wijlightbox.img.prototype,{appendTo:function(e,t){this.$element=r("<img></img>").addClass("wijmo-wijlightbox-image").attr("src",this.url),t&&this.$element.hide(),this.lightbox.options.transAnimation&&this.lightbox.options.transAnimation.animated=="fade"?(e.children().length&&e.empty(),this.$element.prependTo(e)):this.$element.appendTo(e)},remove:function(){this.$element&&this.$element.remove()},fadeOut:function(e,t){this.$element&&this.$element.fadeOut(e,t)},fadeIn:function(e,t){this.$element&&this.$element.fadeIn(e,t)},getElement:function(){return this.$element}}),r.extend(r.wijmo.wijlightbox.swf.prototype,{appendTo:function(e){this.$container=r("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).attr("id",this.id).appendTo(e);var t=this.lightbox.options,n=t.flashInstall,i=t.flashVersion,s=t.flashVars,o=t.flashParams;S.flash.embedSWF(this.item.href,this.id,"100%","100%",i,n,s,o)},remove:function(){S.flash.expressInstallCallback(),S.flash.removeSWF(this.id),this.$container.remove()},fadeOut:function(e,t){this.$container&&this.$container.fadeOut(e,t)},fadeIn:function(e,t){this.$container&&this.$container.fadeIn(e,t)},getElement:function(){return this.$container}}),r.extend(r.wijmo.wijlightbox.iframe.prototype,{appendTo:function(e,t){t||this.$iframe.show()},remove:function(){this.$iframe&&this.$iframe.remove()},fadeOut:function(e,t){this.$iframe&&this.$iframe.fadeOut(e,t)},fadeIn:function(e,t){this.$iframe&&this.$iframe.fadeIn(e,t)},getElement:function(){return this.$iframe}}),r.extend(r.wijmo.wijlightbox.inline.prototype,{appendTo:function(e,t){this.$element=r(this.item.href).clone().appendTo(e),t||this.$element.show()},remove:function(){this.$element&&this.$element.remove()},fadeOut:function(e,t){this.$element&&this.$element.fadeOut(e,t)},fadeIn:function(e,t){this.$element&&this.$element.fadeIn(e,t)},getElement:function(){return this.$element}}),r.extend(r.wijmo.wijlightbox.flv.prototype,{appendTo:function(e){this.$container=r("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).attr("id",this.id).appendTo(e);var t=this.lightbox.options,n="100%",i="100%",s=t.flvPlayer,o=t.flashInstall,u=t.flashVersion,a=r.extend({file:this.url,width:n,height:i,autostart:t.autoPlayMovies?"true":"false",controlbar:t.showMovieControls?"bottom":"none",backcolor:"0x000000",frontcolor:"0xCCCCCC",lightcolor:"0x557722"},t.flashVars),f=r.extend({autostart:t.autoPlayMovies?"true":"false",allowscriptaccess:"always"},t.flashParams);S.flash.embedSWF(s,this.id,n,i,u,o,a,f)},remove:function(){S.flash.expressInstallCallback(),S.flash.removeSWF(this.id),this.$container.remove()},fadeOut:function(e,t){this.$container&&this.$container.fadeOut(e,t)},fadeIn:function(e,t){this.$container&&this.$container.fadeIn(e,t)},getElement:function(){return this.$container}}),r.extend(r.wijmo.wijlightbox.wmp.prototype,{appendTo:function(e){this.$container=r("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).appendTo(e);var t=this.lightbox.options,n='<object id="'+this.id+'" name="'+this.id+'" height="'+this.height+'" width="'+this.width+'"',i={autostart:t.autoPlayMovies?1:0,url:undefined,uimode:undefined,showcontrols:undefined},s;r.browser.msie?(n+=' classid="clsid:6BF52A52-394A-11d3-B153-00C04F79FAA6"',i.url=this.url,i.uimode=t.showMovieControls?"full":"none"):(n+=' type="video/x-ms-wmv"',n+=' data="'+this.url+'"',i.showcontrols=t.showMovieControls?1:0),n+=">";for(s in i)n+='<param name="'+s+'" value="'+i[s]+'">';n+="</object>",this.$container.html(n)},remove:function(){if(r.browser.msie)try{window[this.id].controls.stop(),window[this.id].URL="movie"+now()+".wmv",window[this.id]=function(){}}catch(e){}this.$container.remove()},fadeOut:function(e,t){this.$container&&this.$container.fadeOut(e,t)},fadeIn:function(e,t){this.$container&&this.$container.fadeIn(e,t)},getElement:function(){return this.$container}}),r.extend(r.wijmo.wijlightbox.qt.prototype,{appendTo:function(e,t){this.$container=r("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).appendTo(e);var n=this.lightbox.options,i=n.autoPlayMovies?"true":"false",s=n.showMovieControls?"true":"false",o=r.browser.msie?"<object":"<embed",u={id:this.id,name:this.id,width:this.width,height:this.height,kioskmode:"true",classid:undefined,codebase:undefined,type:undefined,src:undefined,autoplay:undefined,controller:undefined},a,f;r.browser.msie?(u.classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B",u.codebase="http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0"):(u.type="video/quicktime",u.src=this.url,u.autoplay=i,u.controller=s);for(a in u)u[a]&&(o+=" "+a+'="'+u[a]+'"');o+=">";if(r.browser.msie){var l={src:this.url,scale:"aspect",controller:s,autoplay:i};for(f in l)o+='<param name="'+f+'" value="'+l[f]+'">'}o+=r.browser.msie?"</object>":"</embed>",t&&e.hide(),this.$container.html(o),t&&e.show()},remove:function(){try{document[this.id].Stop(),document[this.id]=null}catch(e){}this.$container.remove()},fadeOut:function(e,t){t.call();return},fadeIn:function(e,t){t.call();return},getElement:function(){return this.$container}}),r.extend(r.wijmo.wijlightbox.wijvideo.prototype,{appendTo:function(e){var t=this.lightbox.options;this.$container=r("<video/>").css({overflow:"hidden"}).attr({width:this.width,height:this.height,autoPlay:t.autoPlayMovies?"true":"false",controls:t.showMovieControls?"controls":""}).appendTo(e),!this.url||r("<source/>").attr({src:this.url}).appendTo(this.$container),!this.wijvideosrc||r("<source/>").attr({src:this.wijvideosrc}).appendTo(this.$container),this.$container.wijvideo({fullScreenButtonVisible:!1})},remove:function(){this.$container.remove()},fadeOut:function(e,t){this.$container&&this.$container.fadeOut(e,t)},fadeIn:function(e,t){this.$container&&this.$container.fadeIn(e,t)},getElement:function(){return this.$container},adjustSize:function(e,t){this.$container.wijvideo("setWidth",e),this.$container.wijvideo("setHeight",t)}}),r.extend(r.wijmo.wijlightbox,{overlay:function(e,t){this.mask=r("<div></div>").addClass(e.options.wijCSS.overlay+" wijmo-wijlightbox-overlay"+(t?" wijmo-wijlightbox-waitingoverlay":"")).appendTo(document.body).css({width:this.width(),height:this.height()}).bind("click",function(){return e.options.closeOnOuterClick&&e._close(),!1}),r.fn.bgiframe&&this.mask.bgiframe();if(t){this.mask.css("z-index",this.zIndex);var n=r("<div></div>").addClass("wijmo-wijlightbox-waiting").css("z-index",this.zIndex+1).appendTo(this.mask);n.css({left:(this.mask.width()-n.width())/2,top:(this.mask.height()-n.height())/2})}r(window).bind("resize.wijlightbox-overlay",r.proxy(this,"resize")),window.setTimeout(function(){var e;this.mask&&(e=r.wijmo.wijlightbox.overlay,r(document).bind(e.events,function(t){if(r(t.target).zIndex()<e.zIndex)return!1}))},1)}}),r.extend(r.wijmo.wijlightbox.overlay.prototype,{mask:null,zIndex:1e3,events:r.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(e){return e+".wijlightbox-overlay"}).join(" "),close:function(){r(document).unbind(".wijlightbox-overlay"),r(window).unbind(".wijlightbox-overlay"),this.mask.remove(),this.mask=undefined},height:function(){var e,t;return r.browser.msie&&parseInt(r.browser.version)<7?(e=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),t=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),e<t?r(window).height():e):r(document).height()},width:function(){var e,t;return r.browser.msie&&parseInt(r.browser.version)<7?(e=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),t=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),e<t?r(window).width():e):r(document).width()},resize:function(){this.mask&&this.mask.css({width:this.width(),height:this.height()})}})})(t.lightbox||(t.lightbox={}));var n=t.lightbox})(wijmo||(wijmo={}))});