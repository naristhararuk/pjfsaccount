var wijmo;define(["globalize","./wijmo.widget","./wijmo.wijsuperpanel","./wijmo.wijutil","jquery.bgiframe"],function(){var e=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};(function(t){(function(n){var r=jQuery,i="wijmenu",s=function(n){function i(){n.apply(this,arguments)}return e(i,n),i.prototype._preventEvent=function(e){e.preventDefault(),e.stopImmediatePropagation()},i.prototype._initState=function(){var e=this;e.options.items||(e.options.items=[])},i.prototype._create=function(){var e=this,t=e.options,r=e.element;e._initState(),r.is(":hidden")&&r.wijAddVisibilityObserver&&r.wijAddVisibilityObserver(function(){e.refresh(),r.wijRemoveVisibilityObserver&&r.wijRemoveVisibilityObserver()},"wijmenu"),r.data("wijmomenu",e.widgetFullName),e.clickNameSpace="click.wijmenudoc"+e._newId(),r.hide(),e.cssPre="wijmo-wijmenu",e.nowIndex=9999,e.activeItem=null,e.refresh(),r.attr("tabIndex",0),e._bindKeyDownEvent(),n.prototype._create.call(this)},i.prototype._bindKeyDownEvent=function(){var e=this,n=e.options,r=n.direction,s=n.mode,o=t.getKeyCodeEnum(),u,a;e.element.on("keydown.wijmenuEvent",function(t){if(e._isDisabled())return;s==="sliding"&&e._getSublist().stop(!0,!0);var f=e.activeItem,l,c,h=n.orientation;f?(l=f._isRoot(),u=f._getSublist()):l=!0;switch(t.keyCode){case o.PAGE_UP:e.previousPage(t),e._preventEvent(t);break;case o.PAGE_DOWN:e.nextPage(t),e._preventEvent(t);break;case o.UP:if(h==="vertical"||s==="sliding"||!l)e.previous(t),e._preventEvent(t);break;case o.DOWN:h==="vertical"||s==="sliding"||!l?(e.next(t),e._preventEvent(t)):f&&s==="flyout"&&i._hasVisibleSubMenus(f)&&u.is(":hidden")&&f._showFlyoutSubmenu(t,function(){e.activate(t,f._getFirstSelectableSubItem())});break;case o.RIGHT:h==="horizontal"&&l&&s==="flyout"?(r==="rtl"?e.previous(t):e.next(t),e._preventEvent(t)):f&&(a=f.getParent(),r==="rtl"?e._keyDownToCloseSubmenu(s,t,a):e._keyDownToOpenSubmenu(f,s,t,u));break;case o.LEFT:h==="horizontal"&&l&&s==="flyout"?(r==="rtl"?e.next(t):e.previous(t),e._preventEvent(t)):(f&&(a=f.getParent()),r==="rtl"?e._keyDownToOpenSubmenu(f,s,t,u):e._keyDownToCloseSubmenu(s,t,a));break;case o.ENTER:if(!f)return;c=f._getLink();if(s==="flyout")break;e.select(),c.is("a")&&c.attr("href")==="#"&&e._preventEvent(t);break;case o.TAB:e.next(t),e._preventEvent(t)}})},i.prototype._keyDownToOpenSubmenu=function(e,t,n,r){var s=this;t==="flyout"&&i._hasVisibleSubMenus(e)?r.is(":hidden")&&e._showFlyoutSubmenu(n,function(){s.activate(n,e._getFirstSelectableSubItem())}):t==="sliding"&&r.length>0&&e._getLink().trigger("click",e._getFirstSelectableSubItem())},i.prototype._keyDownToCloseSubmenu=function(e,t,n){var i=this,s=i.options,o;e==="flyout"?n&&(n._hideCurrentSubmenu(t),i.activate(t,n)):(s.backLink&&i._backLink&&i._backLink.is(":visible")&&i._backLink.trigger("click",function(){n&&i.activate(t,n)}),o=r("."+s.wijCSS.wijmenuBreadcrumb,i.domObject.menucontainer).find("li a"),o.length>0&&o.eq(o.length-2).trigger("click",function(){n&&i.activate(t,n)}))},i.prototype._createMenuItems=function(){var e=this,t=[],n=e.options,s=e.options.items.length,o=e._getSublist().children("li").length,u,a,f;for(u=0;u<s-o;u++)e._getSublist().append("<li>");return n.ensureSubmenuOnBody&&n.mode==="flyout"&&(e._submenuContainer=r("<div>").addClass(n.wijCSS.helperReset).addClass(n.wijCSS.widget).addClass(n.wijCSS.header).addClass(n.wijCSS.wijmenu).addClass(n.wijCSS.wijmenuSubmenuContainer),n.orientation==="horizontal"&&n.mode==="flyout"&&e._submenuContainer.addClass(n.wijCSS.wijmenuHorizontal),f=r("<ul>").addClass(n.wijCSS.wijmenuList).addClass(n.wijCSS.helperReset).data(e.widgetFullName,e).data("wijmomenu",e.widgetFullName)),r(">li",e._getSublist()).each(function(s,o){var u=r(this),l=i._getMenuItemOptions(n,s),c,h;return a=e._createItemWidget(u,l),t.push(a),n.items[s]=a.options,n.ensureSubmenuOnBody&&n.mode==="flyout"&&(h=a._getSublist(),e._bindMousehoverEvent(h),h.children().length>0&&(c=r("<li>").addClass(n.wijCSS.widget).addClass(n.wijCSS.wijmenuItem).addClass(n.wijCSS.stateDefault).addClass(n.wijCSS.cornerAll).addClass(n.wijCSS.wijmenuParent).addClass(n.wijCSS.header).append(h),r(c).appendTo(f))),n.ensureSubmenuOnBody&&n.mode==="flyout"&&r(e._submenuContainer).append(f).appendTo("body"),this}),t},i.prototype._createItemWidget=function(e,t){var n=i._itemWidgetName;return r.fn[n]&&e[n](t),i._getItemWidget(e)},i.prototype._handleDisabledOption=function(e,t){var n=this;e?(n.disabledDiv||(n.disabledDiv=n._createDisabledDiv(t)),n.disabledDiv.appendTo(n.domObject.menucontainer)):n.disabledDiv&&(n.disabledDiv.remove(),n.disabledDiv=null)},i.prototype._createDisabledDiv=function(e){return r("<div></div>").addClass(this.options.wijCSS.stateDisabled).css({"z-index":"999",position:"absolute",width:"100%",height:"100%",left:0,top:0,"background-color":"lightgray"})},i.prototype._innerDestroy=function(){var e=this,t=e.options;e.destroying=!0,e[t.mode==="flyout"?"_killFlyout":"_killDrilldown"](),e._killMenuItems(),e._killtrigger(),e._killElement(),t.ensureSubmenuOnBody&&t.mode==="flyout"&&e._submenuContainer&&e._submenuContainer.remove(),e.destroying=!1},i.prototype.destroy=function(){var e=this;e._handleDisabledOption(!1,e.domObject.menucontainer),e._innerDestroy(),n.prototype.destroy.call(this)},i.prototype.activate=function(e,t){if(!t)return;var n=this,r=n.options,s=n.domObject.scrollcontainer,o,u,a=!1,f=!0;o=(t.jquery?t:t.element).eq(0);if(n.activeItem&&n.activeItem.element.get(0)===o.get(0))return;n.deactivate(e),n.activeItem=i._getItemWidget(o),u=o.children(":first"),n._trigger("focus",e,{item:n.activeItem}),n.options.mode==="sliding"&&(f=o.parent().is("."+r.wijCSS.wijmenuCurrent),a=f&&n._hasScroll()&&s.wijsuperpanel("needToScroll",o),a&&(n._linkContainer.link=u,n._linkContainer.needToFocus=!0,s.wijsuperpanel("scrollChildIntoView",o))),u.addClass(r.wijCSS.stateFocus).end(),u.attr("id")||(u.attr("id",this._newId()),u.data("generatedID",!0)),n.element.attr("aria-activedescendant",u.attr("id")),f&&!a&&u.is("a")&&u.focus()},i.prototype.deactivate=function(e){var t=this,n=t.options,r=t.activeItem;if(!r)return;t.element.removeAttr("aria-activedescendant"),setTimeout(function(){r._getLink().removeClass(n.wijCSS.stateFocus),r._getLink().data("generatedID")&&r._getLink().removeAttr("id"),t._trigger("blur")},0),t.activeItem=null},i.prototype.next=function(e){this._move("next",function(e){return e._getFirstSelectableSubItem()},e)},i.prototype.previous=function(e){this._move("previous",function(e){return e._getLastSelectableSubItem()},e)},i.prototype.first=function(){var e=this,t,n,r;return e.activeItem?(t=e._getActiveItemElement(),n=e.activeItem._getParentOrMenu(),r=n._getFirstSelectableSubItem(),r&&t[0]===r.element[0]):!1},i.prototype.last=function(){var e=this,t,n,r;return e.activeItem?(t=e._getActiveItemElement(),n=e.activeItem._getParentOrMenu(),r=n._getLastSelectableSubItem(),r&&t[0]===r.element[0]):!1},i.prototype.nextPage=function(e){var t=this,n=t._getActiveItemElement(),s,o,u,a,f;n?a=t.activeItem._getParentOrMenu():(a=t,f=t._getFirstSelectableSubItem(),n=f&&f.element);if(t.options.mode==="sliding"&&t._hasScroll()){if(!n||t.last()){t.activate(e,a._getFirstSelectableSubItem());return}s=n.offset().top,o=t.options.maxHeight,u=i._getSelectableSubItems(a,function(e){var t=r(e.element),n=o-(t.offset().top-s+t.height()),i=t.height();return n<i&&n>-i}),u.length?u=u[u.length-1]:u=a._getLastSelectableSubItem(),t.activate(e,u)}else!n||t.last()?f=a._getFirstSelectableSubItem():f=a._getLastSelectableSubItem(),t.activate(e,f)},i.prototype.previousPage=function(e){var t=this,n=t._getActiveItemElement(),s,o,u,a,f;n?a=t.activeItem._getParentOrMenu():(a=t,f=t._getFirstSelectableSubItem(),n=f&&f.element);if(t.options.mode==="sliding"&&t._hasScroll()){if(!n||t.first()){t.activate(e,a._getLastSelectableSubItem());return}s=n.offset().top,o=t.options.maxHeight,u=i._getSelectableSubItems(a,function(e){var t=r(e.element),n=t.offset().top-s+o-t.height(),i=t.height();return n<i&&n>-i}),u.length?u=u[0]:u=a._getFirstSelectableSubItem(),t.activate(e,u)}else!n||t.first()?f=a._getLastSelectableSubItem():f=a._getFirstSelectableSubItem(),t.activate(e,f)},i.prototype.select=function(e){var t=this,n=t.activeItem,r;t._trigger("select",e,{item:n}),t.options.checkable&&(r=!n.options.selected,n._setOption("selected",r))},i.prototype._getActiveItemElement=function(){return this.activeItem?this.activeItem.element:null},i.prototype.setItemDisabled=function(e,t){var n=r(e,this.element),i=this.options;n.find("."+i.wijCSS.wijmenuItem+">a").attr("disabled",t),n.find(">a").toggleClass(i.wijCSS.stateDisabled,t)},i.prototype._setOption=function(e,t){var r=this;if(r.destroying)return;r["_set_"+e]&&r["_set_"+e](t),n.prototype._setOption.call(this,e,t)},i.prototype._innerDisable=function(){n.prototype._innerDisable.call(this),this._handleDisabledOption(!0,this.domObject.menucontainer)},i.prototype._innerEnable=function(){n.prototype._innerEnable.call(this),this._handleDisabledOption(!1,this.domObject.menucontainer)},i.prototype._set_items=function(e){var t=this;t._getSublist().children().remove(),t.options.items=e,t.refresh()},i.prototype._set_mode=function(e){var t=this;t._innerDestroy(),t.options.mode=e,t.refresh()},i.prototype._set_backLink=function(e){var t=this,n=t.options,i;this.options.backLink=e,t.options.mode==="sliding"&&(t._killDrilldown(),t._drilldown(),i=r("."+n.wijCSS.wijmenuBreadcrumb,t.domObject.menucontainer),t._resetDrilldownMenu(i))},i.prototype._set_direction=function(e){var t=this;t._innerDestroy(),t.refresh()},i.prototype._set_orientation=function(e){var t=this,n=t.domObject.menucontainer,i=t.options.direction,s="ui-icon-triangle-1-",o=i==="rtl"?"w":"e",u=e==="horizontal"?o:"s",a=e==="horizontal"?"s":o;n.removeClass(t.cssPre+"-vertical "+t.cssPre+"-horizontal"),t.options.mode==="flyout"?(n.addClass(t.cssPre+"-"+e),r.each(t.getItems(),function(e,t){if(t.getItems().length===0)return;t._getLink().find("."+s+u).removeClass(s+u+" "+s+a).addClass(s+a)})):n.addClass(t.cssPre+"-vertical")},i.prototype._getTriggerEle=function(){return i._getOuterElement(this.options.trigger,"."+this.options.wijCSS.wijmenu)},i.prototype._set_triggerEvent=function(e){var t=this,n=t.options,r=t._getTriggerEle();t._killtrigger(),n.triggerEvent=e,r.length>0&&t._initTrigger(r),n.mode==="flyout"&&(t._killFlyout(),t._flyout())},i.prototype._set_submenuTriggerEvent=function(e){var t=this,n=t.options;n.submenuTriggerEvent=e,n.mode==="flyout"&&(t._killFlyout(),t._flyout())},i.prototype._set_trigger=function(e){var t=this,n=t.options,r;t._killtrigger(),n.trigger=e,r=t._getTriggerEle(),r.length>0&&t._initTrigger(r),n.mode==="flyout"&&(t._killFlyout(),t._flyout())},i.prototype._set_maxHeight=function(e){var t=this,n=t.options;n.mode==="sliding"&&(n.maxHeight=e,t._sroll())},i.prototype._initTrigger=function(e){var t=this,n=t.options,i=n.triggerEvent,s=t.domObject.menucontainer,o=".wijmenuEvent";e.is("iframe")&&(e=r(e.get(0).contentWindow.document));switch(i){case"click":e.on(i+o,function(e){n.mode!=="popup"&&t._displayMenu(e),e.stopPropagation()});break;case"mouseenter":e.on(i+o,function(e){t._displayMenu(e),e.stopPropagation()});break;case"dblclick":e.on(i+o,function(e){t._displayMenu(e),e.stopPropagation()});break;case"rtclick":e.on("contextmenu"+o,function(e){s.hide(),t._displayMenu(e),e.preventDefault(),e.stopPropagation()})}},i.prototype._killtrigger=function(){var e=this.options,t;e.trigger!==""&&(t=r(e.trigger),t.is("iframe")&&(t=r(t.get(0).contentWindow.document)),t&&t.length>0&&t.off(".wijmenuEvent").off("wijmenuEvent"))},i.prototype._move=function(e,t,n){var r=this,s=r._getActiveItemElement(),o,u,a;if(!s||!s.length){r.activate(n,t(r));return}a=i._getItemWidget(s),o=a[e](),u=a._getParentOrMenu(),o?r.activate(n,o):r.activate(n,t(u))},i.prototype._bindMousehoverEvent=function(e){var t=this,n=t.options;e.delegate("li>."+n.wijCSS.wijmenuLink,"mouseenter.wijmenuEvent",function(){var e=r(this),i=e.hasAllClasses(n.wijCSS.stateDisabled);if(t._isDisabled()||i)return;e.addClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDefault)}).delegate("li>."+n.wijCSS.wijmenuLink,"mouseleave.wijmenuEvent",function(){var e=r(this),i=e.hasAllClasses(n.wijCSS.stateDisabled);if(t._isDisabled()||i)return;e.removeClass(n.wijCSS.stateHover).removeClass(n.wijCSS.stateDefault),e.data("subMenuOpened")&&e.addClass(n.wijCSS.stateActive)})},i.prototype.refresh=function(){var e=this,t=e.element,n=e.options,i=n.direction,s,o,u,a;e.domObject&&e._innerDestroy();if(t.is("ul"))e._rootMenu=t,s=t.wrap("<div></div>").parent(),o=s.wrap("<div></div>").parent();else{if(!t.is("div"))return;e._rootMenu=r("ul:first",t),s=t,o=t.wrap("<div></div>").parent()}i==="rtl"&&e._rootMenu.addClass(n.wijCSS.wijmenuRtl),s.addClass("scrollcontainer checkablesupport"),o.addClass(n.wijCSS.widget).addClass(n.wijCSS.header).addClass(n.wijCSS.wijmenu).addClass(n.wijCSS.cornerAll).addClass(n.wijCSS.helperClearFix),n.orientation==="horizontal"&&n.mode==="flyout"&&o.addClass(n.wijCSS.wijmenuHorizontal),u={scrollcontainer:s,menucontainer:o},e.domObject=u,e._getSublist().data("topmenu",!0),e._getSublist().hasAllClasses(n.wijCSS.wijmenuList)||e._getSublist().addClass(n.wijCSS.wijmenuList).addClass(n.wijCSS.helperReset),e._items=e._createMenuItems(),t.show(),e._bindMousehoverEvent(t),this[n.mode==="flyout"?"_flyout":"_drilldown"](),n.trigger!==""&&(a=e._getTriggerEle(),a.length>0&&(o.hide(),e._initTrigger(a))),e._bindDocClick()},i.prototype._bindDocClick=function(){var e=this;r(document).on(e.clickNameSpace,function(t){var n=e.options,i=n.trigger,s=e.domObject.menucontainer,o=e._getTriggerEle(),u,a;if(r(t.target).parent().is("."+n.wijCSS.wijmenuAllLists))return;if(r(t.target).closest(i).is(i))return;a=r(t.target).closest("."+n.wijCSS.wijmenu);if(a.length>0)return;if(n.mode==="sliding"){u=r("."+n.wijCSS.wijmenuBreadcrumb,s);if(i==="")return;e._resetDrilldownMenu(u)}else if(n.mode==="flyout"&&n.triggerEvent!=="mouseenter"){e._hideAllMenus(t);return}o&&o.length>0&&e._hideMenu(t)})},i.prototype._flyout=function(){var e=this,t=e.domObject.menucontainer,n=e.options,i=e.getItems();t.attr("role","menu"),n.orientation==="horizontal"&&t.attr("role","menubar"),r.each(i,function(e,t){t._flyout()})},i.prototype._hideAllMenus=function(e){var t=this,n,i,s=function(t){t.getItems&&t.getItems().length>0&&(r.each(t.getItems(),function(e,t){s(t)}),t._hideSubmenu(!1,e))};r.each(t._items,function(e,t){s(t)});if(t.options.trigger!==""){n=t.domObject.menucontainer;if(n.data("isAnimated"))return;i=t._getTriggerEle();if(i.length===0)return;t._hideMenu(e)}},i.prototype.hideAllMenus=function(e){this._hideAllMenus(e)},i.prototype._killFlyout=function(){r.each(this.getItems(),function(){this._killFlyout()})},i.prototype._killElement=function(){var e=this,t=e.options,n=e._getSublist();n.removeClass(t.wijCSS.wijmenuList).removeClass(t.wijCSS.helperReset).removeClass(t.wijCSS.wijmenuContent).removeClass(t.wijCSS.helperClearFix),r(document).off(e.clickNameSpace),e.element.is("ul")?e.element.unwrap().unwrap():e.element.unwrap(),e.domObject=null,e.element.removeData("topmenu").removeData("firstLeftValue").removeData("domObject"),n.undelegate(".wijmenuEvent")},i.prototype._killMenuItems=function(){var e=this,t=e.getItems(),n;for(n=t.length-1;n>=0;n--)t[n].destroy(!0);e._items.length=0},i.prototype._sroll=function(){var e=this.domObject.scrollcontainer,t=r.extend({hScroller:{scrollBarVisibility:"hidden"}},this.options.superPanelOptions);e.height(this.options.maxHeight),e.wijsuperpanel(t)},i.prototype._initScrollCallback=function(){var e=this,t=e.domObject.scrollcontainer;e._linkContainer={link:null,needToFocus:!1},t.wijsuperpanel({scrolled:function(){var t=e._linkContainer.link;e._linkContainer.needToFocus&&t&&t.is("a")&&(t.focus(),e._linkContainer.needToFocus=!1)}})},i.prototype._resetScroll=function(e){var t=this,n=t._rootMenu.parent(),i=5,s=t.domObject.scrollcontainer,o=e._getSublist(),u=document.activeElement;u&&r(u).blur(),n.height(o.height()),s.wijsuperpanel("option","hScroller",{scrollValue:0}),s.wijsuperpanel("option","vScroller",{scrollValue:0}),s.wijsuperpanel("paintPanel"),t._hasScroll()&&(o.prev().length>0&&(i=o.prev().css("padding-left").replace(/px/g,"")),o.width(s.find(".wijmo-wijsuperpanel-contentwrapper:first").width()-i),n.height(o.height()),s.wijsuperpanel("paintPanel"))},i.prototype._hasScroll=function(){var e=this.domObject.scrollcontainer;return e.data("wijmo-wijsuperpanel").vNeedScrollBar},i.prototype._resetDrillChildMenu=function(e){var t=this.options.wijCSS;e.removeClass(t.wijmenuScroll).removeClass(t.wijmenuCurrent).height("auto")},i.prototype._resetDrilldownMenu=function(e,t){var n=this,i=n.options,s=n._getSublist(),o=n.domObject.menucontainer,u=r("<li>"+i.crumbDefaultText+"</li>").addClass(i.wijCSS.wijmenuBreadcrumbText),a=function(e){r.each(e,function(e,t){var r=t._getSublist(),i=t.getItems();r.hide(),n._resetDrillChildMenu(r),i.length>0&&a(i)})};r("."+i.wijCSS.wijmenuCurrent,o).removeClass(i.wijCSS.wijmenuCurrent),s.animate({left:0},i.showDuration,null,function(){a(n.getItems()),s.addClass(i.wijCSS.wijmenuCurrent),t&&t()}),r("."+i.wijCSS.wijmenuAllLists,o).find("span").remove(),e.empty().append(u),r("."+i.wijCSS.wijmenuFooter,o).empty().hide(),n._resetScroll(n)},i.prototype._drilldown=function(){var e=this,t=e._getSublist(),n=e.domObject.menucontainer.attr("role","menu"),i,s=e.options,o=r("<ul></ul>").addClass(s.wijCSS.wijmenuBreadcrumb).addClass(s.wijCSS.stateDefault).addClass(s.wijCSS.cornerAll).addClass(s.wijCSS.helperClearFix),u=r("<li>"+s.crumbDefaultText+"</li>").addClass(s.wijCSS.wijmenuBreadcrumbText);t.wrap("<div>").parent().css("position","relative"),n.addClass(s.wijCSS.wijmenuIpod).addClass(s.wijCSS.wijmenuContainer),s.backLink?o.addClass(s.wijCSS.wijmenuFooter).appendTo(n).hide():o.addClass(s.wijCSS.wijmenuHeader).prependTo(n),s.backLink||o.append(u),i=n.width(),t.addClass(s.wijCSS.wijmenuContent).addClass(s.wijCSS.wijmenuCurrent).addClass(s.wijCSS.content).addClass(s.wijCSS.helperClearFix).css({width:i}),r.each(e.getItems(),function(e,t){t._setDrilldownUlStyle()}),e._sroll(),e._initScrollCallback(),e._resetScroll(e),e.element.data("firstLeftValue",parseFloat(t.css("left"))),e._bindDrillDownClick(o)},i.prototype._bindDrillDownClick=function(e){var t=this,n=t.options,s="li>."+n.wijCSS.wijmenuLink,o=t._getSublist();o.delegate(s,"click",function(s,u){var a=r(this).parent(),f=a.attr("disabled"),l,c,h,p,d,v,m,g,y,b=i._getItemWidget(a),w,E,S=n.direction,x=t.domObject.menucontainer,T=r('<li><a href="#">'+n.topLinkText+"</a></li>").addClass(n.wijCSS.wijmenuAllLists);if(t._isDisabled()||f)return;if(t._isSliding)return;o.stop(!0,!0),y=i._hasVisibleSubMenus(b);if(!y){t._leafNodeClick(s,b,e);return}l=b._getSublist();if(l.hasAllClasses(n.wijCSS.wijmenuCurrent))return;if(!t._trigger("showing",s,b))return;t._isSliding=!0,c=b._getParentOrMenu()._getSublist(),h=c.data("topmenu")?0:parseFloat(o.css("left")),S==="rtl"?v=Math.round(h+parseFloat(x.width().toString())):v=Math.round(h-parseFloat(x.width().toString())),m=r("."+n.wijCSS.wijmenuFooter,x),g=function(e,s){var o=e,u=r("."+n.wijCSS.wijmenuCurrent,x),a,f;if(u.get(0)===t._getSublist().get(0))return;s?(a=s._getSublist(),f=s):(a=u.parent().closest("ul",x[0]),f=i._getItemWidget(u.parent())._getParentOrMenu()),u.hide().attr("aria-expanded","false"),t._resetDrillChildMenu(u),t._resetScroll(f),a.addClass(n.wijCSS.wijmenuCurrent).attr("aria-expanded","true"),a.hasAllClasses(n.wijCSS.wijmenuContent)&&(o.remove(),m.hide())},t._resetDrillChildMenu(c),t._resetScroll(b),t._slidingAnimation(o,v,function(){t._trigger("shown",s,b),t.activate(s,u||b),t.select(s),t._isSliding=!1}),l.show().addClass(n.wijCSS.wijmenuCurrent).attr("aria-expanded","true"),n.backLink?m.find("a").length===0&&(m.show(),w=r("<span></span>").addClass(n.wijCSS.icon).addClass(n.wijCSS.iconArrowLeft),E=r("<span></span>").addClass(n.wijCSS.wijmenuBacklinktext),t._backLink=r('<a href="#"></a>').append(w).append(E).appendTo(m).click(function(e,n){if(t._isDisabled())return;var i=t._getCurrentItemInSliding(),s=r(this),u;if(!t._trigger("hidding",e,i))return;o.stop(!0,!0);if(S==="rtl")u=Math.round(parseInt(o.css("left").replace("px","")))-Math.round(x.width());else{u=Math.round(parseInt(o.css("left").replace("px","")))+Math.round(x.width());if(u>h)return}t._slidingAnimation(o,u,function(){t._trigger("hidden",e,i),g(s),n&&n()}),e.preventDefault()}),E.width(m.width()-w.width()),E.text(n.backLinkText)):(e.find("li").length===1&&(e.empty().append(T),T.find("a").click(function(n,i){var s=r(this).parent(),o=t._getCurrentItemInSliding();t._slidingMenu(n,s,o,null,function(n){n?(g(null,n),i&&i()):t._resetDrilldownMenu(e,i)}),n.preventDefault()})),r("."+n.wijCSS.wijmenuCurrentCrumb,x).removeClass(n.wijCSS.wijmenuCurrentCrumb),p=b._getLink().text(),d=r("<li></li>").addClass(n.wijCSS.wijmenuCurrentCrumb).append(r('<a href="#">'+p+"</a>").addClass(n.wijCSS.wijmenuCrumb)),d.appendTo(e).find("a").click(function(e,i){if(t._isDisabled())return;var s=r(this).parent(),o;s.is("."+n.wijCSS.wijmenuCurrentCrumb)||(o=t._getCurrentItemInSliding(),t._slidingMenu(e,s,o,b,function(e){g(null,e),i&&i()})),e.preventDefault()}),d.prev().append(r("<span></span>").addClass(n.wijCSS.icon).addClass(n.wijCSS.iconCaratRight))),r(this).attr("href")==="#"&&s.preventDefault()})},i.prototype._slidingMenu=function(e,t,n,r,i){var s=this,o=s._getSublist(),u=s.options.direction,a=s.domObject.menucontainer,f=a.width(),l=t.parent().children().length-1,c,h,p,d,v=function(e,t,n){c=(u==="rtl"?1:-1)*t*f,s._slidingAnimation(o,c,function(){n&&n(e)})},m=function(t,n){var r;if(t!==n){r=s._trigger("hidding",e,t);if(r)return l--,d&&d(),d=function(){s._trigger("hidden",e,t)},m(t.getParent(),n)}return t};h=m(n,r),h!==n&&(v(h,l,function(){d&&d(),i&&i(h)}),p=t.parent().children().eq(l),p.addClass("wijmo-wijmenu-current-crumb").find("span").remove(),p.nextAll().remove())},i.prototype._getCurrentItemInSliding=function(){var e=this,t=e.domObject.menucontainer,n=r(".wijmo-wijmenu-current",t),s=i._getItemWidget(n.parent());return s},i.prototype._leafNodeClick=function(e,t,n){var r=this,i=r.options,s;r.activate(e,t),r.select(e),i.trigger&&(s=r._getTriggerEle(),s.length&&(r._hideMenu(e),r._resetDrilldownMenu(n))),t._getLink().attr("href")==="#"&&e.preventDefault()},i.prototype._slidingAnimation=function(e,t,n){var r=this.options.slidingAnimation;r&&!r.disabled?e.stop(!0,!0).animate({left:t},r.duration,r.easing,n):(e.css("left",t),n.call(this))},i.prototype._killDrilldown=function(){var e=this._getSublist(),t=this.options,n=this.domObject,i={width:"",height:""};e.css(i).removeClass(t.wijCSS.content),n.scrollcontainer&&n.scrollcontainer.parent().length>0&&(n.scrollcontainer.css(i),n.scrollcontainer.wijsuperpanel("destroy"),n.scrollcontainer.removeClass("wijmo-wijsuperpanel").append(e)),e.prevAll().remove(),n.menucontainer.removeClass(t.wijCSS.wijmenuIpod).removeClass(t.wijCSS.wijmenuContainer),r("."+t.wijCSS.wijmenuCurrent,n.menucontainer).removeClass(t.wijCSS.wijmenuCurrent),r("."+t.wijCSS.wijmenuBreadcrumb,n.menucontainer).remove(),e.undelegate("li>."+t.wijCSS.wijmenuLink,"click"),r("ul",e).css({left:"",width:""}),e.css("left",""),n.scrollcontainer=n.menucontainer.children(":first")},i.prototype._displayMenu=function(e){var t=this,n=t.options,s,o,u,a=t.domObject.menucontainer,f=r(e.target),l=!i._hasVisibleSubMenus(t);if(a.is(":visible")||l)return;if(!t._trigger("showing",e,t))return;a.show(),t._setPosition(f),t.nowIndex++,t._setZindex(a,t.nowIndex),a.hide(),s={context:a,show:!0},o=n.direction==="rtl"?"right":"left",u=r.extend({},{option:{direction:o}},n.animation,n.showAnimation),i._animateFlyoutMenu(u,s,function(){t._trigger("shown",e,t)}),t._isClickToOpen=n.triggerEvent==="click",this.element.data("shown",!0)},i.prototype._hideMenu=function(e){var t=this,n=t.options,s=this.domObject.menucontainer,o=i.animations,u,a;if(!this.element.data("shown"))return;if(!t._trigger("hidding",e,t))return;this.element.data("shown",!1),r.fn.wijhide?(u={context:s,show:!1},a=r.extend({},n.animation,n.hideAnimation),s.wijhide(a,o,u,null,function(){t._setZindex(s,null),s.attr("aria-hidden",!0),t._trigger("hidden",e,t)})):(s.hide().attr("aria-hidden",!0),t._setZindex(s,null),t._trigger("hidden",e,t))},i.prototype._setZindex=function(e,t){var n=this.domObject,i;if(!n)return;i=n.menucontainer;if(e.get(0)===i.get(0)){t?i.css("z-index",t):i.css("z-index","");return}t?(e.parent().css("z-index",999),e.css("z-index",t),r.browser.msie&&parseInt(r.browser.version)<8&&i.css("z-index")===0&&i.css("z-index",9950)):(e.css("z-index",""),e.parent().css("z-index",""),r.browser.msie&&parseInt(r.browser.version)<8&&r("ul:visible",this._getSublist()).length===0&&i.css("z-index")===9950&&i.css("z-index",""))},i.prototype._setPosition=function(e){var t=this._getPosition(),n={of:e},i=this.domObject.menucontainer;i.css({left:"0",top:"0",position:"absolute"}),i.position(r.extend(n,t))},i.prototype._getPosition=function(){var e=this.options,t=e.direction,n=t==="rtl"?{my:"right top",at:"right bottom"}:{my:"left top",at:"left bottom"};return n=r.extend(n,e.position),n},i.prototype._getFirstSelectableSubItem=function(){return i._getFirstSelectableSubItem(this)},i.prototype._getLastSelectableSubItem=function(){return i._getLastSelectableSubItem(this)},i.prototype.add=function(e,t){i._add(this,e,t)},i.prototype._getSublist=function(){return this._rootMenu},i.prototype.getItems=function(){return this._items},i.prototype.remove=function(e){i._remove(this,e)},i.prototype._newId=function(){var e=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],t="",n;for(n=0;n<16;n++)t+=e[Math.round(Math.random()*25)];return t},i._animateFlyoutMenu=function(e,t,n){var s=t.context;r.fn.wijshow?(s.data("isAnimated",!0),s.wijshow(e,i.animations,t,null,function(){s.data("isAnimated",!1);var e=r.browser;e.msie&&e.version==="9.0"?(s.wrap("<div></div>"),s.unwrap()):e.msie&&e.version==="6.0"&&s.css("overflow",""),s.attr("aria-hidden",!1),n&&n()})):s.show().attr("aria-hidden",!1)},i._getMenuItemOptions=function(e,t){return e?!e.items||!r.isArray(e.items)?{}:t>=e.items.length?{}:e.items[t]:{}},i._getOuterElement=function(e,t){return r(e).filter(function(){return r(this).closest(t).length===0})},i._hasVisibleSubMenus=function(e){var t,n,r;e.jquery?e.data("wijmomenu")?t=e.data(e.data("wijmomenu")):e.data("wijmomenuitem")&&(t=e.data(e.data("wijmomenuitem"))):t=e;if(!t)throw"the arugment 'menuItem' must be an wijmenu or wijmenuitem";n=t.getItems();if(!n.length)return!1;for(r=0;r<n.length;r++)if(n[r].options.displayVisible)return!0;return!1},i._getFirstSelectableSubItem=function(e){var t,n,r=e.getItems();for(t=0;t<r.length;t++){n=r[t].options;if(n.displayVisible!==!1&&!n.header&&!n.separator)return r[t]}return null},i._getLastSelectableSubItem=function(e){var t,n=e.getItems(),r;for(t=n.length-1;t>=0;t--){r=n[t].options;if(r.displayVisible!==!1&&!r.header&&!r.separator)return n[t]}return null},i._getSelectableSubItems=function(e,t){return r.grep(e.getItems(),function(e,n){var r=e.options;return r.header||r.separator||r.displayVisible===!1?!1:t(e,n)},!1)},i._add=function(e,t,n){var s=null,o=r("<li></li>"),u=e._getSublist(),a=e.getItems(),f,l,c=!1;typeof t=="string"?/<(h[1-5]|a)[\s\S]*>[\s\S]*<\/\1>/.test(t)&&o.append(t):r.isPlainObject(t)&&(l=jQuery.extend(!0,{},t));if(!u||u.length<=0)u=r("<ul></ul>"),e.element.append(u),c=!0;(!n||isNaN(n)||n>a.length)&&n!==0&&(n=a.length),a.length>0&&a.length!==n?(f=a[n].element,o.insertBefore(f)):u.append(o),s=e._createItemWidget(o,l);if(s===null||s===undefined)return;i._changeCollection(n,e.getItems(),e.options.items,s),e._bindModeEvents?e._bindModeEvents(s,c):s._bindModeEvents(s,c),c&&e._initUlCssClass()},i._changeCollection=function(e,t,n,r){if(!r){t.splice(e,1),n.splice(e,1);return}t.splice(e,0,r),n.splice(e,0,r.options)},i._remove=function(e,t){var n=e.getItems()[t];n&&n.element&&n.element.remove()},i._getItemWidget=function(e){return e.data(e.data("wijmomenuitem"))},i._itemWidgetName="wijmenuitem",i.animations={slide:function(e,t){e=r.extend({duration:400,easing:"swing"},e,t),e.show?e.context.stop(!0,!0).animate({height:"show"},e,function(){e.context.attr("aria-hidden",!1)}):e.context.stop(!0,!0).animate({height:"hide"},e,function(){e.context.attr("aria-hidden",!0)})}},i}(t.wijmoWidget);n.wijmenu=s;var o=function(){function e(){this.initSelector=":jqmData(role='wijmenu')",this.wijCSS={wijmenu:"wijmo-wijmenu",wijmenuHorizontal:"wijmo-wijmenu-horizontal",wijmenuCurrent:"wijmo-wijmenu-current",wijmenuCurrentCrumb:"wijmo-wijmenu-current-crumb",wijmenuBreadcrumb:"wijmo-wijmenu-breadcrumb",wijmenuBreadcrumbText:"wijmo-wijmenu-breadcrumb-text",wijmenuItem:"wijmo-wijmenu-item",wijmenuLink:"wijmo-wijmenu-link",wijmenuList:"wijmo-wijmenu-list",wijmenuScroll:"wijmo-wijmenu-scroll",wijmenuContent:"wijmo-wijmenu-content",wijmenuFooter:"wijmo-wijmenu-footer",wijmenuHeader:"wijmo-wijmenu-header",wijmenuContainer:"wijmo-wijmenu-container",wijmenuIpod:"wijmo-wijmenu-ipod",wijmenuCrumb:"wijmo-wijmenu-crumb",wijmenuAllLists:"wijmo-wijmenu-all-lists",wijmenuPrevList:"wijmo-wijmenu-prev-list",wijmenuRtl:"wijmo-wijmenu-rtl",wijmenuBacklinktext:"wijmo-wijmenu-backlinktext",wijmenuSubmenuContainer:"wijmo-wijmenu-submenu-container",wijmenuParent:"wijmo-wijmenu-parent"},this.wijMobileCSS={header:"ui-header ui-bar-b",content:"ui-body ui-body-b",stateDefault:"ui-btn ui-btn-b",stateHover:"ui-btn-down-c",stateActive:"ui-btn-down-c"},this.trigger="",this.triggerEvent="click",this.submenuTriggerEvent="default",this.position={},this.animation={animated:"slide",duration:400,easing:null,option:null},this.showAnimation={},this.hideAnimation={animated:"fade",duration:400,easing:null,option:null},this.showDelay=400,this.hideDelay=400,this.slidingAnimation={duration:400,easing:null},this.mode="flyout",this.superPanelOptions=null,this.checkable=!1,this.orientation="horizontal",this.direction="ltr",this.maxHeight=200,this.backLink=!0,this.backLinkText="Back",this.topLinkText="All",this.crumbDefaultText="Choose an option",this.select=null,this.focus=null,this.blur=null,this.showing=null,this.shown=null,this.hidding=null,this.hidden=null,this.items=null,this.ensureSubmenuOnBody=!1}return e}();s.prototype.options=r.extend(!0,{},t.wijmoWidget.prototype.options,new o),function(e){e[e.link=0]="link",e[e.separator=1]="separator",e[e.header=2]="header",e[e.other=3]="other"}(n.MarkupType||(n.MarkupType={}));var u=n.MarkupType,a=function(t){function n(){t.apply(this,arguments)}return e(n,t),n.prototype._initState=function(){this._items=[],this._resetMarkupValue(),this.options.items||(this.options.items=[])},n.prototype._create=function(){var e=this;e._isMobile&&r.extend(!0,e.options.wijCSS,e.options.wijMobileCSS),e.element.data("wijmomenuitem",e.widgetFullName),e._initState(),e._getOrSetOptionsValues(),e._createChildMenuItems(),e._initCssClass(),t.prototype._create.call(this)},n.prototype._refresh=function(){var e=this,t=e.options;e._set_navigateUrl(t.navigateUrl),e._set_target(t.target),e._set_displayVisible(t.displayVisible),e._createChildMenuItems(),e._initCssClass()},n.prototype._setOption=function(e,n){var i=this,s=i.options,o;if(e==="items"){t.prototype._setOption.call(this,e,n),i._set_items(n);return}if(n===s[e])return;t.prototype._setOption.call(this,e,n);if(!r.isFunction(i["_set_"+e]))return;i["_set_"+e](n,!0);switch(e){case"header":case"separator":i._resetMarkupValue(),i._refresh();break;case"displayVisible":o=i.getParent(),o&&o._setSubmenuIcon();break;default:}},n.prototype.index=function(){return this.element.index()},n.prototype._set_selected=function(e){var t=this,n=t.options,r=t._getMenuItemType();r===0?t._getLink().toggleClass(n.wijCSS.stateActive,e):n.selected=!1},n.prototype._set_items=function(e){var t=this;t._getSublist().remove(),t._items=[],e.length>0&&(t._createChildMenuItems(),t._initUlCssClass()),t._setSubmenuIcon(e.length>0),t._bindModeEvents(t,!0),t._resetMarkupValue()},n.prototype._bindModeEvents=function(e,t){var n=this,r=e._getMenu(),i=r.options;t&&(n._initUlCssClass(),n._setSubmenuIcon(),n._resetMarkupValue()),i.mode==="flyout"?t?(n._killFlyout(),n._flyout()):e._flyout():(n._setDrilldownUlStyle(),e.element.parent().is(":visible")&&r._resetScroll(e._getParentOrMenu()))},n.prototype._set_text=function(e,t){var n=this,r=n.options;e||t?n._setText(e):r.text=n._getText()},n.prototype._set_navigateUrl=function(e,t){var n=this,r=n.options,i=n._getLink();i.is("a")&&(e||t?i.attr("href",e):r.navigateUrl=i.attr("href"))},n.prototype._set_target=function(e,t){var n=this,r=n.options,i=n._getLink();i.is("a")&&(r.target||t?i.attr("target",e):r.target=i.attr("target")||"")},n.prototype._createIconSpan=function(){var e=this,t=e.options,n=e._getLink(),i,s;return i=r("<span>"),s=n.children("."+t.wijCSS.wijmenuText).wrap("<span>").parent(),s.addClass(t.wijCSS.wijmenuText),s.prepend(i),i},n.prototype._set_iconClass=function(e,t){var n=this,r=n.options,i,s,o,u;if(r.header===!0||r.separator===!0)return;i=n._getLink(),s=i.find("span."+r.wijCSS.wijmenuitemIcon),e?(s.length===0&&(s=n._createIconSpan()),s.addClass(e).addClass(r.wijCSS.wijmenuIconLeft).addClass(r.wijCSS.wijmenuitemIcon),t&&n._set_imagePosition(r.imagePosition)):s.length!==0&&(s.remove(),o=i.children("."+r.wijCSS.wijmenuText),u=o.text(),o.html(""),o.text(u)),n._getMenuItemType()===3&&i.addClass(r.wijCSS.wijmenuLink).addClass(r.wijCSS.cornerAll)},n.prototype._set_imagePosition=function(e,t){var n=this,r=n.options,i=n._getLink(),s=i.find(">span>span."+r.wijCSS.wijmenuitemIcon),o=e==="right"?r.wijCSS.wijmenuIconRight:r.wijCSS.wijmenuIconLeft;if(s.length===0)return;s.removeClass(r.wijCSS.wijmenuIconRight).removeClass(r.wijCSS.wijmenuIconLeft).addClass(o)},n.prototype._set_separator=function(e,t){var n=this,r=n.element,i=n.options,s=n._getLink();t&&e===!1?(r.html("").removeClass(i.wijCSS.wijmenuSeparator).removeClass(i.wijCSS.widget).removeClass(i.wijCSS.wijmenuItem).removeClass(i.wijCSS.stateDefault).removeClass(i.wijCSS.cornerAll),n._createMenuItemMarkup(0).appendTo(r)):e===!0||s.length===0?(i.separator=!0,i.header=!1,r.html(n._createMenuItemMarkup(1))):i.separator=!1},n.prototype._set_header=function(e,t){var n=this,r=n.element,i=n.options,s=n._getLink();t&&e===!1?(r.html("").removeClass(i.wijCSS.header).removeClass(i.wijCSS.cornerAll).removeClass(i.wijCSS.widget).removeClass(i.wijCSS.wijmenuItem).removeClass(i.wijCSS.stateDefault),n._createMenuItemMarkup(0).appendTo(r)):e===!0||s.is("h1,h2,h3,h4,h5")?(i.header=!0,i.separator=!1,s.is("h1,h2,h3,h4,h5")||(s.remove(),s=n._createMenuItemMarkup(2),r.append(s))):i.header=!1},n.prototype._set_displayVisible=function(e){var t=this,n=t.element;e?n.show():n.hide()},n.prototype._createMenuItemMarkup=function(e){var t=this,n=t.options,i;return e===1?i=r('<span class="'+n.wijCSS.wijmenuSeparatorContent+'">&nbsp;</span>'):e===2?i=r("<h3></h3>").text(n.text):i=r("<a>").text(n.text),i},n.prototype._getMenuItemType=function(e){var t=this,n=t.options,i=t._getLink();return e&&(n=r.extend({},n,e)),n.separator===!0?1:n.header===!0?2:i.length===0?n.text?0:1:i.is("a")?0:i.is("h1,h2,h3,h4,h5")?2:3},n.prototype._getOrSetOptionsValues=function(){var e=this,t=e.element,n=e.options,r=e._getLink(),i=e._getMenuItemType();i===2?(e._set_header(n.header),e._set_text(n.text)):i===1?e._set_separator(n.separator):(r.length===0?(r=e._createMenuItemMarkup(i),t.append(r)):e._set_text(n.text),e._resetMarkupValue(),e._set_navigateUrl(n.navigateUrl),e._set_target(n.target)),e._set_displayVisible(n.displayVisible),e._set_selected(n.selected)},n.prototype._getText=function(){return this._getLink().text()},n.prototype._setText=function(e){var t=this.element,n=this.options,r;r=t.find(":not(ul)a ."+n.wijCSS.wijmenuText+":first");if(r.length!==0){r.text(e);return}r=t.children("h1,h2,h3,h4,h5").filter(":first");if(r.length!==0){r.text(e);return}r=t.children("a:first");if(r.length!==0){r.text(e);return}},n.prototype._createChildMenuItems=function(){var e=this,t=e.element,n=e._items,i=e.options,o,u,a,f,l,c;if(i.header===!0||i.separator===!0)return;o=i.items.length,u=e._getSublist(),a=u.children("li").length;if(o>a){u.length===0&&(u=r("<ul>").appendTo(t),e._resetMarkupValue());for(f=0;f<o-a;f++)u.append("<li>")}r.each(e._getChildren(),function(t,i){var o=r(i),u=s._getMenuItemOptions(e.options,t);l=e._createItemWidget(o,u),n.push(l),e.options.items[t]=l.options})},n.prototype._createItemWidget=function(e,t){var n=this,r=n.widgetName;return e[r](t),e.data(n.widgetFullName)},n.prototype._initCssClass=function(){var e=this,t=e.element,n=e.options,r=e._getLink(),i=e._getMenuItemType();i!==1&&t.attr("role","menuitem"),i===1?t.addClass(n.wijCSS.wijmenuSeparator).addClass(n.wijCSS.stateDefault).addClass(n.wijCSS.cornerAll):i===2?t.addClass(n.wijCSS.header).addClass(n.wijCSS.cornerAll):(i===0?t.hasAllClasses(n.wijCSS.wijmenuItem)||(t.addClass(n.wijCSS.widget).addClass(n.wijCSS.wijmenuItem).addClass(n.wijCSS.stateDefault).addClass(n.wijCSS.cornerAll),r.addClass(n.wijCSS.wijmenuLink).addClass(n.wijCSS.cornerAll),r.wrapInner("<span>").children("span").addClass(n.wijCSS.wijmenuText)):t.addClass(n.wijCSS.widget).addClass(n.wijCSS.wijmenuItem).addClass(n.wijCSS.stateDefault).addClass(n.wijCSS.cornerAll),e._setSubmenuIcon()),e._set_iconClass(n.iconClass),e._set_imagePosition(n.imagePosition),e._initUlCssClass()},n.prototype._initUlCssClass=function(){var e=this.options.wijCSS;this._getSublist().addClass(e.wijmenuList).addClass(e.content).addClass(e.cornerAll).addClass(e.helperClearFix).addClass(e.wijmenuChild).addClass(e.helperReset).hide()},n.prototype._setSubmenuIcon=function(e){var t=this,n=t.options,i=t._getLink(),o=t._getMenu(),u=o.options.direction,a=u==="rtl"?i.children("span."+n.wijCSS.icon+":first"):i.children("span."+n.wijCSS.icon+":last");e===undefined&&(e=s._hasVisibleSubMenus(t)),e&&!i.is(":input")?(a.length===0&&(u==="rtl"?a=r("<span>").prependTo(i):a=r("<span>").appendTo(i)),t._isRoot()&&o.options.orientation==="horizontal"&&o.options.mode==="flyout"?a.addClass(n.wijCSS.icon).addClass(n.wijCSS.iconArrowDown):u==="rtl"?a.addClass(n.wijCSS.icon).addClass(n.wijCSS.iconArrowLeft):a.addClass(n.wijCSS.icon).addClass(n.wijCSS.iconArrowRight)):a.remove()},n.prototype._killFlyout=function(){var e=this.element.attr("role",""),t=this.options;e.removeClass(t.wijCSS.wijmenuParent).off(".wijmenuEvent").off(".wijmenuitem").children(":first").off(".wijmenuEvent").off(".wijmenuitem").attr("aria-haspopup",""),this._getSublist().off(".wijmenuEvent").off(".wijmenuitem"),r.each(this.getItems(),function(){this._killFlyout()})},n.prototype._getItemTriggerEvent=function(){var e=this,t=e.element,n=e._getMenu(),i=n.options,s=i.submenuTriggerEvent;switch(s){case"click":case"mouseenter":case"dblclick":case"rtclick":break;default:s="default"}return i.trigger!==""&&(t.is(i.trigger)?s=i.triggerEvent:s==="default"&&(n.element.is(i.trigger)?s=i.triggerEvent:t.parents("."+i.wijCSS.wijmenuParent).each(function(e,t){if(r(t).is(i.trigger))return s=i.triggerEvent,!1}),s==="default"&&e._isOuterTirggerEle()&&(s=i.triggerEvent))),t.data("triggerEvent",s),s},n.prototype._isOuterTirggerEle=function(){var e=this._getMenu();return s._getOuterElement(e.options.trigger,"."+e.options.wijCSS.wijmenu).length>0},n.prototype._flyout=function(){var e=this,t=e._getMenu(),n=t.options,i=".wijmenuitem",s=r(e.element).attr("aria-haspopup",!0),o=e._getItemTriggerEvent(),u=s.children("a."+n.wijCSS.wijmenuLink),a=e._getSublist(),f,l,c;if(e.getItems().length>0){a.on("mouseleave"+i,function(t){if(e._isDisabled())return;c=setTimeout(function(){e._hideCurrentSubmenu(t)},n.hideDelay)}),s.addClass(e.options.wijCSS.wijmenuParent);if(o!=="default"&&o!=="mouseenter"){switch(o){case"click":u.on("click"+i,function(t){if(e._isDisabled()||r(this).hasAllClasses(n.wijCSS.stateDisabled))return;e._showFlyoutSubmenu(t)});break;case"dblclick":u.on("dblclick"+i,function(t){if(e._isDisabled()||r(this).hasAllClasses(n.wijCSS.stateDisabled))return;e._showFlyoutSubmenu(t)});break;case"rtclick":u.on("contextmenu"+i,function(t){if(e._isDisabled()||r(this).hasAllClasses(n.wijCSS.stateDisabled))return;e._showFlyoutSubmenu(t),t.preventDefault()})}a.data("notClose",!0)}else u.on("mouseenter.wijmenuEvent",function(t){if(e._isDisabled()||r(this).hasAllClasses(n.wijCSS.stateDisabled))return;clearTimeout(c),l=setTimeout(function(){e._displaySubmenu(t,null)},n.showDelay)}).on("mouseleave"+i,function(t){if(e._isDisabled()||r(this).hasAllClasses(n.wijCSS.stateDisabled))return;clearTimeout(l),a.is("ul")||(a=a.children("ul:first")),c=setTimeout(function(){e._hideSubmenu(!1,t)},n.hideDelay)}),e.getItems().length>0&&e._getSublist().on("mouseenter"+i,function(t){if(e._isDisabled())return;clearTimeout(c)}),a.data("notClose",!1)}u.on("click.wijmenuEvent",function(r){f=u.hasAllClasses(n.wijCSS.stateDisabled);if(e._isDisabled()||f)return!1;if(u.is("a")){if(e._getSublist().length===0)t._hideAllMenus(r);else if(n.trigger===""||s.data("triggerEvent")==="default"||s.data("triggerEvent")==="mouseenter")t._hideAllMenus(r);else{var i=t._currentMenuList,o;if(i!==undefined&&e._getSublist().length===0)for(o=i.length;o>0;o--){if(i[o-1]===e)break;i[o-1]._hideSubmenu(!1,r)}}t.activate(r,e)}t.select(r),u.attr("href")==="#"&&r.preventDefault()}).on("focusin.wijmenuEvent",function(r){f=u.hasAllClasses(n.wijCSS.stateDisabled);if(e._isDisabled()||f)return;u.is("a")&&t.activate(r,e)}),r.each(e.getItems(),function(){this._flyout()})},n.prototype._hideSubmenu=function(e,t){var n=this,i=n._getMenu(),o=i.options,u=s.animations,a,f,l,c=n._getSublist(),h=n._getLink(),p=r.browser.msie?n.element.children("iframe.bgiframe"):null,d;if(!h.data("subMenuOpened"))return;if(!i._trigger("hidding",t,n))return;h.is("."+o.wijCSS.wijmenuLink)&&(h.data("subMenuOpened",!1),h.removeClass(o.wijCSS.stateActive)),c.is(":animated")&&c.stop(!0,!0),r.fn.wijhide&&e!==!0?(a={context:c,show:!1},f=r.extend({},o.animation,o.hideAnimation),c.wijhide(f,u,a,null,function(){i._setZindex(c,null),c.attr("aria-hidden",!0),r.browser.msie&&p.remove(),i._trigger("hidden",t,n)})):(c.hide({complete:function(){r.browser.msie&&p.remove()}}).attr("aria-hidden",!0),i._setZindex(c,null),i._trigger("hidden",t,n)),l=i._currentMenuList,l&&(l=r.makeArray(r.map(l,function(e){return e&&e===n?null:e})),i._currentMenuList=r.makeArray(l))},n.prototype._displaySubmenu=function(e,t){var n=this,i=n._getMenu(),o=i.options,u,a,f,l=s.animations,c,h=n._getLink(),p=n._getSublist(),d,v;r.browser.msie&&(d=n.element.children("iframe.bgiframe"),d.length===0&&(d=r('<iframe class="bgiframe" frameborder="0" tabindex="-1" src="javascript: false;" style="display:none;position:absolute;z-index:-1;top:0px;left:0px;opacity:0;filter:alpha(opacity = 0);" />'),n.element.append(d))),c=!s._hasVisibleSubMenus(n);if(p.is(":visible")||c)return;if(!i._trigger("showing",e,n))return;h.is("a."+o.wijCSS.wijmenuLink)&&h.data("subMenuOpened",!0),p.show(),n._setMenuItemPosition(),r.browser.msie&&n._setIframeBounds(p,d),i.nowIndex++,i._setZindex(p,i.nowIndex),p.hide(),u={context:p,show:!0},a=o.direction==="rtl"?"right":"left",o.orientation==="horizontal"&&n._isRoot()&&(a="up"),r.browser.msie&&d.css("display",""),f=r.extend({},{option:{direction:a}},o.animation,o.showAnimation),s._animateFlyoutMenu(f,u,function(){p.is(":hidden")&&n._hideSubmenu(!0,e),i._trigger("shown",e,n),t&&t()}),i._isClickToOpen=o.triggerEvent==="click",i._currentMenuList===undefined&&(i._currentMenuList=[]),i._currentMenuList.push(n)},n.prototype._setMenuItemPosition=function(){var e=this,t=e._getSublist(),n=e._getMenuItemPosition(),i={of:this._getLink()};t.css({left:"0",top:"0",position:"absolute"}),t.position(r.extend(i,n))},n.prototype._getMenuItemPosition=function(){var e=this,t=this._getMenu(),n=t.options,i=n.direction,s=i==="rtl"?{my:"right top",at:"left top"}:{my:"left top",at:"right top"};return n.orientation==="horizontal"&&e._isRoot()&&(s=i==="rtl"?{my:"right top",at:"right bottom"}:{my:"left top",at:"left bottom"}),s=r.extend(s,n.position),s},n.prototype._getChildren=function(){return this._getSublist().children("li")},n.prototype._setDrilldownUlStyle=function(){var e=this,t=e.options,n=e._getSublist(),i=e._getMenu(),s=i.domObject.menucontainer.width();i.options.direction==="rtl"?n.css({width:s,left:-s}):n.css({width:s,left:s}),n.addClass(t.wijCSS.content),r.each(e.getItems(),function(e,t){t.getItems().length&&this._setDrilldownUlStyle()})},n.prototype._getMenu=function(){var e=this,t=e._menu,n,r;if(!t){n=e.element.parent();while(!n.is("body")&&n.length>0){r=n.data("wijmomenu");if(r)return t=n.data(r),e._menu=t,t;n=n.parent()}throw"An menuitem must be a child of menu"}return t},n.prototype.getParent=function(){var e=this,t=e.element,n=e._parent,r,i;if(n!==undefined)return n;r=e._getMenu(),i=t.parent().closest("li",r.element[0]);if(i.length>0){n=s._getItemWidget(i);if(n!==undefined)return e._parent=n,n}if(r._getSublist().get(0)===t.parent().get(0))return e._parent=null,null;throw"An menuitem must be a child of menu or another menuitem"},n.prototype._getParentOrMenu=function(){return this.getParent()||this._getMenu()},n.prototype._getField=function(e){return this.element.data(e)},n.prototype._setField=function(e,t){return this.element.data(e,t)},n.prototype._innerDestroy=function(e){var t=this,n=t.options,r=t.element,i,s=t.getItems(),o=s.length-1;r.removeClass(n.wijCSS.widget).removeClass(n.wijCSS.wijmenuItem).removeClass(n.wijCSS.stateDefault).removeClass(n.wijCSS.cornerAll).removeClass(n.wijCSS.wijmenuParent).removeClass(n.wijCSS.header).removeClass(n.wijCSS.wijmenuSeparator),i=r.children("."+n.wijCSS.wijmenuLink),i.removeClass(n.wijCSS.wijmenuLink).removeClass(n.wijCSS.cornerAll).removeClass(n.wijCSS.stateFocus).removeClass(n.wijCSS.stateHover).removeClass(n.wijCSS.stateActive).html(i.children("."+n.wijCSS.wijmenuText).html()).off(".wijmenuitem").off(".wijmenuEvent"),r.children("ul").removeClass(n.wijCSS.wijmenuList).removeClass(n.wijCSS.content).removeClass(n.wijCSS.cornerAll).removeClass(n.wijCSS.helperClearFix).removeClass(n.wijCSS.wijmenuChild).removeClass(n.wijCSS.helperReset).attr("role","").attr("aria-activedescendant","").show().css({left:"",top:"",position:""}).attr("hidden",""),r.removeAttr("role"),i.removeAttr("aria-haspopup"),e||t._removeFromParentCollection(),r.removeData("menu").removeData("parent"),r.children("iframe.bgiframe").length!==0&&r.children("iframe.bgiframe").remove();for(;o>=0;o--)s[o].destroy(!0);t._items.length=0,t._resetMarkupValue()},n.prototype.destroy=function(e){this._innerDestroy(e),t.prototype.destroy.call(this)},n.prototype._getFirstSelectableSubItem=function(){return s._getFirstSelectableSubItem(this)},n.prototype._getLastSelectableSubItem=function(){return s._getLastSelectableSubItem(this)},n.prototype.next=function(){var e=this,t=e._getParentOrMenu().getItems(),n,i,s=r.inArray(e,t);if(s===-1)throw"cannot find item from the parent collection";for(n=s+1;n<t.length;n++){i=t[n].options;if(i.displayVisible!==!1&&!i.header&&!i.separator)return t[n].element}return null},n.prototype.previous=function(){var e=this,t=e._getParentOrMenu().getItems(),n,i,s=r.inArray(e,t);if(s===-1)throw"cannot find item from the parent collection";for(n=s-1;n>=0;n--){i=t[n].options;if(i.displayVisible!==!1&&!i.header&&!i.separator)return t[n].element}return null},n.prototype._removeFromParentCollection=function(){var e=this,t,n=!1,i;t=e.getParent(),t===null&&(t=e._getMenu(),n=!0),i=r.inArray(e,t.getItems());if(i===-1)return;s._changeCollection(i,t.getItems(),t.options.items,null),t.getItems().length===0&&(n||(t._setSubmenuIcon(!1),t._resetMarkupValue()),t.element.children("ul").remove())},n.prototype._resetMarkupValue=function(){this._sublist=null,this._link=null},n.prototype._hideCurrentSubmenu=function(e){var t=this,n=t._getSublist();if(n.length===0)return;n.data("notClose")||t._hideSubmenu(!1,e),r.each(t.getItems(),function(){this._hideCurrentSubmenu(e)})},n.prototype._showFlyoutSubmenu=function(e,t){var n=this,r=n._getMenu(),i=r._currentMenuList,s;if(i!==undefined)for(s=i.length;s>0;s--){if(i[s-1]===n.getParent())break;i[s-1]._hideSubmenu(!1,e)}n._displaySubmenu(e,t)},n.prototype.getItems=function(){return this._items},n.prototype._getSublist=function(){var e=this;return e._sublist||(e._sublist=e.element.children("ul:first")),e._sublist},n.prototype._getLink=function(){var e=this;return e._link||(e._link=e.element.children(":first")),e._link},n.prototype._isRoot=function(){return this.getParent()===null},n.prototype.add=function(e,t){s._add(this,e,t)},n.prototype.remove=function(e){s._remove(this,e)},n.prototype._setIframeBounds=function(e,t){var n=this,i=0,s=0,o=0,u=0,a,f,l,c,h,p,d=r.browser;if(!d.msie)return;parseFloat(r.browser.version)>=9&&(a=e.css("box-shadow").split(" "),p=a.length,p>1&&(p<4?f=0:f=n._parsePxToNumber(a[3]),p<3?l=0:l=.3*n._parsePxToNumber(a[2]),c=n._parsePxToNumber(a[1]),h=n._parsePxToNumber(a[0]),i=l+f-h,i=i>=0?i:0,s=l+f+h,s=s>=0?s:0,o=l+f-c,o=o>=0?o:0,u=l+f+c,u=u>=0?u:0)),t.css({width:e.outerWidth(!0)+i+s+"px",height:e.outerHeight(!0)+o+u+"px",left:n._parsePxToNumber(e.css("left"))-i+"px",top:n._parsePxToNumber(e.css("top"))-o+"px"})},n.prototype._parsePxToNumber=function(e){var t=e.indexOf("px");return!t||t===-1?0:parseFloat(e.substr(0,t))},n}(t.wijmoWidget);n.wijmenuitem=a;var f=function(){function e(){this.initSelector=":jqmData(role='wijmenuitem')",this.wijCSS={wijmenuitemIcon:"wijmenuitem-icon",wijmenuParent:"wijmo-wijmenu-parent",wijmenuLink:"wijmo-wijmenu-link",wijmenuText:"wijmo-wijmenu-text",wijmenuList:"wijmo-wijmenu-list",wijmenuItem:"wijmo-wijmenu-item",wijmenuSeparator:"wijmo-wijmenu-separator",wijmenuIconLeft:"wijmo-wijmenu-icon-left",wijmenuIconRight:"wijmo-wijmenu-icon-right",wijmenuChild:"wijmo-wijmenu-child",wijmenuSeparatorContent:"wijmo-wijmenu-separator-content"},this.wijMobileCSS={header:"ui-header ui-bar-c",content:"ui-body ui-body-c",stateDefault:"ui-btn ui-btn-b",stateHover:"ui-btn-down-c",stateActive:"ui-btn-down-c"},this.header=!1,this.separator=!1,this.value="",this.text="",this.navigateUrl="",this.target="",this.iconClass="",this.imagePosition="",this.displayVisible=!0,this.selected=!1,this.items=null}return e}();a.prototype.options=r.extend(!0,{},t.wijmoWidget.prototype.options,new f),r.wijmo.registerWidget(i,s.prototype),r.widget("wijmo.wijmenuitem",r.wijmo.widget,a.prototype)})(t.menu||(t.menu={}));var n=t.menu})(wijmo||(wijmo={}))});