var wijmo;define(["./wijmo.widget"],function(){var e=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};(function(t){(function(n){var r=jQuery,i="wijmo-wijprogressbar",s="ui-progressbar",o=s+"-label",u=i+"-lb-",a=function(t){function n(){t.apply(this,arguments)}return e(n,t),n.prototype._create=function(){return r.ui.progressbar.prototype._create.apply(this,arguments)},n.prototype._destroy=function(){return r.ui.progressbar.prototype._destroy.apply(this,arguments)},n.prototype._setOptions=function(){return r.ui.progressbar.prototype._setOptions.apply(this,arguments)},n.prototype._setOption=function(e,t){return r.ui.progressbar.prototype._setOption.apply(this,arguments)},n.prototype._constrainedValue=function(e){return r.ui.progressbar.prototype._constrainedValue.apply(this,arguments)},n.prototype.value=function(e){return r.ui.progressbar.prototype.value.apply(this,arguments)},n.prototype._percentage=function(){return r.ui.progressbar.prototype._percentage.apply(this,arguments)},n.prototype._refreshValue=function(e){return r.ui.progressbar.prototype._refreshValue.apply(this,arguments)},n}(t.JQueryUIWidget);n.JQueryUIProgress=a;var f=function(){function e(){this.wijCSS={uiProgressbar:"ui-progressbar",uiProgressbarValue:"ui-progressbar-value"},this.labelAlign="center",this.maxValue=100,this.minValue=0,this.fillDirection="east",this.labelFormatString="{1}%",this.toolTipFormatString="{1}%",this.indicatorIncrement=1,this.indicatorImage="",this.animationDelay=0,this.animationOptions={disabled:!1,easing:null,duration:500},this.progressChanging=null,this.beforeProgressChanging=null,this.progressChanged=null,this.value=0}return e}(),l=function(t){function n(){t.apply(this,arguments)}return e(n,t),n.prototype._setOption=function(e,n){var r=this,i=r._isDisabled(),s,o=r.options,u;switch(e){case"value":o[e]=parseInt(n,10),r._refreshValue();return;case"maxValue":o.max=n;case"minValue":u=parseInt(n,10),o[e]=u,r[e==="maxValue"?"max":"min"]=u,r._refreshValue(!0);return;case"labelFormatString":case"toolTipFormatString":o[e]=n,r._refreshValue(!0);return;case"fillDirection":case"labelAlign":case"indicatorImage":o[e]=n,r._updateElementsCss();return;default:}t.prototype._setOption.call(this,e,n);if(e==="disabled"){s=this._isDisabled();if(i===s)return;r._handleDisabledOption(s,r.element)}},n.prototype._create=function(){var e=this,n=e.options,s=n.wijCSS,u=e.element;e.directions={east:"left",west:"right",north:"bottom",south:"top"},e.min=n.minValue,e.max=n.max=n.maxValue,u.addClass(i),t.prototype._create.call(this),u.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").addClass(s.uiProgressbar).addClass(s.widget).addClass(s.content).addClass(s.cornerAll),this.valueDiv.removeClass("ui-progressbar-value ui-widget-header ui-corner-left").addClass(s.uiProgressbarValue).addClass(s.header),e.label=r("<span>").addClass(o).appendTo(u),e._updateElementsCss(),e._isInit=!0,e._isDisabled()&&e._handleDisabledOption(!0,e.element),e._refreshValue()},n.prototype._isDisabled=function(){var e=this.options;return e.disabledState===!0||e.disabled===!0},n.prototype._handleDisabledOption=function(e,t){var n=this;n.element.toggleClass(n.options.wijCSS.stateDisabled,e),e?(n.disabledDiv||(n.disabledDiv=n._createDisabledDiv(t)),n.disabledDiv.appendTo("body")):n.disabledDiv&&(n.disabledDiv.remove(),n.disabledDiv=null)},n.prototype._createDisabledDiv=function(e){var t=this,n=e?e:t.element,i=n.offset(),s=n.outerWidth(),o=n.outerHeight(),u={"z-index":"99999",position:"absolute",width:s,height:o,left:i.left,top:i.top};return r.browser.msie&&r.extend(u,{"background-color":"#fff",opacity:.1}),r("<div></div>").addClass(t.options.wijCSS.stateDisabled).css(u)},n.prototype._triggerEvent=function(e,t,n,r){if(!r)return;return this._trigger(e,null,{oldValue:t,newValue:n})===!1},n.prototype._refreshValue=function(e){var t=this,n=t.options,i,s=n.animationOptions,o=n.indicatorIncrement,u=t.element,a,f,l;if(!t._isInit)return;l=u.attr("aria-valuenow"),a=t.value(),f=(a-t.min)/(t.max-t.min)*100,i=parseInt(l)!=a;if(t._triggerEvent("beforeProgressChanging",l,a,i))return;!s.disabled&&s.duration>0?setTimeout(function(){r.wijmo.wijprogressbar.animations.progress({content:t.valueDiv,complete:function(){o!==1&&(t._refreshProgress(f,a,i),n.labelAlign==="running"&&t._updateRunningLabelCss(f)),t._triggerEvent("progressChanged",l,a,i),t._lastStep=f},step:function(n){t._performAnimating(n,e,i)},progressValue:a*100},s)},n.animationDelay):(t._refreshProgress(Math.round(f)),n.labelAlign==="running"&&t._updateRunningLabelCss(f),t._lastStep=f,t._triggerEvent("progressChanged",l,a,i))},n.prototype._refreshProgress=function(e,t,n){var i=this,s=i.options,o=s.wijCSS,u=s.fillDirection,a=i.element;t===undefined&&(t=r.wijmo.wijprogressbar.mul(e,i.max-i.min)/100+i.min);if(i._triggerEvent("progressChanging",a.attr("aria-valuenow"),t,n))return;i._isHorizontal()?i.valueDiv.toggleClass(u==="east"?o.cornerRight:o.cornerLeft,t===i.max).width(e+"%"):i.valueDiv.toggleClass(u==="south"?o.cornerBottom:o.cornerTop,t===i.max).height(e+"%"),i.label.html(i._getFormatString(s.labelFormatString,e,t)),i._isHorizontal()||i._ajustLabelPosition(),a.attr("aria-valuenow",t).attr("title",i._getFormatString(s.toolTipFormatString,e,t))},n.prototype._isHorizontal=function(){var e=this.options.fillDirection;return e==="west"||e==="east"},n.prototype._getRotateTextOffset=function(e){var t,n;return e.css("width","auto"),t=e.outerWidth(),n=e.outerHeight(),e.css("width",""),Math.max(t-n-4,0)},n.prototype._updateElementsCss=function(){var e=this,t=e.options,n=e.element,r=t.fillDirection;n.removeClass(i+"-west "+i+"-east "+i+"-north "+i+"-south").addClass(i+"-"+r),e._updateProgressCss(),e._updateLabelCss()},n.prototype._updateLabelCss=function(){var e=this,t=e.options,n=e.element,i=t.labelAlign,s=e.label,o=e._lastStep,a=n.height();s.removeClass(u+"west "+u+"east "+u+"south "+u+"north "+u+"center "+u+"running").addClass(u+i).css({left:"",right:"",top:"",bottom:"",width:"","text-align":"","line-height":""}),i!=="north"&&i!=="south"&&(i!=="running"||!!e._isHorizontal())&&s.css("line-height",a+"px"),i==="running"?e._updateRunningLabelCss(o):e._isHorizontal()||(r.browser.msie||(i==="north"?s.css("width","100%").css("text-align","right"):i==="south"&&s.css("width","100%").css("text-align","left")),e._ajustLabelPosition())},n.prototype._updateRunningLabelCss=function(e){var t=this,n=t.options,i=n.fillDirection,s=t.element,o=t.label,u=t.valueDiv,a=t._isHorizontal(),f,l,c,h;f=s[a?"width":"height"](),l=o[a?"outerWidth":"outerHeight"](),c=u[a?"outerWidth":"outerHeight"](),!a&&!r.browser.msie&&(l+=t._getRotateTextOffset(o)),h=f===c?f-l:e*f/100-l+l*(f-c)/f,o.css(t.directions[i],h)},n.prototype._updateProgressCss=function(){var e=this,t=e.options,n=t.wijCSS,r=t.fillDirection,i=t.indicatorImage,s=e.valueDiv,o=e._lastStep,u=e.directions[r];i!==""&&s.css("background","transparent url("+i+") repeat fixed"),s.removeClass(n.cornerLeft+" "+n.cornerRight+" "+n.cornerTop+" "+n.cornerBottom).addClass(n["corner"+u.charAt(0).toUpperCase()+u.substring(1)]),typeof o=="number"?e._isHorizontal()?s.css("width",o+"%").css("height",""):s.css("height",o+"%").css("width",""):s.css({width:"",height:""})},n.prototype._performAnimating=function(e,t,n){var i=this,s=i.options,o=s.indicatorIncrement,u=e/100,a=r.wijmo.wijprogressbar.div(u-i.min,i.max-i.min)*100,f=0,l,c,h=2;if(o){o!==1?a=Math.floor(a/o)*o:(a=Math.round(a),h=0),i.pointNumber=f;if(i._lastStep===a&&!t)return}i._refreshProgress(Number(a.toFixed(h)),Number(u.toFixed(h)),n),s.labelAlign==="running"&&i._updateRunningLabelCss(a)},n.prototype._getFormatString=function(e,t,n){var r=this,i=r.max-n,s=100-t,o=/\{0\}/g;return e=e.replace(o,n.toString()),o=/\{ProgressValue\}/g,e=e.replace(o,n.toString()),o=/\{1\}/g,e=e.replace(o,t.toString()),o=/\{PercentProgress\}/g,e=e.replace(o,t.toString()),o=/\{2\}/g,e=e.replace(o,i.toString()),o=/\{RemainingProgress\}/g,e=e.replace(o,i.toString()),o=/\{3\}/g,e=e.replace(o,s.toString()),o=/\{PercentageRemaining\}/g,e=e.replace(o,s.toString()),o=/\{4\}/g,e=e.replace(o,r.min),o=/\{Min\}/g,e=e.replace(o,r.min),o=/\{5\}/g,e=e.replace(o,r.max),o=/\{Max\}/g,e=e.replace(o,r.max),e},n.prototype._ajustLabelPosition=function(){var e=this,t=e.options,n;t.labelAlign==="north"&&(n=r("<span>").addClass("ui-widget").html(e.label.html()).appendTo("body").hide(),e.label.css("top",n.width()-e.label.height()),n.remove())},n.prototype.value=function(e){return r.ui.progressbar.prototype.value.apply(this,arguments)},n.prototype.destroy=function(){var e=this,t=e.element;t.attr("title","").removeClass(i+" "+i+"-east "+i+"-west "+i+"-north "+i+"-south"),e.label&&e.label.remove(),e.disabledDiv&&(e.disabledDiv.remove(),e.disabledDiv=null),r.ui.progressbar.prototype.destroy.apply(this,arguments)},n}(a);n.wijprogressbar=l,r.ui&&r.ui.progressbar&&(l.prototype.options=r.extend(!0,{},t.wijmoWidget.prototype.options,r.ui.progressbar.prototype.options,new f),r.wijmo.registerWidget("wijprogressbar",r.ui.progressbar,l.prototype),r.extend(r.wijmo.wijprogressbar,{animations:{progress:function(e,t){e=r.extend({easing:"swing",duration:1e3},e,t),e.content.stop(!0,!0).animate({pgvalue:e.progressValue},e)}},add:function(e,t){var n=0,r=0,i;try{n=e.toString().split(".")[1].length}catch(s){}try{r=t.toString().split(".")[1].length}catch(o){}return i=Math.pow(10,Math.max(n,r)),(e*i+t*i)/i},mul:function(e,t){var n=0,r=e.toString(),i=t.toString();try{n+=r.split(".")[1].length}catch(s){}try{n+=i.split(".")[1].length}catch(o){}return Number(r.replace(".",""))*Number(i.replace(".",""))/Math.pow(10,n)},div:function(e,t){var n=0,r=0,i,s;try{n=e.toString().split(".")[1].length}catch(o){}try{r=t.toString().split(".")[1].length}catch(u){}return i=Number(e.toString().replace(".","")),s=Number(t.toString().replace(".","")),i/s*Math.pow(10,r-n)}}))})(t.progressbar||(t.progressbar={}));var n=t.progressbar})(wijmo||(wijmo={}))});