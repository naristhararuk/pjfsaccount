var wijmo;define(["globalize","./wijmo.widget","./wijmo.wijtabs","./wijmo.wijmenu"],function(){var e=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};(function(t){(function(n){var r=jQuery,i="wijribbon",s="wijmo-wijribbon",o=s+"-disabled",u=s+"-bigbutton",a=s+"-panel",f=s+"-groups",l=s+"-group",c=l+"-content",h=l+"-label",p=s+"-dropdown",d=s+"-dropdowngroup",v=s+"-abbrev",m=v+"group",g=s+"-text",y=s+"-icon",b=s+"-abbrevicon",w="ui-button",E="ui-state-active",S="wijmo-wijribbon-accesstoolbar",x="wijmo-wijribbon-startmenulinkcontainer",T="wijmo-wijribbon-startmenulink",N="wijmo-wijribbon-startmenu",C="wijmo-wijribbon-startmenuindicator",k="wijmo-wijribbon-accesstoolbarmenuitemchecked",L="wijmo-wijribbon-accesstoolbarmenuitemunchecked",A="wijmo-wijribbon-accesstoolbarmenu",O="wijmo-wijribbon-accesstoolbarmenutitleitem",M=function(){var e=this,t=[];e.append=function(e){t.push(e)},e.toString=function(){return t.join("")},e.dispose=function(){t=null}},_=function(e,t,n){var i=this,s={br:!0,img:!0,hr:!0,input:!0};i.tagName=e||"div",i.attributes=n||{},i.innerText=t||"",i.children=[],r.isPlainObject(t)&&(i.innerText="",i.attributes=t),i._isShortTag=!1,s[i.tagName]===!0&&(i._isShortTag=!0),i.render=function(){var e=new M,t="";return e.append(i._renderBeginTag(i.tagName,i.attributes)),i.innerText!==""&&e.append(i.innerText),i.children.length>0&&r.each(i.children,function(t,n){e.append(n.render())}),e.append(i._renderEndTag(i.tagName)),t=e.toString(),e.dispose(),t},i.add=function(e){this.children.push(e)},i._renderBeginTag=function(e,t){var n=new M,i="";return n.append("<"),n.append(e),r.each(t,function(e,t){n.append(" "),n.append(e),n.append("="),n.append('"'),n.append(t?t.toString():""),n.append('"')}),this._isShortTag?n.append(" "):n.append(">"),i=n.toString(),n.dispose(),i},i._renderEndTag=function(e){var t=new M,n="";return this._isShortTag?t.append("/>"):(t.append("</"),t.append(e),t.append(">")),n=t.toString(),t.dispose(),n}},D=function(t){function n(){t.apply(this,arguments)}return e(n,t),n.prototype._create=function(){var e=this;window.wijmoApplyWijTouchUtilEvents&&(r=window.wijmoApplyWijTouchUtilEvents(r)),this.nativeMarkup=this.element.html(),this.nativeClass=this.element.attr("class"),e.options.data&&e._initMarkupByData(),e._ribbonify(),r(window).bind("resize.wijribbon",function(){e.element.is(":visible")&&!e.options.compactMode&&e.updateRibbonSize()}),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.updateRibbonSize(),e._isDisabled()&&e._setDisabled(!0),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijribbon"),t.prototype._create.call(this)},n.prototype._initMarkupByData=function(){var e=new H(this.element.attr("id"),this.options.data),t=e.getMarkupWithData();this.actions=e.getActions(),this.element.html(t),e.clearRes(),e=null},n.prototype._setOption=function(e,t){r.wijmo.widget.prototype._setOption.apply(this,arguments),r("."+T,this.element).unbind("click.tabs")},n.prototype._innerDisable=function(){t.prototype._innerDisable.call(this),this._setDisabled(!0)},n.prototype._innerEnable=function(){t.prototype._innerEnable.call(this),this._setDisabled(!1)},n.prototype._setDisabled=function(e){var t=this,n=t.element,i=n.offset(),s=i.top,u=i.left,a=r("body"),f=this.options.wijCSS,l=t.disabledModal;n.data("wijmo-wijtabs")&&n.wijtabs("option","disabled",e),n.closest(".wijmo-wijeditor").length!==0&&(s=0,u=0,a=n.parent()),e?(l||(l=r("<div></div>").addClass(f.stateDisabled+" "+o).css({top:s,left:u,"background-color":"lightgray",position:"absolute"}).appendTo(a).bind("click mousedown mouseup mouseover mouseout focus keydown keypress",function(e){return t._preventDefaultEvent(e),!1}),t.disabledModal=l),t.disabledModal.width(n.width()).height(n.outerHeight()).show()):t.disabledModal&&t.disabledModal.hide()},n.prototype._preventDefaultEvent=function(e){e.stopPropagation(),e.preventDefault()},n.prototype._initCustomButtons=function(){var e=this,t;r.each(r("[customtype]",e.element),function(n,i){t=r(i).attr("customtype"),t&&e.options.custombuttons[t]&&e.options.custombuttons[t].create(r(i))})},n.prototype._ribbonify=function(){var e=this,t=this.options.wijCSS;e.buttons={},e.listUis={},e.accessbarBtns={},e._initCustomButtons(),e._createAccessToolBar(),e._getButtonSets(),e._createButtons(),e._createGroup(),e._createSplit(),e._createDropdwon(),e._createInputDropdown(),e._createGallery(),e._hideShowedList(),e._createTab(),r("."+t.helperReset+":not(."+f+", ."+t.tabsNav+", .wijmo-wijmenu-list)",e.element).hover(function(){r(this).toggleClass(t.stateHover)}),r("."+w,e.element).bind("mouseenter",function(){r("."+t.buttonText,this).addClass(t.stateHover)}).bind("mouseleave",function(){r("."+t.buttonText,this).removeClass(t.stateHover)}),r("button."+w,e.element).bind("mousedown mouseup",function(){e._addActiveClassToButtonText(this)}),r("label."+w,e.element).bind("click",function(){r("span",this)&&r("span",this).length===1&&e._addActiveClassToLabelButtonText(this)})},n.prototype._addActiveClassToButtonText=function(e){var t=this.options.wijCSS,n;e&&(n=r(e).hasAllClasses(E),r("."+t.buttonText,e).toggleClass(t.stateActive,n).toggleClass(t.stateDefault,n))},n.prototype._addActiveClassToLabelButtonText=function(e){var t=this,n,i,s;e&&(i=r(e).attr("for"),n=r("#"+i,t.element),n.is(":checkbox")?t._addActiveClassToButtonText(e):n.is(":radio")&&(s=t.element.find("[name='"+n.attr("name")+"']"),r.each(s,function(){t._updateGroupElementTextState(this)})))},n.prototype._updateGroupElementTextState=function(e){var t,n=this.options.wijCSS,i;if(!e)return;t=r("[for='"+r(e).attr("id")+"']",r(e).parent()),t&&(i=t.hasAllClasses(E),t.children("."+n.buttonText).toggleClass(n.stateActive,i).toggleClass(n.stateDefault,i))},n.prototype._getButtonSets=function(){var e=this,t;e.groups=[],e.splits=[],e.dropdowns=[],e.inputDropdowns=[],r("span>button, span>:checkbox, span>:radio, div>button, div>:checkbox, div>:radio, div>:text",e.element).each(function(n,i){if(r(i).parents("[customtype]")&&r(i).parents("[customtype]").length!==0)return;return t=r(i).parent(),r(">ul",t).length===0&&!t.hasClass(S)?e.groups.push(t):r(">button",t).length===2?e.splits.push(t):r(">button",t).length===1?e.dropdowns.push(t):r(">input[type='text']",t).length===1&&e.inputDropdowns.push(t),this}),e.groups=e._unique(e.groups),e.splits=e._unique(e.splits)},n.prototype._unique=function(e){var t=r.makeArray(r.map(e,function(e){return e.get(0)}));return r.map(r.unique(t),function(e){return r(e)})},n.prototype._createButtons=function(){var e=this,t=e.element;r(":checkbox",t).each(function(){if(e._isCustomTypeEle(r(this)))return;return e._createButton(r(this),"checkbox"),r(this).bind("change",function(){e._addActiveClassToLabelButtonText(r(this).button("widget")[0])}),this}),r(":radio",t).each(function(){if(e._isCustomTypeEle(r(this)))return;return e._createButton(r(this),"radio"),r(this).bind("change",function(){e._addActiveClassToLabelButtonText(r(this).button("widget")[0])}),this}),r("button",t).each(function(){if(e._isCustomTypeEle(r(this)))return;return e._createButton(r(this),"button"),this})},n.prototype._isCustomTypeEle=function(e){return e?e.parents("[customtype]")&&e.parents("[customtype]").length!==0:!1},n.prototype._createButton=function(e,t){var n=this,i=this.options.wijCSS,s=n._buildButtonOption(e,t),o=e.data("commandName"),u;e.button(s),s.text||(t==="button"?e.children("."+i.buttonText).text(o):(u=r("[for='"+e.attr("id")+"']",e.parent()),u&&u.children("."+i.buttonText).text(o))),e.parent().is("."+S)&&e.attr("canlocateonaccesstoolbar")==="true"&&e.button("widget").hide(),n._triggerEvent(e)},n.prototype._createGroup=function(){r.each(this.groups,function(e,t){t.buttonset()})},n.prototype._createSplit=function(){var e=this,t=this.options.wijCSS;r.each(e.splits,function(n,i){var o=i.children("ul"),u=i.children("button:eq(0)"),a=u.data("commandName"),f=i.children("button:eq(1)"),l;o.children("li").addClass(t.cornerAll),i.addClass(s+"-"+a),f.button({icons:{primary:t.iconArrowDown},text:!1}).data("list",o).unbind("click").bind("click",function(t){e._preventDefaultEvent(t)}).bind("mouseup",function(t){o=r(this).data("list"),o.is(":visible")?(e.showList.hide().css("z-index",""),e.showList=null):(o.show().position({my:"left top",at:"left bottom",of:i}).css("z-index",9999),e.showList=o),e._preventDefaultEvent(t)}),f.children("."+t.buttonText).text("foo"),i.after(o),o.css("position","absolute").addClass(t.helperReset+" "+t.helperClearFix+" "+t.cornerAll+" "+p).hide(),i.buttonset(),l={ui:u,defaultValue:u.button("option","label"),buttons:[],type:"split",trigger:f,list:o},r("button, :checkbox, :radio",o).bind("click",function(t){o.hide().css("z-index",""),e.showList=null,t.preventDefault()}),o.find(">li>button,>li>:radio,>li>:checkbox").each(function(t,n){var i=r(n).data("commandName");i!==""&&e.buttons[i]&&(e.buttons[i].parent=u,e.buttons[i].type="split"),l.buttons.push(r(n))}),a!==""&&(e.listUis[a]=l)})},n.prototype._createDropdwon=function(){var e=this,t=this.options.wijCSS,n,i;e.dropdownLabels={},r.each(e.dropdowns,function(n,i){var o=i.children("ul"),u=i.children("button:eq(0)"),a=u.data("commandName"),f;o.children("li").addClass(t.cornerAll+" "+t.stateDefault),i.addClass(s+"-"+a),u.button({icons:{secondary:t.iconArrowDown}}).unbind("click").bind("click",function(t){e._preventDefaultEvent(t)}).bind("mouseup",function(t){e._showDropDownList(o,u),e._preventDefaultEvent(t)}).bind("keydown",function(t){if(!o.is(":visible"))return;e._dropdownListKeyHandler(t,o,u)}),f={ui:u,defaultValue:u.button("option","label"),buttons:[],type:"dropdown",list:o},r("button, :checkbox, :radio",o).bind("click",function(n){var i=r(this).data("commandName"),s,a=u.children("."+t.buttonText).width();e.dropdownLabels[i]||(e.dropdownLabels[i]=e._getDropdownLabelSubstr(r(this).button("option","label"),u.children("."+t.buttonText),a)),s=e.dropdownLabels[i],u.button("option","label",s),u.attr("title",r(this).button("option","label")),o.hide().css("z-index",""),e.showList=null,n.preventDefault()}),o.css("position","absolute").addClass(t.helperReset+" "+t.helperClearFix+" "+t.cornerAll+" "+p).hide(),i.buttonset(),e._collectDropDownButtons(o,u,f,a)})},n.prototype._createInputDropdown=function(){var e=this,t=this.options.wijCSS;e.dropdownLabels={},r.each(e.inputDropdowns,function(n,i){var o=i.children("ul"),u=i.children("input[type='text']:eq(0)"),a=e._createInputDropDownWrapper(u),f=u.prop("name"),l;i.prepend(a),o.children("li").addClass(t.cornerAll+" "+t.stateDefault),i.addClass(s+"-"+f),u.removeProp("name").data("commandName",f).addClass(t.stateDefault+" "+t.content+" "+t.cornerLeft),a.find("a").bind("mouseup",function(t){e._showDropDownList(o,u),u.focus(),e._preventDefaultEvent(t)}).bind("keydown",function(t){e._dropdownListKeyHandler(t,o,a)}),e._bindInputEvent(u,o),l={ui:u,defaultValue:u.val(),buttons:[],type:"dropdown",list:o},r("button, :checkbox, :radio",o).bind("click",function(t){var n=r(this).data("commandName"),i;e.dropdownLabels[n]||(e.dropdownLabels[n]=r(this).button("option","label")),i=e.dropdownLabels[n],u.val(r(this).button("option","label")).attr("title",r(this).button("option","label")),o.hide().css("z-index",""),e.showList=null,e._preventDefaultEvent(t)}),o.css("position","absolute").addClass(t.helperReset+" "+t.helperClearFix+" "+t.cornerAll+" "+p).hide(),e._collectDropDownButtons(o,u,l,f)})},n.prototype._collectDropDownButtons=function(e,t,n,i){var s=this;e.find(">li>button,>li>:radio,>li>:checkbox").each(function(e,i){var o=r(i).data("commandName");o!==""&&s.buttons[o]&&(s.buttons[o].parent=t,s.buttons[o].type="dropdown"),n.buttons.push(r(i))}),i!==""&&(s.listUis[i]=n)},n.prototype._showDropDownList=function(e,t){var n=this;e.is(":visible")&&!e.find("li."+n.options.wijCSS.stateActive)?(n.showList.hide().css("z-index",""),n.showList=null):(n.showList&&(n.showList.hide(),n.showList=null),e.show().position({my:"left top",at:"left bottom",of:t}).css("z-index",9999),n.showList=e,n.isShow=!0)},n.prototype._bindInputEvent=function(e,t){var n=this,r,i;e.bind("change",function(t){var r={name:undefined,commandName:undefined};r.name=e.prop("name"),r.commandName=e.val(),n._trigger("click",t,r)}).bind("keydown",function(r){n._dropdownListKeyHandler(r,t,e)})},n.prototype._dropdownListKeyHandler=function(e,t,n){var r=this,i=e.keyCode,s=r._getKeyCodeEnum();switch(i){case s.UP:r._activeDropDownListElement(!1,t,n),e.preventDefault();break;case s.DOWN:r._activeDropDownListElement(!0,t,n),e.preventDefault();break;case s.ENTER:t.find("label."+r.options.wijCSS.stateActive).parent("li").find("input").trigger("click"),e.preventDefault()}},n.prototype._activeDropDownListElement=function(e,t,n){var i=this,s=t.find("li").length,o,u;if(!t.is(":visible")){i._showDropDownList(t,n);return}u=t.find("label."+i.options.wijCSS.stateActive).parent("li"),u&&u.length>0&&(o=t.find("li").index(u)),i._changeListItemActiveState(u,!1),o===undefined?o=0:e?(o++,o==s&&(o=undefined)):(o--,o==-1&&(o=s-1)),i._changeListItemActiveState(r(t.find("li")[o]),!0)},n.prototype._changeListItemActiveState=function(e,t){var n=this.options.wijCSS;if(!e)return;r("label",e).toggleClass(n.stateActive,t),r("span",e).toggleClass(n.stateActive,t)},n.prototype._createGallery=function(){var e=this,t=e.options.wijCSS;r(".wijmo-wijribbon-gallery",e.element).each(function(n,i){r(i).children("div").each(function(n,i){r(i).bind("mouseenter",function(e){if(r(i).hasAllClasses(t.stateDisabled))return;r(i).addClass(t.stateHover)}).bind("mouseleave",function(e){if(r(i).hasAllClasses(t.stateDisabled))return;r(i).removeClass(t.stateHover)}).bind("click",function(n){if(r(i).hasAllClasses(t.stateDisabled))return;r(i).parent("div.wijmo-wijribbon-gallery").children("div").removeClass(t.stateActive),r(i).addClass(t.stateActive);var s={name:undefined,commandName:undefined};s.name=r(i).parent("div.wijmo-wijribbon-gallery").attr("name"),s.commandName=r(i).attr("name"),e._trigger("click",n,s)}),e.buttons[r(i).attr("name")]={button:r(i),type:"galleryBtn"}})})},n.prototype._getKeyCodeEnum=function(){if(r.ui&&r.ui.keyCode)return r.ui.keyCode;if(r.mobile&&r.mobile.keyCode)return r.mobile.keyCode;throw"keyCode object is not found"},n.prototype._createInputDropDownWrapper=function(e){var t=this.options.wijCSS,n=r("<span class='wijmo-wijribbon-inputdropdownwrapper'></span>").append(e);return r("<a></a>").appendTo(n).button({icons:{primary:t.iconArrowDown},text:!1}).removeClass(t.cornerAll).addClass("wijmo-wijribbon-inputdropdownbtn "+t.cornerRight),n},n.prototype._createTab=function(){var e=this,t=this.options.wijCSS,n=e.element,i=r("."+N,n);return n.addClass(s),e.tabEle=n,r(">ul",n).length>0?(n.wijtabs({select:function(t,n){e._hideAllMenus()}}),e._createRibbonGroups(),n.wijtabs({show:function(t,n){e.updateRibbonSize()}}),i&&i.length>0&&(n.wijtabs("option","selected",1),e._createStartMenu()),!0):(n.addClass(s+"-simple"+" "+t.stateDefault+" "+t.helperClearFix),!1)},n.prototype._createAccessToolBar=function(){var e=this,t,n=r("<div class='"+S+"'></div>"),i;if(r("*[canlocateonaccesstoolbar='true']",e.element).length===0&&r("*[locateonaccesstoolbar='true']",e.element).length===0)return;r("input[canlocateonaccesstoolbar='true'],input[locateonaccesstoolbar='true']",e.element).each(function(){t=r(this).attr("id")+"_accessbar";var n=r("label[for="+r(this).attr("id")+"]");e.accessbarBtns[n.attr("title")]={button:r(this).clone().attr("id",t),type:r(this).attr("type"),labelEle:n.clone().attr("for",t),selected:r(this).attr("locateonaccesstoolbar")==="true"?!0:!1}}),r("button[canlocateonaccesstoolbar='true'],button[locateonaccesstoolbar='true']",e.element).each(function(){t=r(this).attr("id")+"_accessbar",e.accessbarBtns[r(this).attr("title")]={button:r(this).clone(),type:"button",selected:r(this).attr("locateonaccesstoolbar")==="true"?!0:!1}}),r.each(e.accessbarBtns,function(e,t){n.append(t.button),t.labelEle&&n.append(t.labelEle)}),i=r('<button title="Customize Access Toolbar" class ="wijmo-wijribbon-accesstoolbarbtn '+e.options.wijCSS.iconArrowDown+'"'+' name="quicktoolbar"></button>'),n.append(i),e.accessbarBtns&&e.element.prepend(n),e._createCustomQuickToolbarMenu(i,n)},n.prototype._createCustomQuickToolbarMenu=function(e,t){var n=this,i,s,o=n.options.wijCSS,u=r('<ul class="'+A+'"></ul>');r.each(n.accessbarBtns,function(e,t){s=t.selected?" "+k:" "+L,i=r('<li><a class="'+o.cornerAll+'" tabindex="-1">'+'<span class="'+o.icon+s+'"></span><span'+' class="wijmo-wijmenu-text">'+e+"</span></a></li>"),i.data("accessbarcommand",e),u.append(i)}),u.prepend("<li class='"+O+"'><a>Customize Access Toolbar</a></li>"),t.append(u),u.wijmenu({trigger:e,triggerEvent:"click",orientation:"vertical",select:function(e,t){var i=t.item,s=i.element.data("accessbarcommand"),a=r("span."+o.icon,i.element),f=n.accessbarBtns[s].button,l=f.button("widget"),c=a.hasClass(k);a.toggleClass(k,!c).toggleClass(L,c),c?l.hide().removeAttr("canlocateonaccesstoolbar").attr("locateonaccesstoolbar","true"):l.show().removeAttr("locateonaccesstoolbar").attr("canlocateonaccesstoolbar","true"),u.wijmenu("deactivate",null)}}),u.wijmenu("setItemDisabled",r("."+O),!0)},n.prototype.updateRibbonSize=function(){var e=this,t,n=this.options.wijCSS,i;e.tabEle.children("div").not(".wijmo-wijmenu").each(function(o,u){var a=r(u),f=a.is(":visible"),l=a.find(">ul>li:not(.wijmo-wijmenu-item)"),c=[],h=a.width();return f||(a.removeClass(n.wijtabsHide),h=a.width()),l.each(function(n,o){var u=r(o),a=u.find(">div:last"),f=e._getGroupLabelText(a);return t=u.children("."+d),i=u.children("."+m),t&&(u.addClass(s+"-"+f.toLowerCase()).prepend(t.children()),t.remove(),i&&i.remove()),c.push({width:u.outerWidth(!0),text:f}),this}),e._adjustRibbonGroupIfNeeded(l,c,h),f||a.addClass(n.wijtabsHide),this}),e._isDisabled()&&e._setDisabled(!0)},n.prototype._createRibbonGroups=function(){var e=this,t=this.options.wijCSS;e.tabEle.children("div").each(function(n,i){var o=r(i),u=o.is(":visible"),p=o.find(">ul:not(."+A+")>li"),d=[],v;if(o.data("destroy.tabs")){o.remove();return}return u||o.removeClass(t.wijtabsHide),v=o.width(),o.addClass(a),o.hasAllClasses(t.tabsPanel)||(o.addClass(S),e.tabEle.prepend(o)),o.find(">ul").addClass(t.helperReset+" "+t.helperClearFix+" "+t.content+" "+t.cornerAll+" "+f),p.each(function(n,i){var o=r(i),u=o.find(">div:last"),a=u.find("span"),f=t.stateDefault+" "+l,p=e._getGroupLabelText(u);return u&&(f+=" "+s+"-"+p.toLowerCase()),o.addClass(f),u.addClass(h).bind("click",function(){return!1}),o.wrapInner("<div class = '"+c+"'></div>"),o.children().bind("mouseover",function(){r(this).addClass(t.stateHover)}).bind("mouseout",function(){r(this).removeClass(t.stateHover)}),u.appendTo(o),d.push({width:o.outerWidth(!0),text:p}),this}),e._originalGroupInfo=d,e._adjustRibbonGroupIfNeeded(p,d,v),u||o.addClass(t.wijtabsHide),this})},n.prototype._createStartMenu=function(){var e=this,t=r("."+T,e.element),n=e.options.wijCSS;t.unbind("click"),t.parent("li").addClass(x).hover(function(){r(this).toggleClass(x)}),r("."+C,e.element).addClass(n.icon+" "+n.iconArrowDown),r("."+N,e.element).wijmenu({trigger:t.parent(),triggerEvent:"click",orientation:"vertical",select:function(t,n){var r={name:undefined,commandName:undefined};r.commandName=n.item._link.attr("name"),e._trigger("click",t,r)},hidden:function(e,t){t.activeItem&&t.activeItem._link.removeClass(n.stateFocus)}})},n.prototype._getGroupLabelText=function(e){var t,n;return e&&(t=e.find("span"),e.attr("displayname")?n=e.attr("displayname"):t&&t.length>0&&!e.hasAllClasses(m)?n=r(t[0]).text():n=r.trim(e.text())),n},n.prototype._adjustRibbonGroupIfNeeded=function(e,t,n){var i=this,o=e.length-1,u=0,a=0,f=0,l,c,h;for(;o>=0;o--){f=0;for(u=0;u<o;u++)f+=t[u].width;f+a+t[o].width<=n&&!i.options.compactMode?(l=r(e[o]).children("."+d),c=r(e[o]).children("."+m),l&&(r(e[o]).addClass(s+"-"+t[o].text.toLowerCase()).prepend(l.children()),l.remove(),c&&c.remove())):(h=t[o],a+=i._createDropDownRibbonGroup(h.text,e[o]))}},n.prototype._createDropDownRibbonGroup=function(e,t){var n=this,i=s+"-"+e.toLowerCase(),o=this.options.wijCSS,u=r(t).removeClass(i),a=n._getGroupLabelText(u.find(">div:last"))||e,f;return u.wrapInner("<div class='"+d+" "+l+"'></div>").children().hide().addClass(i).bind("mouseup."+n.widget,function(e){n.showDrpDwnGroup!==null&&(n.showDrpDwnGroup.hide().css("z-index",""),n.showDrpDwnGroup=null)}),f=r("<div class='"+m+"'>"+"<span class='"+v+a.toLowerCase()+" "+y+" "+b+"'></span>"+"<span class='"+g+"'>"+a+"</span>"+"<span class='"+o.icon+" "+o.iconArrowDown+" "+y+"'></span></div>").appendTo(u).unbind(n.widget).bind("mouseover."+n.widget,function(e){r(this).addClass(o.stateHover)}).bind("mouseout."+n.widget,function(e){r(this).removeClass(o.stateHover)}).bind("click."+n.widget,function(e){var t=r(this).siblings("."+d);t.is(":visible")?(t.hide().css("z-index",""),n.showDrpDwnGroup=null):(n.showDrpDwnGroup&&n.showDrpDwnGroup.hide().css("z-index",""),t.show().position({my:"left top",at:"left bottom",of:this}).css("z-index","10000"),n.showDrpDwnGroup=t,e.stopPropagation())}),u.outerWidth(!0)},n.prototype._hideShowedList=function(){var e=this;r(document).bind("mouseup",function(t){var n=t.target;e.showList&&(r(n).is(document)||!r.contains(e.showList.get(0),n))&&(e.showList.hide().css("z-index",""),e.showList=null),e.showDrpDwnGroup&&(r(n).is(document)||!r.contains(e.showDrpDwnGroup.get(0),n))&&(e.showDrpDwnGroup.hide().css("z-index",""),e.showDrpDwnGroup=null)})},n.prototype._buildButtonOption=function(e,t){var n=!0,i=this,s=e.attr("class"),o,a,f,l,c,h,p;if(s&&s!==""&&s!==u)a=s.split(" ")[0],e.removeClass(a),c=r.trim(e.text()),c===""&&(n=!1);else{if(t==="checkbox"||t==="radio"){if(r.trim(e.attr("id"))==="")return;h=r("[for='"+e.attr("id")+"']",e.parent());if(!h.is("label"))return;s=h.attr("class"),s&&s!==""&&s!==u?(a=s.split(" ")[0],h.removeClass(a),c=r.trim(h.text()),c===""&&(n=!1)):o=h.children("span,div")}else t==="button"&&(o=e.children("span,div"));o&&(o.length===1?o.eq(0).attr("class")!==""&&(f=o.eq(0),a=f.attr("class"),n=!1):o.length===2?o.eq(0).attr("class")&&(f=o.eq(0),a=f.attr("class"),f.is("span")?l="left":f.is("div")&&(l="top"),c=o.eq(1).text()):t==="button"&&r.trim(e.text())!==""&&(c=r.trim(e.text())))}return t==="button"?(e.empty(),p=r.trim(e.attr("name")),p!==""&&e.removeAttr("name")):(p=r.trim(h.attr("name")),p!==""&&h.removeAttr("name")),p!==""&&(e.data("commandName",p),i.buttons[p]||(i.buttons[p]={button:undefined,accessToolbarButton:undefined}),e.parent().is("."+S)?i.buttons[p].accessToolbarButton=e:i.buttons[p].button=e),{label:c,icons:{primary:a},position:l,text:n}},n.prototype._triggerEvent=function(e){var t=this,n,r,i=t.options.wijCSS;e.bind("click",function(i){if(t._isDisabled()){t._preventDefaultEvent(i);return}t._hideAllMenus();var s=!0,o=e.data("commandName"),u=t.buttons[o],a={name:undefined,commandName:undefined};t.actions&&t.actions[o]?t.actions[o]():(u&&u.parent&&(a.name=u.parent.data("commandName")),a.commandName=o,t._trigger("click",i,a)),e.parent().is("."+S)?n=t.buttons[o].button:n=t.buttons[o].accessToolbarButton,n&&(r=n.button("widget"),n.is("button")||(r&&r.hasAllClasses(E)&&(s=!1),t._setBtnWidgetCheckedStyle(n,s))),e.is("button")&&t._preventDefaultEvent(i)})},n.prototype._getDropdownLabelSubstr=function(e,t,n){var i=this,s=e.length,o=0,u=s,a=Math.floor((o+u)/2),f=r("<span></span>"),l=e.substr(0,a),c;f.appendTo(t.parent()),c=i._calculateWidth(l,f);while(c!==n&&u>o)l=e.substr(0,a+1),c=i._calculateWidth(l,f),c>n?u=a-1:c<n&&(o=a+1),a=Math.floor((o+u)/2);return f.remove(),l},n.prototype._calculateWidth=function(e,t){return t.text(e),t.width()},n.prototype.hideDropdown=function(e){var t=this,n=t.listUis[e];n&&n.list&&n.list.hide()},n.prototype._hideAllMenus=function(){var e=this;r(".wijmo-wijmenu",e.tabEle).hide()},n.prototype.setTabPageVisible=function(e,t){var n=this,i=r("a[href=#"+e+"]",n.element).parent("li"),s=i.parent("ul"),o;i&&i.length>0&&(t?(i.show(),o=r("li",s).index(i)):(i.hide(),o=r("li",s).index(r('li:visible:not(".'+x+'")',s)))),n.element.wijtabs("option","selected",o)},n.prototype.destroy=function(){this.disabledModal&&this.disabledModal.remove(),this.element.data("wijmo-wijtabs")&&this.element.wijtabs("destroy"),this.element.removeClass().html(this.nativeMarkup),this.element.attr("class",this.nativeClass?this.nativeClass:""),this.nativeMarkup=null,this.nativeClass=null,r(window).unbind("resize.wijribbon"),t.prototype.destroy.call(this)},n.prototype.getDropdownList=function(e){var t=this,n=t.listUis[e],i={};return n&&r.each(n.buttons,function(e,t){i[t.data("commandName")]=t.button("option","label")}),i},n.prototype.setButtonDisabled=function(e,t){var n=this.buttons[e],i=this.options.wijCSS,s,o,u=!1,a,f,l;if(n&&n.disabled){n.disabled(t);return}n&&n.button&&n.type==="galleryBtn"&&n.button.addClass(i.stateDisabled);if(n&&n.button){a=n.button,f=n.accessToolbarButton,u=a.is("button");if(n.type==="galleryBtn"){a.toggleClass(i.stateDisabled,t);return}a.button("option","disabled",t),s=r("."+i.buttonText,a),s&&s.removeClass(i.stateHover),f&&(f.button("option","disabled",t),o=r("."+i.buttonText,f),o&&o.removeClass(i.stateHover)),u?e!=="save"&&(a.children("."+i.buttonText).text(e),f&&a.children("."+i.buttonText).text(e)):r("[for='"+a.attr("id")+"']",a.parent()).children("."+i.buttonText).text(e),l=this.listUis[e],l&&l.type==="split"&&(l.trigger.button("option","disabled",t),l.trigger.children("."+i.buttonText).text(e))}},n.prototype.setButtonsDisabled=function(e){var t=this;r.each(e,function(e,n){t.setButtonDisabled(e,n)})},n.prototype.setButtonsChecked=function(e){var t=this;r.each(e,function(e,n){r.isPlainObject(n)?t.setButtonChecked(e,n.checked,n.name):t.setButtonChecked(e,n,null)})},n.prototype.registerButtonInformation=function(e,t){if(e&&t)return this.buttons[e]=t},n.prototype.ribbonClick=function(e,t){this._trigger("click",e,t)},n.prototype._setBtnWidgetCheckedStyle=function(e,t){var n=this,e,r=n.options.wijCSS;e.is("button")?e.toggleClass(r.stateActive,t):e.is("input[type='text']")||e.prop("checked",t).button("refresh"),n._addActiveClassToButtonText(e.button("widget"))},n.prototype.removeButtonHoverState=function(e){var t=this,n,i=this.options.wijCSS,s=t.buttons[e];s&&s.button&&(n=s.button,n.is("button")&&(n.removeClass(i.stateHover).removeClass(i.stateFocus),r("span",n).removeClass(i.stateHover)))},n.prototype.setButtonChecked=function(e,t,n){var i=this,s,o=i.buttons[e],u=this.options.wijCSS,a,f,l,c;if(o&&o.checked){o.checked(t);return}if(o&&o.button){a=o.button,f=o.accessToolbarButton;if(a.is("button"))a.toggleClass(u.stateActive,t),f&&f.toggleClass(u.stateActive,t);else{if(o.type==="galleryBtn"){var h=a.parent("div");r("div",h).removeClass(u.stateActive),a.toggleClass(u.stateActive,t);return}a.is("input[type='text']")||(a.prop("checked",t).button("refresh"),f&&f.prop("checked",t).button("refresh"))}o.parent?o.type==="dropdown"&&t&&(i.dropdownLabels[e]||(i.dropdownLabels[e]=i._getDropdownLabelSubstr(a.button("option","label"),o.parent.children("."+u.buttonText),o.parent.children("."+u.buttonText).width())),c=i.dropdownLabels[e],o.parent.is("input[type='text']")?o.parent.val(c).attr("title",c):(o.parent.button("option","label",c),o.parent.attr("title",a.button("option","label"))),s=r(":radio",o.button.closest("ul")),s&&r.each(s,function(){i._updateGroupElementTextState(this)})):(i._addActiveClassToButtonText(a.button("widget")),f&&i._addActiveClassToButtonText(f.button("widget")))}else n&&(l=i.listUis[n],l&&(l.ui.is("input[type='text']")?l.ui.val(l.defaultValue):l.ui.button("option","label",l.defaultValue),l.buttons&&r.each(l.buttons,function(e,t){t.prop("checked",!1).button("refresh"),i._addActiveClassToButtonText(t.button("widget"))})))},n}(t.wijmoWidget);n.wijribbon=D;var P=function(){function e(){this.initSelector=":jqmData(role='wijribbon')",this.wijCSS={wijtabsHide:"wijmo-wijtabs-hide"},this.compactMode=!1,this.click=null,this.data=null,this.custombuttons=null}return e}();D.prototype.options=r.extend(!0,{},t.wijmoWidget.prototype.options,new P),r.wijmo.registerWidget("wijribbon",D.prototype);var H=function(){function e(t,n){this.data=n,this.id=t,this.ribbon=e.createElement("div"),this.actions={}}return e.prototype.getMarkupWithData=function(){var e;return this._createRibbonTabs(),e=this.ribbon.render(),e.substring(5,e.length-6)},e.prototype.clearRes=function(){this.ribbon=null},e.prototype.getActions=function(){return this.actions},e.prototype._createRibbonTabs=function(){var t=this,n,i,s;if(!this._isSimpleRibbon()){if(this.data.length<0)return;n=e.createElement("ul"),this.ribbon.add(n),r.each(this.data,function(r,o){i=e.createElement("li"),s=e.createElement("div",{id:t.id+o.id}),i.add(e.createElement("a",o.text,{href:"#"+t.id+o.id})),n.add(i),t.ribbon.add(s),o.groups&&o.groups.length>0&&s.add(t._createGroups(o.groups))})}else this._addButtonsToGroup(this.ribbon,this.data);return n},e.prototype._isSimpleRibbon=function(){var e=this.data[0].groups;return!e},e.prototype._createGroups=function(t){var n=this,i=e.createElement("ul"),s,o;return r.each(t,function(t,r){s=e.createElement("li",null,{"class":r.css,id:r.id}),r.buttons&&r.buttons.length>0&&n._addButtonsToGroup(s,r.buttons),s.add(e.createElement("div",r.text)),i.add(s)}),i},e.prototype._addButtonsToGroup=function(e,t){var n=this,i,s;r.each(t,function(t,s){i=n._createGroupButton(s),r.isArray(i)?r.each(i,function(t,n){e.add(n)}):e.add(i)})},e.prototype._createGroupButton=function(t){var n=this,i,s,o=t.buttonType?t.buttonType:"button";if(r.isArray(t))return i=e.createRibbonList(),r.each(t,function(e,t){s=n._createGroupButton(t),r.isArray(s)?r.each(s,function(e,t){i.add(t)}):i.add(s)}),i;switch(o){case"button":i=e.createButton(t.tip,t.css,t.name);break;case"bigButton":i=e.createBigButton(t.tip,t.css,t.name,t.text);break;case"dropdownButton":i=this._createDropdownButton(t.tip,t.name,t.text,t.dropdownButtons,this.id);break;case"buttonWithText":i=e.createButton(t.tip,t.css,t.name,t.text);break;case"checkbox":i=e.createImageCheckButton(t.tip,this.id,t.css,t.name);break;case"radio":i=e.createImageRadioButton(t.tip,this.id,t.css,t.name,t.grpname);break;case"textRadio":i=e.createTextRadioButton(t.tip,this.id,t.name,t.grpname,t.text);break;case"splitButton":i=this._createSplitButton(t.tip,t.css,t.name,t.text,t.buttons)}return t.action&&(this.actions[t.name]=t.action),i},e.createBigButton=function(t,n,r,i){var s=e.createElement("button",{title:t,name:r,"class":u});return s.add(e.createDiv(n)),s.add(e.createSpan("",i)),s},e.createTextButton=function(t,n,r){return e.createElement("button",r,{title:t,name:n})},e.createButton=function(t,n,r,i){var s;return i?(s=e.createElement("button",{title:t,name:r}),s.add(e.createSpan(n)),s.add(e.createSpan("",i)),s):e.createElement("button",{title:t,name:r,"class":n})},e.createTextRadioButton=function(t,n,r,i,s){var o=r.replace(/ /g,""),u=[];return u.push(e.createElement("input",{id:n+o,type:"radio",name:i})),u.push(e.createElement("label",s,{"for":n+o,title:t,name:r})),u},e.createImageRadioButton=function(t,n,r,i,s){var o=[];return o.push(e.createElement("input",{id:n+i,type:"radio",name:s})),o.push(e.createElement("label",{"for":n+i,title:t,name:i,"class":r})),o},e.createImageCheckButton=function(t,n,r,i){var s=[];return s.push(e.createElement("input",{id:n+i,type:"checkbox"})),s.push(e.createElement("label",{"for":n+i,title:t,name:i,"class":r})),s},e.createRibbonList=function(){return e.createSpan("wijmo-wijribbon-list")},e.prototype._createDropdownButton=function(t,n,i,s,o){var u=this,a=e.createElement("div",{title:t,"class":"wijmo-wijribbon-dropdownbutton"}),f=e.createElement("ul");return a.add(e.createTextButton(t,n,i)),a.add(f),r.each(s,function(t,n){var i=e.createElement("li"),s=u._createGroupButton(n);r.each(s,function(e,t){i.add(t)}),f.add(i)}),a},e.prototype._createSplitButton=function(t,n,i,s,o){var a=this,f=e.createElement("div",{title:t,"class":"wijmo-wijribbon-splitbutton"}),l=e.createElement("ul");return f.add(e.createBigButton(t,n,i,s)),f.add(e.createElement("button",{"class":u})),f.add(l),r.each(o,function(t,n){var r=e.createElement("li");r.add(a._createGroupButton(n)),l.add(r)}),f},e.createElement=function(e,t,n){return new _(e,t,n)},e.createDiv=function(t,n){return e.createElement("div",{"class":t})},e.createSpan=function(t,n){return n?t.length===0?e.createElement("span",n):e.createElement("span",n,{"class":t}):e.createElement("span",{"class":t})},e.createTextBox=function(t,n){var r={"class":t,type:"text",value:undefined};return n&&(r.value=n),e.createElement("input",r)},e.createLabel=function(e,t){return t?new _("label",e,{"for":t}):new _("label",e)},e.createRadio=function(t,n,r){var i={name:n,id:t,value:r,type:"radio"};return e.createElement("input",i)},e.createCheckbox=function(t){var n={type:"checkbox",id:t};return e.createElement("input","",n)},e.createSelect=function(t,n){var i={"class":t},s=e.createElement("select",i);return t===""&&(s=e.createElement("select")),r.each(n,function(t,n){r.isPlainObject(n)&&n.selected?s.add(e.createElement("option",n.text,{selected:"selected"})):s.add(e.createElement("option",n))}),s},e._createInputButton=function(t,n){var r={"class":t,type:"button",value:undefined};return n&&(r.value=n),e.createElement("input",r)},e}();n.wijribbonDataRender=H})(t.ribbon||(t.ribbon={}));var n=t.ribbon})(wijmo||(wijmo={}))});